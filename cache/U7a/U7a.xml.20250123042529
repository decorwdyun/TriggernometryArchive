<?xml version="1.0"?>
<TriggernometryExport PluginVersion="1.2.0.718">
<ExportedFolder Id="624c320a-4f9e-41e5-8308-03fe6250d0e3" Name="绝伊甸宝宝椅 v0.4a" Enabled="true">
<Folders>
<Folder Id="f99ad2f2-b956-4522-9736-f03ea725962b" Name="核心" Enabled="true">
<Folders>
<Folder FFXIVZoneFilterEnabled="True" FfxivZoneFilterRegularExpression="^1238$" Id="783e52c2-3842-4611-b2c6-bdc6eafd3de3" Name="区域限制" Enabled="true">
<Folders>
<Folder Id="2cae7153-b129-493f-af31-5d8914467ef2" Name="P1" Enabled="true">
<Folders>
<Folder Id="54622132-8aaf-4360-b444-4b443f50f58e" Name="A. 雾龙" Enabled="true" RawEnvironmentVariables="phase = P1雾龙">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="3. 播报" Id="23f32710-8f14-4c78-838c-784f4f60b27e" RegularExpression="^U7a1_雾龙_dir8:safe:(?&lt;dir8&gt;[0123])">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="tmp_currentSafe" VariableExpression="roundvec(${_me.x} - 100, ${_me.y} - 100, 8) % 4 = ${dir8}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" UseTTSTextExpression="${if: ${v:tmp_currentSafe} ? 退后，脚下安全 : 前进 }" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="3" VariableName="tmp_currentSafe" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="4" UseTTSTextExpression="去${?d: 0 = 上下, 1 = 左上右下, 2 = 左右, 3 = 右上左下 [${dir8}]}，${if: ${v:U7a1_雾龙_is散} ? 分散 : 分摊 }" ActionType="UseTTS" ExecutionDelayExpression="2000" Asynchronous="False" />
<Action OrderNumber="5" NamedCallbackName="AdvWm" NamedCallbackParam="clear&#xD;&#xA;---&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;θ: dir2rad(0${dir8}, 8)&#xD;&#xA;C:  0, -13&#xD;&#xA;A:  0, -20&#xD;&#xA;1:  6, -19&#xD;&#xA;3: -6, -19" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isG1}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a1_雾龙_is散}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="clear&#xD;&#xA;---&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;θ: dir2rad(0${dir8}, 8) + π&#xD;&#xA;D:  0, -13&#xD;&#xA;B:  0, -20&#xD;&#xA;2:  6, -19&#xD;&#xA;4: -6, -19" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isG1}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a1_雾龙_is散}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" NamedCallbackName="AdvWm" NamedCallbackParam="clear&#xD;&#xA;---&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;θ: dir2rad(0${dir8}, 8)&#xD;&#xA;C:    0, -13.2&#xD;&#xA;A:    0, -16.2&#xD;&#xA;1:  1.5, -14.7&#xD;&#xA;3: -1.5, -14.7" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isG1}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a1_雾龙_is散}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" NamedCallbackName="AdvWm" NamedCallbackParam="clear&#xD;&#xA;---&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;θ: dir2rad(0${dir8}, 8) + π&#xD;&#xA;D:    0, -13.2&#xD;&#xA;B:    0, -16.2&#xD;&#xA;2:  1.5, -14.7&#xD;&#xA;4: -1.5, -14.7" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isG1}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a1_雾龙_is散}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="8100" Asynchronous="False" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="1. 储存雷火 Utopian Sky" Id="6bd10dac-7115-4a0e-b912-9e2f78c90aa6" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9CD(?&lt;type&gt;A|B):">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a1_雾龙" ActionType="Variable" />
<Action OrderNumber="3" VariableOp="SetNumeric" VariableName="U7a1_雾龙_is散" VariableExpression="${type} == B" ActionType="Variable" />
<Action OrderNumber="4" UseTTSTextExpression="记录${if: ${v:U7a1_雾龙_is散} ? 分散 : 分摊 }" ActionType="UseTTS" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 获取三个分身 =&gt; 3" Id="f6017244-49eb-4e59-b8bb-38c9f051faa3" RegularExpression="^.{15}\S+ AAA:202:4:4.{7}:[^:]*:9708:17820:[^:]*:[^:]*:[^:]*:(?&lt;h&gt;[^:]+)$">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableExpressionType="Numeric" ListVariableName="U7a1_雾龙_dir8" ListVariableExpression="roundir(${h}, 8) % 4" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="U7a1_雾龙_dir8:safe:${n: 6 - ${l:U7a1_雾龙_dir8.sum}}:originalData:${l:U7a1_雾龙_dir8.join(:)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_雾龙_dir8.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 2024-11-27 02:46" Id="810239f5-5612-49e5-9670-f2fc55a89dbf">
<Actions>
<Action OrderNumber="1" LogMessageText="[01:20:11.273] StartsCasting 14:400058DA:Fatebreaker:9CDB:Utopian Sky:400058DA:Fatebreaker:3.700:99.99:99.99:0.00:-3.03" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="3.05 * 1000" />
<Action OrderNumber="3" LogMessageText="[01:20:20.418] _WeaponId AAA:202:4:400058CB:Fatebreaker's Image:9708:17820:85.85786:85.85786:-0.00000000000000000001294991:0.7853622" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[01:20:20.418] _WeaponId AAA:202:4:400058CD:Fatebreaker's Image:9708:17820:80:100:0:1.570772" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" LogMessageText="[01:20:20.418] _WeaponId AAA:202:4:400058D7:Fatebreaker's Image:9708:17820:114.1421:85.85786:0:-0.7854581" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="450b1d13-eb7e-4e3c-b57f-e6a32aac9220" Name="杂项" Enabled="true">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="雷火八方" Id="66252ba8-8357-4fb8-bb57-ca00da148698" RegularExpression="^.{15}\S+ 14:(?&lt;sid&gt;4.{7}):[^:]+:(?&lt;aid&gt;9CD[04]|9D8[9A]):">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="八方，${?d: 9CD0 = 火分摊, 9CD4 = 雷分散, 9D89 = 火分摊, 9D8A = 雷分散 [${aid}]}" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="2" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${sid}].address}, 2" ActionType="NamedCallback" DescTextColor="26f" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="f7f58d4b-cea4-4589-8430-8840664b8ef1" Name="B. 光轮" Enabled="true" RawEnvironmentVariables="phase = P1光轮">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="1. 储存雷火 光轮召唤" Id="f084dc34-1c1f-46da-9611-efb664489549" RegularExpression="^.{15}\S+ 14:(?&lt;sid&gt;4.{7}):[^:]+:9CD(?&lt;type&gt;6|7):">
<Actions>
<Action OrderNumber="1" VariableOp="UnsetRegexUniversal" VariableName="^U7a1_光轮" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="3" VariableOp="SetNumeric" VariableName="U7a1_光轮_is火safe" VariableExpression="${type} == 7" ActionType="Variable" />
<Action OrderNumber="4" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${sid}].address}, 2" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="5" UseTTSTextExpression="南北靠外，偏向${if: ${v:U7a1_光轮_is火safe} ? 红色火圈 : 蓝色雷圈 }" ActionType="UseTTS" ExecutionDelayExpression="4500" />
<Action OrderNumber="6" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${sid}].address}, 0.1" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="7" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;ScaleY: 11.1&#xD;&#xA;A: 0, -1&#xD;&#xA;C: 0,  1&#xD;&#xA;" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 光轮位置" Id="9171ae5b-7bce-469f-98f8-bc68488e1c17" RegularExpression="^.{15}\S+ 03:4.{7}:([^:]*:){7}17821:([^:]*:){6}(?&lt;x&gt;(8|11)[45][^:]*):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="17821火 17822雷 正北逆四个固定同色，所以只需要看正左右哪个是火" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a1_光轮_is右safe" VariableExpression="(${x} &gt; 100) = ${v:U7a1_光轮_is火safe}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;ScaleX: 0${v:U7a1_光轮_is右safe} ? 1 : -1&#xD;&#xA;ScaleY: 11.1&#xD;&#xA;A: 0, -1&#xD;&#xA;1: 3, -1&#xD;&#xA;D: 6, -1&#xD;&#xA;4: 9, -1&#xD;&#xA;C: 0,  1&#xD;&#xA;3: 3,  1&#xD;&#xA;B: 6,  1&#xD;&#xA;2: 9,  1" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="4" ActionType="Placeholder" ExecutionDelayExpression="2600" />
<Action OrderNumber="5" ActionType="Placeholder" Description="二段雷判定" DescriptionOverride="True" />
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;ScaleX: 0${v:U7a1_光轮_is右safe} ? 1 : -1&#xD;&#xA;// 准确击退到空隙的 y&#xD;&#xA;ScaleY: 6.87&#xD;&#xA;1:  6.1, -1&#xD;&#xA;A:  9.6, -1&#xD;&#xA;4: 13.1, -1&#xD;&#xA;D: 16.6, -1&#xD;&#xA;3:  6.1,  1&#xD;&#xA;C:  9.6,  1&#xD;&#xA;2: 13.1,  1&#xD;&#xA;B: 16.6,  1" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="7" ActionType="Placeholder" ExecutionDelayExpression="4600" />
<Action OrderNumber="8" ActionType="Placeholder" Description="一段火判定" DescriptionOverride="True" />
<Action OrderNumber="9" UseTTSTextExpression="贴近击退" ActionType="UseTTS" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;ScaleX: 0${v:U7a1_光轮_is右safe} ? 1 : -1&#xD;&#xA;// 准确击退到空隙的 y&#xD;&#xA;ScaleY: 6.87&#xD;&#xA;1:  1.6, -1&#xD;&#xA;A:  6.6, -1&#xD;&#xA;4: 11.6, -1&#xD;&#xA;D: 16.6, -1&#xD;&#xA;3:  1.6,  1&#xD;&#xA;C:  6.6,  1&#xD;&#xA;2: 11.6,  1&#xD;&#xA;B: 16.6,  1" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="11" ActionType="Placeholder" ExecutionDelayExpression="3700" />
<Action OrderNumber="12" ActionType="Placeholder" Description="光轮判定" DescriptionOverride="True" />
<Action OrderNumber="13" UseTTSTextExpression="分摊" ActionType="UseTTS" />
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 火分摊连线 =&gt; 4" Id="a93621fe-7459-4997-a10f-6e404ae79c7a" RegularExpression="^.{15}\S+ 1A:1045:[^:]+:[^:]+:.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableName="U7a1_光轮_火idx" ListVariableExpression="${l:party.indexof(${tid})}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="U7a1_光轮_火idx:${l:U7a1_光轮_火idx.join(:)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_光轮_火idx.size}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="false" Name="4. 换位" Id="c37e357b-ee15-4db5-9a09-f240d6156bb2" RegularExpression="^U7a1_光轮_火idx">
<Actions>
<Action OrderNumber="1" ListVariableOp="SortNumericAsc" ListVariableName="U7a1_光轮_火idx" ActionType="ListVariable" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="2200" />
<Action OrderNumber="3" ActionType="Placeholder" Asynchronous="False" Description="每组一个" DescriptionOverride="True" />
<Action OrderNumber="4" UseTTSTextExpression="不用换位，等待击退" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_光轮_火idx[1]} &lt;= 4 &amp;&amp; ${l:U7a1_光轮_火idx[2]} &gt; 4" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" ActionType="Placeholder" Asynchronous="False" Description="同组双连线、点名自己" DescriptionOverride="True" />
<Action OrderNumber="6" UseTTSTextExpression="同组双连线，需要换位" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="(${l:U7a1_光轮_火idx[2]} &lt;= 4 || ${l:U7a1_光轮_火idx[1]} &gt; 4) &amp;&amp; ${l:U7a1_光轮_火idx.contain(${v:myIdx})}" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" ActionType="Placeholder" Asynchronous="False" Description="同组双连线、未点名自己" DescriptionOverride="True" />
<Action OrderNumber="8" UseTTSTextExpression="不用换位，等待击退" ActionType="UseTTS">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="(${l:U7a1_光轮_火idx[2]} &lt;= 4 &amp;&amp; ${v:myIdx} &lt;= 4) || (${l:U7a1_光轮_火idx[1]} &gt; 4 &amp;&amp; ${v:myIdx} &gt; 4)" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_光轮_火idx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" ActionType="Placeholder" Asynchronous="False" Description="同组无连线" DescriptionOverride="True" />
<Action OrderNumber="10" UseTTSTextExpression="${if: 0${v:myIdx} &gt; 4 ? DPS : 坦克 }补位" ActionType="UseTTS">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="(${l:U7a1_光轮_火idx[2]} &lt;= 4 &amp;&amp; ${v:myIdx} &gt; 4) || (${l:U7a1_光轮_火idx[1]} &gt;= 4 &amp;&amp; ${v:myIdx} &lt; 4)" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="光轮缩放+透明度" Id="e3defa97-08f8-4e39-aa2b-4e8f9307085a" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}(?&lt;bnpcid&gt;1782[12]):">
<Actions>
<Action OrderNumber="1" NamedCallbackName="SetOpacity" NamedCallbackParam="${_entity[${id}].address}, ${n: (${bnpcid} = 17821) = ${v:U7a1_光轮_is火safe} ? 0.5 : 1}" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="2" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, ${n: (${bnpcid} = 17821) = ${v:U7a1_光轮_is火safe} ? 0.6 : 0.6}" ActionType="NamedCallback" ExecutionDelayExpression="250" DescTextColor="26f" />
<Action OrderNumber="3" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, ${n: (${bnpcid} = 17821) = ${v:U7a1_光轮_is火safe} ? 0.6 : 0.6}" ActionType="NamedCallback" ExecutionDelayExpression="250" DescTextColor="26f" />
<Action OrderNumber="4" NamedCallbackName="SetOpacity" NamedCallbackParam="${_entity[${id}].address}, ${n: (${bnpcid} = 17821) = ${v:U7a1_光轮_is火safe} ? 1 : 1}" ActionType="NamedCallback" ExecutionDelayExpression="8400" DescTextColor="26f" />
<Action OrderNumber="5" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, ${n: (${bnpcid} = 17821) = ${v:U7a1_光轮_is火safe} ? 1 : 2}" ActionType="NamedCallback" DescTextColor="26f" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="67f788b2-a088-4869-bc58-7bd01cf764e8" Name="C. 四线" Enabled="true" RawEnvironmentVariables="phase = P1四线">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 落地" Id="317c41d5-180a-4263-bc0f-12b5886d93d2" RegularExpression="^.{15}\S+ AAA:10F:4.{7}:[^:]*:9707:17819:100">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a1_四线" ActionType="Variable" />
<Action OrderNumber="3" UseTTSTextExpression="流血AoE" ActionType="UseTTS" />
<Action OrderNumber="4" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;A:  0, -5.0&#xD;&#xA;B:  0, -7.5&#xD;&#xA;1:  2.17, -5.24&#xD;&#xA;2: -2.17, -5.24&#xD;&#xA;C:  0,  5.0&#xD;&#xA;D:  0,  7.5&#xD;&#xA;3: -2.17,  5.24&#xD;&#xA;4:  2.17,  5.24" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="5" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="34000" DescBgColor="dff" />
<Action OrderNumber="6" UseTTSTextExpression="流血AoE" ActionType="UseTTS" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="2. 处理数据 =&gt; 3" Id="c6ca74b2-833b-428d-9810-41f488c31325" RegularExpression="^U7a1_四线_处理">
<Actions>
<Action OrderNumber="1" ListVariableOp="Build" ListVariableExpression=",1,2,3,4,5,6,7,8" ListVariableTarget="U7a1_四线_无点名idx" ActionType="ListVariable" />
<Action OrderNumber="2" ListVariableOp="Filter" ListVariableExpressionType="Numeric" ListVariableName="U7a1_四线_无点名idx" ListVariableExpression="!${l:U7a1_四线_点名idx.contain(${_this})}" ListVariableTarget="U7a1_四线_无点名idx" ActionType="ListVariable" />
<Action OrderNumber="3" LogMessageText="U7a1_四线:is雷:${l:U7a1_四线_is雷.join(&quot;&quot;)}:点名:${l:U7a1_四线_点名idx.join(&quot;&quot;)}:无点名:${l:U7a1_四线_无点名idx.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 获取连线 =&gt; 2" Id="8327b96b-a427-45e0-9981-0349b9636b1f" RegularExpression="^.{15}\S+ 23:4.{7}:[^:]*:(?&lt;tid&gt;1.{7}):[^:]*:0000:0000:(?&lt;type&gt;011F|00F9):">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableName="U7a1_四线_点名idx" ListVariableExpression="${l:party.indexof(${tid})}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" ListVariableOp="Push" ListVariableExpressionType="Numeric" ListVariableName="U7a1_四线_is雷" ListVariableExpression="${type} == 011F" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="3" NamedCallbackName="command" NamedCallbackParam="/e ${f:toxivchar:${l:U7a1_四线_is雷.size}} ${if: ${l:U7a1_四线_is雷[-1]} ? 雷 : 火} 》 ${_entity[${tid}].jobEN3}" ActionType="NamedCallback" Asynchronous="False" />
<Action OrderNumber="4" LogMessageText="U7a1_四线_处理" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_四线_is雷.size}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${tid}].address}, ${n: 258 + ${l:U7a1_四线_is雷.size}}" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="6" UseTTSTextExpression="点名${l:U7a1_四线_is雷.size}号${if: ${l:U7a1_四线_is雷[-1]} ? 雷 : 火}，去${if: ${l:U7a1_四线_is雷.size} % 2 = 1 ? 上北 : 下南 }" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${tid}" ExpressionTypeL="String" ExpressionR="${_me.id}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3.3 文本播报" Id="f622f7d2-a726-46f7-9619-d86241fcf250" RegularExpression="^U7a1_四线:is雷:(?&lt;is雷1&gt;.)(?&lt;is雷2&gt;.)(?&lt;is雷3&gt;.)(?&lt;is雷4&gt;.):点名:(?&lt;点名1&gt;.)(?&lt;点名2&gt;.)(?&lt;点名3&gt;.)(?&lt;点名4&gt;.):无点名:(?&lt;无1&gt;.)(?&lt;无2&gt;.)(?&lt;无3&gt;.)(?&lt;无4&gt;.)">
<Actions>
<Action OrderNumber="1" NamedCallbackName="command" NamedCallbackParam="/e &#xD;&#xA;線：1 ${if: ${is雷1} ? 雷 : 火 }  2 ${if: ${is雷2} ? 雷 : 火 }  3 ${if: ${is雷3} ? 雷 : 火 }  4 ${if: ${is雷4} ? 雷 : 火 }&#xD;&#xA;无：${_entity[${l:party[${无1}]}].jobEN3} 》 ${_entity[${l:party[${无2}]}].jobEN3} 》 ${_entity[${l:party[${无3}]}].jobEN3} 》 ${_entity[${l:party[${无4}]}].jobEN3}" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3.4 vfx 标记" Id="b3cc6fac-8bae-4909-aad4-83a769d47f58" RegularExpression="^U7a1_四线:">
<Actions>
<Action OrderNumber="1" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[${l:U7a1_四线_无点名idx[1]}]}].address}, 419" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="2" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[${l:U7a1_四线_无点名idx[2]}]}].address}, 420" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="3" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[${l:U7a1_四线_无点名idx[3]}]}].address}, 421" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="4" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[${l:U7a1_四线_无点名idx[4]}]}].address}, 422" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="5" ActionType="Placeholder" ExecutionDelayExpression="14000" />
<Action OrderNumber="6" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[1]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="7" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[2]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="8" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[3]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="9" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[4]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="10" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[5]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="11" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[6]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="12" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[7]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="13" NamedCallbackName="SetStatusLoopVfx" NamedCallbackParam="${_entity[${l:party[8]}].address}, 0" ActionType="NamedCallback" DescTextColor="26f" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3.2 点名时间轴" Id="52448d22-2c8a-41cc-a728-9a7dfa4094fe" RegularExpression="^U7a1_四线:">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" ExecutionDelayExpression="${l:U7a1_四线_点名idx.indexof(${v:myIdx})} % 2 = 1 ? 5000 : 8000" Asynchronous="False" />
<Action OrderNumber="2" UseTTSTextExpression="${if: ${l:U7a1_四线_点名idx.indexof(${v:myIdx})} &lt;= 2 ? &quot;后退，引导&quot; : &quot;前进，&quot; }${if: ${l:U7a1_四线_is雷[${n: ${l:U7a1_四线_点名idx.indexof(${v:myIdx})} % 2 = 0 ? 4 : 3 }]} ? 雷分散 : 火分摊 }" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_四线_无点名idx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3.1 无点名时间轴" Id="4503e1f9-4550-4849-8f22-76f37813730f" RegularExpression="^U7a1_四线:">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="${l:U7a1_四线_无点名idx.indexof(${v:myIdx})}号无点名，${if: ${l:U7a1_四线_无点名idx.indexof(${v:myIdx})} &gt; 2 ? 下南 : 上北 }引导${if: ${l:U7a1_四线_is雷[${n: ${l:U7a1_四线_无点名idx.indexof(${v:myIdx})} &gt; 2 ? 2 : 1 }]} ? 雷分散 : 火分摊 }" ActionType="UseTTS" />
<Action OrderNumber="2" UseTTSTextExpression="引导${if: ${l:U7a1_四线_is雷[${n: ${l:U7a1_四线_无点名idx.indexof(${v:myIdx})} &gt; 2 ? 4 : 3 }]} ? 雷分散 : 火分摊 }" ActionType="UseTTS" ExecutionDelayExpression="${l:U7a1_四线_无点名idx.indexof(${v:myIdx})} &gt; 2 ? 8000 : 5000" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a1_四线_无点名idx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
</Triggers>
</Folder>
<Folder Id="03c2ef3d-4722-4ea4-bf84-e860c8d446bf" Name="D. 六人塔" Enabled="true">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="1. 获取塔 * 3 =&gt; 2" Id="863ba2f0-78c7-4e73-91bd-0773ffc17c4f" RegularExpression="^.{15}\S+ 107:4.{7}:(?&lt;aid&gt;9CC[37]|9CB[ABCDEF]):(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ListVariableOp="Set" ListVariableName="U7a1_塔_人数" ListVariableExpression="${?d: 9CC3 = 1, 9CC7 = 1, 9CBA = 2, 9CBB = 3, 9CBC = 4, 9CBD = 2, 9CBE = 3, 9CBF = 4 [${aid}]}" ListVariableIndex="round(${y} / 10) - 8" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a1_塔_is火" VariableExpression="${aid} == 9CC3 || ${aid} == 9CBA || ${aid} == 9CBB || ${aid} == 9CBC" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" VariableOp="SetNumeric" VariableName="U7a1_塔_is右" VariableExpression="${x} &gt; 100" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="4" VariableOp="Increment" VariableName="U7a1_塔_n" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="5" LogMessageText="U7a1_塔:${l:U7a1_塔_人数.join(&quot;&quot;)}:is右:${v:U7a1_塔_is右}:is火:${v:U7a1_塔_is火}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a1_塔_n}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="2. 播报" Id="ee53afe8-45ff-48fb-b14e-0da6c12178d9" RegularExpression="^U7a1_塔:(?&lt;cnt&gt;[1234]{3}):is右:(?&lt;is右&gt;[01]):is火:(?&lt;is火&gt;[01])">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Description="T = 0，从上到下 = 1 2 3   （H1 H2 D4 固定，D123补位）" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="U7a1_塔_自己补塔" VariableExpression="${f:slice(${v:myIdx}):00013${?d: 114 = 333, 141 = 222, 411 = 111, 123 = 332, 132 = 232, 213 = 133, 231 = 122, 312 = 131, 321 = 112, 222 = 222 [${cnt}]}2}" ActionType="Variable" />
<Action OrderNumber="3" UseTTSTextExpression="去${if: ${is右} ? 左 : 右 }侧，${if: ${is火} ? 火击退 : 雷远离 }" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericLessEqual" />
</Condition>
</Action>
<Action OrderNumber="4" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;ScaleX: 0${is右} ? -1 : 1&#xD;&#xA;Waymarks: AB1234CD&#xD;&#xA;Start: 6.25, -12&#xD;&#xA;End:   6.25, 12" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericLessEqual" />
</Condition>
</Action>
<Action OrderNumber="5" UseTTSTextExpression="${?d: 01 = 左上, 02 = 正左, 03 = 左下, 11 = 右上, 12 = 正右, 13 = 右下 [${is右}${v:U7a1_塔_自己补塔}]}踩塔，${if: ${is火} ? 火击退 : 雷远离 }" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;ScaleX: 0${is右} ? 1 : -1&#xD;&#xA;Waymarks: 1234&#xD;&#xA;Start: 6.25, -3.3 + (${v:U7a1_塔_自己补塔} - 2) * 9.17&#xD;&#xA;End:   6.25,  3.3 + (${v:U7a1_塔_自己补塔} - 2) * 9.17&#xD;&#xA;---&#xD;&#xA;B: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="7" ActionType="Placeholder" ExecutionDelayExpression="6200" />
<Action OrderNumber="8" />
<Action OrderNumber="9" UseTTSTextExpression="${if: ${is火} ? 靠近 : 远离 }，开减伤" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericLessEqual" />
</Condition>
</Action>
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;ScaleX: (0${is右} ? -1 : 1) * (${is火} ? 1.25 : 11.25)&#xD;&#xA;Waymarks: AB1234CD&#xD;&#xA;Start: 1, -12&#xD;&#xA;End:   1, 12" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericLessEqual" />
</Condition>
</Action>
<Action OrderNumber="11" UseTTSTextExpression="${if: ${is火} ? 靠近 : 远离 }" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="12" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;ScaleX: (0${is右} ? 1 : -1) * (${is火} ? 1.25 : 11.25)&#xD;&#xA;Waymarks: 1234&#xD;&#xA;Start: 1, -3.3 + (${v:U7a1_塔_自己补塔} - 2) * 9.17&#xD;&#xA;End:   1,  3.3 + (${v:U7a1_塔_自己补塔} - 2) * 9.17" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="13" NamedCallbackName="command" NamedCallbackParam="/e ${_event}" ActionType="NamedCallback" />
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="4400" DescBgColor="dff" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="c86531d0-173e-481a-93c9-3d95d4ee5d14" Name=".控制" Enabled="true">
<Folders>
<Folder Id="580b8169-b3e1-4aeb-8482-933bbbf99b3c" Name="标点" Enabled="true">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="标点保存" Id="d262adb3-d420-4539-bef3-6627d561592d" RegularExpression="^.{15}\S+ 1C:">
<Actions>
<Action OrderNumber="1" NamedCallbackName="place" NamedCallbackParam="save" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="标点重载" Id="52d55b00-799a-4488-a2c1-675b0bf24777" RegularExpression="^.{15}\S+ 21:.{8}:40000006|^.{15}\S+ 104:1:1">
<Actions>
<Action OrderNumber="1" NamedCallbackName="place" NamedCallbackParam="load" ActionType="NamedCallback" />
<Action OrderNumber="2" NamedCallbackName="place" NamedCallbackParam="save" ActionType="NamedCallback" ExecutionDelayExpression="2000" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers>
<Trigger Enabled="true" Sequential="True" Name="团灭中断动作 + 重置战斗" Id="bf38cf37-def1-4ca2-bca6-1a138fcd11bb" RegularExpression="^.{15}\S+ 21:.{8}:40000011">
<Actions>
<Action OrderNumber="1" FolderId="0ce40102-dbad-4ebf-b5d1-c50aa2bd41d4" ActionType="ActInteraction" />
<Action OrderNumber="2" VariableName="U7a2_滑冰_loop" ActionType="Variable" />
<Action OrderNumber="3" FolderOp="CancelFolder" FolderId="783e52c2-3842-4611-b2c6-bdc6eafd3de3" ActionType="Folder" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="0. 初始化" Id="0e4f94bc-e4f5-4fd4-9ff4-509fba40cf7b" RegularExpression="^.{15}\S+ 104:.:1:.:1">
<Actions>
<Action OrderNumber="1" VariableOp="UnsetRegexUniversal" VariableName="^U7a\d*_|^tmp_" ActionType="Variable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="小队列表注册区域" Id="b7170d53-af30-4ecf-bf31-f1dfd510e7e3" RegularExpression="^.{15}\S+ 01:(?&lt;zoneId&gt;[^:]*):">
<Actions>
<Action OrderNumber="1" LogMessageText="PartyList:Register:${n: 0x${zoneId} }:MT, ST, H1, H2, D1, D2, D3, D4" LogProcess="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="[F] 注册回调" Id="2691fd47-645c-43ee-b400-65745f761df7" RegularExpression="^.{15}\S+ 01">
<Actions>
<Action OrderNumber="1" ExecScriptExpression="using System;&#xD;&#xA;using System.Globalization;&#xD;&#xA;using static System.Math;&#xD;&#xA;using static Triggernometry.PluginBridges.BridgeFFXIV;&#xD;&#xA;using static Triggernometry.Interpreter.StaticHelpers;&#xD;&#xA;using Triggernometry;&#xD;&#xA;&#xD;&#xA;RealPlugin.plug.RegisterNamedCallback(&#xD;&#xA;    &quot;U7a2_IceSkatingSolver&quot;, &#xD;&#xA;    new Action&lt;object, string&gt;(U7a2_IceSkatingSolver.Callback), &#xD;&#xA;    null, &#xD;&#xA;    registrant: &quot;绝伊甸宝宝椅&quot;&#xD;&#xA;);&#xD;&#xA;&#xD;&#xA;public static class U7a2_IceSkatingSolver&#xD;&#xA;{&#xD;&#xA;    static int ShivaDir8;&#xD;&#xA;    static double Shivaθ;&#xD;&#xA;&#xD;&#xA;    public static void Callback(object _, string command)&#xD;&#xA;    {&#xD;&#xA;        switch (command.ToLower().Trim())&#xD;&#xA;        {&#xD;&#xA;            case &quot;init&quot;: Init(); break;&#xD;&#xA;            case &quot;solve&quot;: Solve(); break;&#xD;&#xA;            default: throw new ArgumentException(&quot;U7a2_IceSkatingSolver: Invalid command. Expecting \&quot;init\&quot; or \&quot;solve\&quot;.&quot;);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static void Init()&#xD;&#xA;    {&#xD;&#xA;        ShivaDir8 = (int)ParseDouble(GetScalarVariable(false, &quot;U7a2_滑冰_冰dir8&quot;));&#xD;&#xA;        Shivaθ = (ShivaDir8 - 4) * PI / 4;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static void Solve()&#xD;&#xA;    {&#xD;&#xA;        var me = GetIdEntity(PlayerHexId);&#xD;&#xA;        var absPos = new Point { X = ParseDouble(me.GetValue(&quot;x&quot;)), Y = ParseDouble(me.GetValue(&quot;y&quot;)) };&#xD;&#xA;        var relPos = absPos.AbsToRel();&#xD;&#xA;        if (relPos.Y &lt; -Abs(relPos.X) - 10) // 背面&#xD;&#xA;        {&#xD;&#xA;            RecordState(PositionStateEnum.Back);&#xD;&#xA;            return;&#xD;&#xA;        }&#xD;&#xA;        if (relPos.X * relPos.X + relPos.Y * relPos.Y &lt;= 12 * 12) // 中心&#xD;&#xA;        {&#xD;&#xA;            RecordState(PositionStateEnum.Center);&#xD;&#xA;            return;&#xD;&#xA;        }&#xD;&#xA;        if (!CanSkateToShivaBack(relPos.X, relPos.Y))&#xD;&#xA;        {&#xD;&#xA;            RecordState(PositionStateEnum.Side);&#xD;&#xA;            return;&#xD;&#xA;        }&#xD;&#xA;        var safestRelθ = SolveSafestAngle(relPos.X, relPos.Y);&#xD;&#xA;        var safestAbsθ = safestRelθ + (Shivaθ - PI);&#xD;&#xA;        RecordState(PositionStateEnum.Front, safestAbsθ);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    enum PositionStateEnum { &#xD;&#xA;        /// &lt;summary&gt; 希瓦身后 &lt;/summary&gt;&#xD;&#xA;        Back,&#xD;&#xA;        /// &lt;summary&gt; 希瓦前方，可一次滑冰到背后的区域 &lt;/summary&gt;&#xD;&#xA;        Front,&#xD;&#xA;        /// &lt;summary&gt; 场中 12 米内且不在身后，无解&lt;/summary&gt;&#xD;&#xA;        Center,&#xD;&#xA;        /// &lt;summary&gt; 希瓦侧面，不可一次滑冰到背后的区域 &lt;/summary&gt;&#xD;&#xA;        Side&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static void RecordState(PositionStateEnum state, double θ = 0)&#xD;&#xA;    { &#xD;&#xA;        SetScalarVariable(false, &quot;U7a2_滑冰_PositionState&quot;, state);&#xD;&#xA;        SetScalarVariable(false, &quot;U7a2_滑冰_Safestθ&quot;, θ.ToString(CultureInfo.InvariantCulture));&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; &#xD;&#xA;    /// 判断是否可以从指定位置滑向希瓦背后。&lt;br /&gt;&#xD;&#xA;    /// 判据为希瓦背后的场地边缘上所有点为圆心、半径 32 的圆周在南侧场地形成的包络线，&lt;br /&gt;&#xD;&#xA;    /// 以抛物线近似计算（留有一定容错）。&#xD;&#xA;    /// &lt;/summary&gt;&#xD;&#xA;    static bool CanSkateToShivaBack(double relX, double relY) =&gt; -relY &lt; 0.03 * relX * relX - 12.1;&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 根据指定位置， &lt;/summary&gt;&#xD;&#xA;    static double SolveSafestAngle(double relX, double relY)&#xD;&#xA;    {&#xD;&#xA;        // 希瓦处于相对北 (0, -10)&#xD;&#xA;        // 若当前处于左半场：对称到右半场计算&#xD;&#xA;        if (relX &lt; 0)  &#xD;&#xA;            return -SolveSafestAngle(-relX, relY);&#xD;&#xA;        // 希瓦处于相对北，身后有三条边缘：上方场地圆周、左侧 y = x - 10，右侧 y = -x - 10&#xD;&#xA;        // 若当前处于以身后区域右侧尖端为圆心、32 为半径的圆形区域内：&#xD;&#xA;        //   滑冰角度范围由当前所处位置为圆心、半径 32 的圆周 与 左侧边缘、上方圆周的两个交点确定.&#xD;&#xA;        // 若当前处于以身后区域右侧尖端为圆心、32 为半径的圆形区域外：&#xD;&#xA;        //   滑冰角度范围由当前所处位置为圆心、半径 32 的圆周 与 左右两边缘的交点确定.&#xD;&#xA;        bool isInside = (relX - 8.23) * (relX - 8.23) + (relY + 18.23) * (relY + 18.23) &lt;= 32 * 32;&#xD;&#xA;        Point left = 滑冰圆与左边界交点(relX, relY);&#xD;&#xA;        Point right = isInside ? 滑冰圆与场地交点(relX, relY) : 滑冰圆与右边界交点(relX, relY);&#xD;&#xA;        var leftθ = Atan2(left.X - relX, left.Y - relY);&#xD;&#xA;        var rightθ = Atan2(right.X - relX, right.Y - relY);&#xD;&#xA;        var diff = (rightθ - leftθ + 4 * PI) % (2 * PI);&#xD;&#xA;        if (diff &gt; PI) diff -= 2 * PI;&#xD;&#xA;        return leftθ + diff / 2;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static Point 滑冰圆与左边界交点(double x0, double y0)&#xD;&#xA;    {&#xD;&#xA;        // (x-x0)^2 + (y-y0)^2 = 32^2 与 y = x - 10 的交点（靠上的）&#xD;&#xA;        var a = 2.0;&#xD;&#xA;        var b = 2 * (10 - x0 - y0);&#xD;&#xA;        var c = y0 * y0 + (x0 - 10) * (x0 - 10) - 1024;&#xD;&#xA;        var y = (-b - Sqrt(b * b - 4 * a * c)) / (2 * a);&#xD;&#xA;        var x = y + 10;&#xD;&#xA;        return new Point { X = x, Y = y };&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static Point 滑冰圆与右边界交点(double x0, double y0)&#xD;&#xA;    {&#xD;&#xA;        // (x-x0)^2 + (y-y0)^2 = 32^2 与 y = x + 10 的交点（靠上的）&#xD;&#xA;        var symPoint = 滑冰圆与左边界交点(-x0, y0);&#xD;&#xA;        return new Point { X = -symPoint.X, Y = symPoint.Y };&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static Point 滑冰圆与场地交点(double x0, double y0)&#xD;&#xA;    {&#xD;&#xA;        // (x-x0)^2 + (y-y0)^2 = 32^2 与 x^2 + y^2 = 20^2 的交点（靠上的）&#xD;&#xA;        var squareSum = x0 * x0 + y0 * y0;&#xD;&#xA;        var a = 4 * squareSum;&#xD;&#xA;        var b = -4 * x0 * (squareSum - 624);&#xD;&#xA;        var c = (squareSum - 624) * (squareSum - 624) - 1600 * y0 * y0;&#xD;&#xA;        var x = (-b + Sqrt(b * b - 4 * a * c)) / (2 * a);&#xD;&#xA;        var y = -Sqrt(400 - x * x);&#xD;&#xA;        return new Point { X = x, Y = y };&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    struct Point&#xD;&#xA;    {&#xD;&#xA;        public double X;&#xD;&#xA;        public double Y;&#xD;&#xA;&#xD;&#xA;        /// &lt;summary&gt; 以场中为中心、希瓦为相对北，将场地坐标转换为相对坐标。&lt;/summary&gt;&#xD;&#xA;        public Point AbsToRel()&#xD;&#xA;        {&#xD;&#xA;            var sin = Sin(Shivaθ);&#xD;&#xA;            var cos = Cos(Shivaθ);&#xD;&#xA;            return new Point { &#xD;&#xA;                X = -(X - 100) * cos + (Y - 100) * sin,&#xD;&#xA;                Y = -(X - 100) * sin - (Y - 100) * cos,&#xD;&#xA;            };&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;        /// &lt;summary&gt; 以场中为中心、希瓦为相对北，将相对坐标转换为场地坐标。&lt;/summary&gt;&#xD;&#xA;        public Point RelToAbs()&#xD;&#xA;        {&#xD;&#xA;            var sin = Sin(Shivaθ);&#xD;&#xA;            var cos = Cos(Shivaθ);&#xD;&#xA;            return new Point&#xD;&#xA;            {&#xD;&#xA;                X = -X * cos - Y * sin + 100,&#xD;&#xA;                Y =  X * sin - Y * cos + 100,&#xD;&#xA;            };&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static double ParseDouble(object s) =&gt; double.Parse(s.ToString(), NumberStyles.Float, CultureInfo.InvariantCulture);&#xD;&#xA;}" ActionType="ExecuteScript" Asynchronous="False" Description="U7a2_IceSkatingSolver　　　P2 滑冰指示方向" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ecallback:U7a2_IceSkatingSolver}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="2" ExecScriptExpression="using System;&#xD;&#xA;using System.Collections.Generic;&#xD;&#xA;using System.Linq;&#xD;&#xA;using System.Numerics;&#xD;&#xA;using System.Globalization;&#xD;&#xA;using Triggernometry;&#xD;&#xA;using Triggernometry.FFXIV;&#xD;&#xA;using static Triggernometry.Debug;&#xD;&#xA;using static System.Math;&#xD;&#xA;using static Triggernometry.Interpreter.StaticHelpers;&#xD;&#xA;using static Triggernometry.PluginBridges.BridgeFFXIV;&#xD;&#xA;using System.Data;&#xD;&#xA;&#xD;&#xA;RealPlugin.plug.RegisterNamedCallback(&#xD;&#xA;    &quot;U7a3_一运_Analyzer&quot;,&#xD;&#xA;    new Action&lt;object, string&gt;(U7a3_一运_Analyzer.Callback),&#xD;&#xA;    null,&#xD;&#xA;    registrant: &quot;绝伊甸警察&quot;&#xD;&#xA;);&#xD;&#xA;&#xD;&#xA;public class U7a3_一运_Analyzer&#xD;&#xA;{&#xD;&#xA;    public static bool Debug = true;&#xD;&#xA;&#xD;&#xA;    public static U7a3_一运_Analyzer Instance;&#xD;&#xA;    public static void Callback(object _, string data)&#xD;&#xA;    {&#xD;&#xA;        var args = data.Split('\n')&#xD;&#xA;            .Select(line =&gt; line.Split(new[] { '=' }, 2))&#xD;&#xA;            .Where(parts =&gt; parts.Length == 2)&#xD;&#xA;            .ToDictionary(&#xD;&#xA;                parts =&gt; parts[0].Trim().ToLower(),&#xD;&#xA;                parts =&gt; parts[1].Trim()&#xD;&#xA;            );&#xD;&#xA;        if (Debug)&#xD;&#xA;        {&#xD;&#xA;            Command($&quot;/e [Debug] {string.Join(&quot; | &quot;, args.Select(kv =&gt; kv.Key + &quot; = &quot; + kv.Value))}&quot;);&#xD;&#xA;        }&#xD;&#xA;        switch (args[&quot;command&quot;].ToLower())&#xD;&#xA;        {&#xD;&#xA;            case &quot;init&quot;: Instance = new U7a3_一运_Analyzer(); break;&#xD;&#xA;            case &quot;rotate&quot;: Instance.ParseRotate(args); break;&#xD;&#xA;            case &quot;ability&quot;: Instance.ParseAbility(args); break;&#xD;&#xA;            case &quot;return&quot;: Instance.ParseReturn(args); break;&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 是否为国际服客户端，影响播报简繁体。 &lt;/summary&gt;&#xD;&#xA;    bool IsGlobal;&#xD;&#xA;    /// &lt;summary&gt; 按照 MT-D4 排序的八个玩家。 &lt;/summary&gt;&#xD;&#xA;    List&lt;Player&gt; Party;&#xD;&#xA;    /// &lt;summary&gt; 按照绝对 Dir8 排序的八个玩家。 &lt;/summary&gt;&#xD;&#xA;    List&lt;Player&gt; PlayersByDir8;&#xD;&#xA;    /// &lt;summary&gt; 按照绝对 Dir8 排序的八个沙漏 ID。 &lt;/summary&gt;&#xD;&#xA;    List&lt;HourGlass&gt; HourGlassesByDir8;&#xD;&#xA;&#xD;&#xA;    Dictionary&lt;string, Player&gt; PlayersById = new Dictionary&lt;string, Player&gt;();&#xD;&#xA;    Dictionary&lt;string, HourGlass&gt; HourGlassesById = new Dictionary&lt;string, HourGlass&gt;();&#xD;&#xA;    Dictionary&lt;Debuff, Player&gt; PlayersByDebuff = Enum.GetValues(typeof(Debuff)).Cast&lt;Debuff&gt;().ToDictionary(d =&gt; d, d =&gt; (Player)null);&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 连线的相对正北沙漏所处的绝对 Dir8。 &lt;/summary&gt;&#xD;&#xA;    int NorthDir8;&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 每次技能应判定到的 ID &lt;/summary&gt;&#xD;&#xA;    HashSet&lt;string&gt; Stack1, Stack2, Stack3, Stack4, Laser1, Laser2, Laser3;&#xD;&#xA;&#xD;&#xA;    enum AbilityEnum&#xD;&#xA;    {&#xD;&#xA;        黑暗神圣 = 0x9D55,&#xD;&#xA;        初始激光 = 0x9D2B,&#xD;&#xA;        旋转激光 = 0x9D64,&#xD;&#xA;        黑暗狂水 = 0x9D4F,&#xD;&#xA;        暗炎喷发 = 0x9D52,&#xD;&#xA;        黑暗爆炎 = 0x9D54,&#xD;&#xA;        黑暗冰封 = 0x9D57,&#xD;&#xA;        记录回返,&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 沙漏连线后，根据触发器存储的变量初始化全部状态（除旋转方向）。 &lt;/summary&gt;&#xD;&#xA;    U7a3_一运_Analyzer()&#xD;&#xA;    {&#xD;&#xA;        IsGlobal = GetMyself().GetValue(&quot;name&quot;).ToString().Contains(&quot; &quot;);&#xD;&#xA;        NorthDir8 = int.Parse(GetScalarVariable(false, &quot;U7a3_一运_dir8&quot;));&#xD;&#xA;        var partyIdxToId = GetListVariable(false, &quot;party&quot;).Values.Select(v =&gt; $&quot;{v}&quot;).ToList();&#xD;&#xA;        var partyIdxToDebuff = GetListVariable(false, &quot;U7a3_一运_全队点名&quot;).Values&#xD;&#xA;            .Select(v =&gt; (Debuff)int.Parse($&quot;{v}&quot;))&#xD;&#xA;            .ToList();&#xD;&#xA;        var 沙漏ByDir8 = GetDictVariable(false, &quot;U7a3_一运_沙漏dir8&quot;).Values&#xD;&#xA;            .OrderBy(v =&gt; $&quot;{v.Value}&quot;) // 按 Dir8 排序&#xD;&#xA;            .Select(v =&gt; $&quot;{v.Key}&quot;) // 取 ID&#xD;&#xA;            .ToList();&#xD;&#xA;&#xD;&#xA;        List&lt;Player&gt; players = new List&lt;Player&gt;();&#xD;&#xA;        List&lt;HourGlass&gt; hourGlasses = new List&lt;HourGlass&gt;();&#xD;&#xA;&#xD;&#xA;        for (int idx = 0; idx &lt; 8; idx++)&#xD;&#xA;        {&#xD;&#xA;            var playerID = partyIdxToId[idx];&#xD;&#xA;            var debuff = partyIdxToDebuff[idx];&#xD;&#xA;            var relDir8 = DebuffToRelDir8[debuff];&#xD;&#xA;            var dir8 = (relDir8 + NorthDir8) % 8;&#xD;&#xA;            var vdPlayer = GetIdEntity(playerID);&#xD;&#xA;            var name = vdPlayer.GetValue(&quot;name&quot;).ToString();&#xD;&#xA;            var job = Job.GetJob(vdPlayer.GetValue(&quot;jobEN3&quot;).ToString());&#xD;&#xA;            Player player = new Player&#xD;&#xA;            {&#xD;&#xA;                HexID = playerID,&#xD;&#xA;                Dir8 = dir8,&#xD;&#xA;                Debuff = debuff,&#xD;&#xA;                Role = (RoleEnum)idx,&#xD;&#xA;                Name = name,&#xD;&#xA;                Job = IsGlobal ? job.NameTCN2 : job.NameCN2&#xD;&#xA;            };&#xD;&#xA;            HourGlass hourGlass = new HourGlass&#xD;&#xA;            {&#xD;&#xA;                Dir8 = dir8,&#xD;&#xA;                HexID = 沙漏ByDir8[dir8],&#xD;&#xA;                Speed = RelDir8ToSpeed[relDir8],&#xD;&#xA;                Player = player,&#xD;&#xA;            };&#xD;&#xA;            player.HourGlass = hourGlass;&#xD;&#xA;            players.Add(player);&#xD;&#xA;            hourGlasses.Add(hourGlass);&#xD;&#xA;            PlayersByDebuff[debuff] = player;&#xD;&#xA;            PlayersById[playerID] = player;&#xD;&#xA;            HourGlassesById[沙漏ByDir8[dir8]] = hourGlass;&#xD;&#xA;        }&#xD;&#xA;&#xD;&#xA;        PlayersByDebuff[Debuff.短或冰TH] = PlayersByDebuff[Debuff.短TH] ?? PlayersByDebuff[Debuff.冰TH];&#xD;&#xA;        PlayersByDebuff[Debuff.长或冰D] = PlayersByDebuff[Debuff.长D] ?? PlayersByDebuff[Debuff.冰D];&#xD;&#xA;&#xD;&#xA;        Party = players.OrderBy(p =&gt; p.Role).ToList();&#xD;&#xA;        PlayersByDir8 = players.OrderBy(p =&gt; p.Dir8).ToList();&#xD;&#xA;        HourGlassesByDir8 = hourGlasses.OrderBy(h =&gt; h.Dir8).ToList();&#xD;&#xA;&#xD;&#xA;        Stack1 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.冰TH, Debuff.中TH, Debuff.长高TH, Debuff.长低TH, Debuff.中D, Debuff.长或冰D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Stack2 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.短或冰TH, Debuff.长高TH, Debuff.长低TH, Debuff.短高D, Debuff.短低D, Debuff.长或冰D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Stack3 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.短或冰TH, Debuff.中TH, Debuff.短高D, Debuff.短低D, Debuff.中D, Debuff.冰D }.&#xD;&#xA;            Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Stack4 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.长高TH, Debuff.长低TH, Debuff.中D, Debuff.长或冰D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Laser1 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.长高TH, Debuff.长低TH, Debuff.长或冰D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Laser2 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.短或冰TH, Debuff.短高D, Debuff.短低D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;        Laser3 = new HashSet&lt;string&gt;(new Debuff[] { Debuff.中TH, Debuff.中D }&#xD;&#xA;            .Select(d =&gt; PlayersByDebuff[d]?.HexID).Where(id =&gt; id != null));&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    /// &lt;summary&gt; 技能的第几次释放。 &lt;/summary&gt;&#xD;&#xA;    Dictionary&lt;AbilityEnum, int&gt; AbilityCount = Enum.GetValues(typeof(AbilityEnum)).Cast&lt;AbilityEnum&gt;().ToDictionary(ability =&gt; ability, ability =&gt; 0);&#xD;&#xA;&#xD;&#xA;    void ParseAbility(Dictionary&lt;string, string&gt; args)&#xD;&#xA;    {&#xD;&#xA;        var ability = (AbilityEnum)int.Parse(args[&quot;ability&quot;], NumberStyles.HexNumber);&#xD;&#xA;        AbilityCount[ability]++;&#xD;&#xA;        var targetCount = int.Parse(args[&quot;count&quot;]);&#xD;&#xA;        // if (Debug) Command($&quot;/e [Debug] {ability} #{AbilityCount[ability]}, count = {targetCount}&quot;);&#xD;&#xA;        if (targetCount == 0) return;&#xD;&#xA;&#xD;&#xA;        var target = PlayersById[args[&quot;target&quot;]];&#xD;&#xA;        var others = Context.SplitArguments(args[&quot;others&quot;]).Select(pid =&gt; PlayersById[pid]).ToList();&#xD;&#xA;        List&lt;Player&gt; targets = new List&lt;Player&gt; { target }.Concat(others).ToList();&#xD;&#xA;&#xD;&#xA;        try&#xD;&#xA;        {&#xD;&#xA;            string error;&#xD;&#xA;            switch (ability)&#xD;&#xA;            {&#xD;&#xA;                case AbilityEnum.初始激光:&#xD;&#xA;                    {&#xD;&#xA;                        var turn = new int[] { 0, 1, 1, 1, 2, 2, 2, 3, 3 }[AbilityCount[ability]];&#xD;&#xA;                        var correctPlayers = new HashSet&lt;string&gt;[] { null, Laser1, Laser2, Laser3 }[turn]; // 以防打法不同&#xD;&#xA;                        var srcPos = GetCurrentRelPos(args[&quot;source&quot;]);&#xD;&#xA;                        var hourglass = HourGlassesByDir8[(int)Round(Atan2(srcPos.X, srcPos.Y) / PI * 4 + 4) % 8];&#xD;&#xA;                        var correctPlayer = hourglass.Player;&#xD;&#xA;                        targets.ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;                        correctPlayer.UpdatePos();&#xD;&#xA;&#xD;&#xA;                        hourglass.BaitPlayer = target;&#xD;&#xA;                        hourglass.BaitDistance = Vector2.Distance(target.TempRelPos, hourglass.RelPos);&#xD;&#xA;                        var vec = target.TempRelPos - hourglass.RelPos;&#xD;&#xA;                        hourglass.Baitθ = ((Atan2(vec.X, vec.Y) - (hourglass.Dir8 / 4 * PI)) % (2 * PI) + 2 * PI) % (2 * PI) - PI;&#xD;&#xA;&#xD;&#xA;                        List&lt;string&gt; errors = new List&lt;string&gt;();&#xD;&#xA;                        bool isDirCorrect = (hourglass.Baitθ * (hourglass.Is顺 ? 1 : -1)) &gt;= 60 / 180 * PI &amp;&amp; (hourglass.Baitθ * (hourglass.Is顺 ? 1 : -1)) &lt;= 90 / 180 * PI;&#xD;&#xA;                        bool isTargetCorrect = correctPlayers.Contains(target.HexID);&#xD;&#xA;                        // if (Debug) Command($&quot;/e [Laser1] isDirCorrect = {isDirCorrect}; isTargetCorrect = {isTargetCorrect}; targetCount = {targetCount}&quot;);&#xD;&#xA;                        if (isDirCorrect &amp;&amp; isTargetCorrect &amp;&amp; targetCount == 1) return;&#xD;&#xA;&#xD;&#xA;                        if (!isDirCorrect)&#xD;&#xA;                        {&#xD;&#xA;                            if (Abs(hourglass.Baitθ) &gt; PI / 2)&#xD;&#xA;                                errors.Add($&quot;方向错误：射向场中&quot;);&#xD;&#xA;                            else if (hourglass.Baitθ * (hourglass.Is顺 ? 1 : -1) &lt; 0)&#xD;&#xA;                                errors.Add($&quot;方向错误：引导反向&quot;);&#xD;&#xA;                            else&#xD;&#xA;                                errors.Add($&quot;方向错误：应偏 ~80°，实偏 {Abs(hourglass.Baitθ):0}°&quot;);&#xD;&#xA;                            hourglass.BaitDirectionErrorDesc = errors[0];&#xD;&#xA;                        }&#xD;&#xA;&#xD;&#xA;                        if (!isTargetCorrect)&#xD;&#xA;                        {&#xD;&#xA;                            if (correctPlayer.TempR &lt; 9.5 || Abs(correctPlayer.TempRelθ) &gt; PI / 8)&#xD;&#xA;                                errors.Add($&quot;引导者错误：{correctPlayer.Role}（{correctPlayer.Job}）没去引导或距离过远&quot;);&#xD;&#xA;                            else if (hourglass.BaitDistance &lt;= 4.3)&#xD;&#xA;                                errors.Add($&quot;引导者错误：{target.Role}（{target.Job}）距沙漏 {hourglass.BaitDistance:0.0} m，不应引导&quot;);&#xD;&#xA;                            else&#xD;&#xA;                                errors.Add($&quot;引导者错误：情况复杂，无法判断&quot;);&#xD;&#xA;&#xD;&#xA;                        }&#xD;&#xA;&#xD;&#xA;                        if (targetCount &gt; 1 &amp;&amp; targetCount &lt;= 3)&#xD;&#xA;                        {&#xD;&#xA;                            errors.Add($&quot;命中目标 × {targetCount}：\n　 {string.Join(&quot;\n　》 &quot;, targets.Select(p =&gt; p.TempDesc))}&quot;);&#xD;&#xA;                        }&#xD;&#xA;                        else if (targetCount &gt; 3)&#xD;&#xA;                        {&#xD;&#xA;                            errors.Add($&quot;命中目标 × {targetCount}：\n　》 {string.Join(&quot;　&quot;, targets.Select(p =&gt; p.Role))}&quot;);&#xD;&#xA;                        }&#xD;&#xA;&#xD;&#xA;                        error = $&quot;【{ability}】错误（{Dir8Desc[hourglass.Dir8]}）\n{string.Join(&quot;\n&quot;, errors)}&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                case AbilityEnum.旋转激光:&#xD;&#xA;                    {&#xD;&#xA;                        var turn = new int[] { 0, 1, 1, 1, 2, 2, 2, 3, 3 }[(int)Ceiling(AbilityCount[ability] / 8.0)];&#xD;&#xA;                        var subturn = new int[] { 0, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8 }[AbilityCount[ability]];&#xD;&#xA;                        var correctPlayers = new HashSet&lt;string&gt;[] { null, Laser1, Laser2, Laser3 }[turn];&#xD;&#xA;                        var srcPos = GetCurrentRelPos(args[&quot;source&quot;]);&#xD;&#xA;                        var hourglass = HourGlassesByDir8[(int)Round(Atan2(srcPos.X, srcPos.Y) / PI * 4 + 4) % 8];&#xD;&#xA;                        targets.ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;&#xD;&#xA;                        error = $&quot;【{ability}】 {new string[] { null, &quot;短&quot;, &quot;中&quot;, &quot;长&quot; }[turn]} #{subturn} 》 {targetCount} 人&quot;;&#xD;&#xA;&#xD;&#xA;                        bool isDirCorrect = (hourglass.Baitθ * (hourglass.Is顺 ? 1 : -1)) &gt;= 60 / 180 * PI &amp;&amp; (hourglass.Baitθ * (hourglass.Is顺 ? 1 : -1)) &lt;= 90 / 180 * PI;&#xD;&#xA;                        if (hourglass.BaitDirectionErrorDesc != null)&#xD;&#xA;                            error += $&quot;引导{hourglass.BaitDirectionErrorDesc}&quot;;&#xD;&#xA;                        if (targetCount == 1 &amp;&amp; target == hourglass.BaitPlayer &amp;&amp; hourglass.BaitDistance &lt;= 4.3)&#xD;&#xA;                            error += $&quot;\n　》 {target.Role}（{target.Job}）引导后没躲开&quot;;&#xD;&#xA;                        else if (targetCount &lt;= 2)&#xD;&#xA;                            error += $&quot;\n　》 {string.Join(&quot;\n　》 &quot;, targets.Select(p =&gt; p.TempDesc))}&quot;;&#xD;&#xA;                        else&#xD;&#xA;                            error += $&quot;\n　》 {string.Join(&quot;　&quot;, targets.Select(p =&gt; p.Role))}&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                case AbilityEnum.黑暗冰封:&#xD;&#xA;                    {&#xD;&#xA;                        var centerPlayerIds = Stack2;&#xD;&#xA;                        var ice = PlayersByDebuff[Debuff.冰D] ?? PlayersByDebuff[Debuff.冰TH];&#xD;&#xA;                        ice.UpdatePos();&#xD;&#xA;                        targets.ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;&#xD;&#xA;                        error = $&quot;【{ability}】》 {targetCount} 人&quot;;&#xD;&#xA;                        error += $&quot;\n点名 {ice.TempDesc}&quot;;&#xD;&#xA;&#xD;&#xA;                        error += targets.Count &gt;= 3&#xD;&#xA;                            ? $&quot;\n　》 {string.Join(&quot;　&quot;, targets.Select(p =&gt; p.Role))}&quot;&#xD;&#xA;                            : $&quot;\n　》 {string.Join(&quot;\n　》 &quot;, targets.Select(p =&gt; p.TempDesc))}&quot;;&#xD;&#xA;&#xD;&#xA;                        var targetsShouldClose = targets.Where(p =&gt; p.TempR &gt;= 2 &amp;&amp; centerPlayerIds.Contains(p.HexID));&#xD;&#xA;                        var targetsShouldFar = targets.Where(p =&gt; p.TempR &lt;= 12 &amp;&amp; !centerPlayerIds.Contains(p.HexID));&#xD;&#xA;                        error += $&quot;\n参考原因：&quot;;&#xD;&#xA;                        if (ice.TempR &gt;= 3)&#xD;&#xA;                            error += $&quot;\n　　 {ice.Role} 月环点名站位过远&quot;;&#xD;&#xA;                        if (targetsShouldClose.Count() &gt; 0)&#xD;&#xA;                            error += $&quot;\n　　 {string.Join(&quot;　&quot;, targetsShouldClose.Select(p =&gt; p.Role))} 分摊站位过远&quot;;&#xD;&#xA;                        if (targetsShouldFar.Count() &gt; 0)&#xD;&#xA;                            error += $&quot;\n　　 {string.Join(&quot;　&quot;, targetsShouldFar.Select(p =&gt; p.Role))} 分散站位过近&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                case AbilityEnum.黑暗神圣:&#xD;&#xA;                case AbilityEnum.黑暗狂水:&#xD;&#xA;                    {&#xD;&#xA;                        var turn = ability == AbilityEnum.黑暗狂水 ? 4 : AbilityCount[ability];&#xD;&#xA;                        var correctTargets = new HashSet&lt;string&gt;[] { null, Stack1, Stack2, Stack3, Stack4 }[turn];&#xD;&#xA;                        var extraPlayers = targets.Where(p =&gt; !correctTargets.Contains(p.HexID)).ToList();&#xD;&#xA;                        var absentPlayers = correctTargets.Select(id =&gt; PlayersById[id]).Where(p =&gt; !targets.Contains(p)).ToList();&#xD;&#xA;                        if (Debug) Command($&quot;/e [Stack]\nturn: {turn}\nextra: {string.Join(&quot; &quot;, extraPlayers.Select(p =&gt; p.HexID))}\nabsent: {string.Join(&quot; &quot;, absentPlayers.Select(p =&gt; p.HexID))}&quot;);&#xD;&#xA;                        if (extraPlayers.Count == 0 &amp;&amp; absentPlayers.Count == 0 || extraPlayers.Count == 0 &amp;&amp; absentPlayers.Count == 1 &amp;&amp; correctTargets.Count == 6) return;&#xD;&#xA;&#xD;&#xA;                        targets.Concat(absentPlayers).ToList().ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;                        error = $&quot;【{ability}】》 {targetCount} 人 （应有 {correctTargets.Count} 人）&quot;;&#xD;&#xA;                        error += $&quot;\n点名 {target.TempDesc}&quot;;&#xD;&#xA;                        if (extraPlayers.Count &gt; 0)&#xD;&#xA;                            error += $&quot;\n多余：\n　》 {string.Join(&quot;\n　》 &quot;, extraPlayers.Select(p =&gt; p.TempDesc))}&quot;;&#xD;&#xA;                        if (absentPlayers.Count &gt; 0)&#xD;&#xA;                            error += $&quot;\n缺少：&quot; + (absentPlayers.Count &gt;= 3&#xD;&#xA;                                ? $&quot;\n　－ {string.Join(&quot;　&quot;, absentPlayers.Select(p =&gt; p.Role))}&quot;&#xD;&#xA;                                : $&quot;\n　－ {string.Join(&quot;\n　－ &quot;, absentPlayers.Select(p =&gt; p.TempDesc))}&quot;);&#xD;&#xA;&#xD;&#xA;                        var extraPlayersClose = extraPlayers.Where(p =&gt; p.TempR &lt;= 8);&#xD;&#xA;                        var absentPlayersFar = absentPlayers.Where(p =&gt; p.TempR &gt;= 3);&#xD;&#xA;                        error += $&quot;\n参考原因：&quot;;&#xD;&#xA;                        if (target.TempR &gt;= 3)&#xD;&#xA;                            error += $&quot;\n　　 {target.Role} 分摊点名站位过远&quot;;&#xD;&#xA;                        if (extraPlayersClose.Count() &gt; 0)&#xD;&#xA;                            error += $&quot;\n　　 {string.Join(&quot;　&quot;, extraPlayersClose.Select(p =&gt; p.Role))} 分散站位过近&quot;;&#xD;&#xA;                        if (absentPlayersFar.Count() &gt; 0)&#xD;&#xA;                            error += $&quot;\n　　 {string.Join(&quot;　&quot;, absentPlayersFar.Select(p =&gt; p.Role))} 分摊站位过远&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                case AbilityEnum.黑暗爆炎:&#xD;&#xA;                    {&#xD;&#xA;                        var turn = PlayersByDebuff[Debuff.冰TH] == null&#xD;&#xA;                            ? new int[] { 0, 1, 1, 1, 2, 2, 3, 3 }[AbilityCount[ability]]&#xD;&#xA;                            : new int[] { 0, 1, 1, 2, 2, 3, 3, 3 }[AbilityCount[ability]];&#xD;&#xA;                        var wrongTargets = new HashSet&lt;string&gt;[] { null, Stack1, Stack2, Stack3 }[turn];&#xD;&#xA;                        if (targetCount == 1) return;&#xD;&#xA;&#xD;&#xA;                        targets.ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;                        string reason;&#xD;&#xA;                        if (wrongTargets.Contains(target.HexID)) // 第一目标没有点名&#xD;&#xA;                            reason = &quot;乱点名&quot;;&#xD;&#xA;                        else if (target.TempR &lt; 12) // 点名者太近&#xD;&#xA;                            reason = target.TempR &gt; 6 ? $&quot;{target.Role} 出慢了&quot; : $&quot;{target.Role} 未出人群&quot;;&#xD;&#xA;                        else&#xD;&#xA;                        {&#xD;&#xA;                            var furthestPerson = others.OrderByDescending(p =&gt; p.TempR).FirstOrDefault();&#xD;&#xA;                            if (Abs(target.TempRelθ) &lt; PI / 10) // 点名者站位没错&#xD;&#xA;                                reason = furthestPerson.TempR &gt; 9.5 ? $&quot;{furthestPerson.Role}方向错误&quot; : furthestPerson.TempR &gt; 3 ? $&quot;{furthestPerson.Role}未贴近中心&quot; : &quot;情况复杂，无法判断&quot;;&#xD;&#xA;                            else if (furthestPerson.TempR &gt; 9.5)&#xD;&#xA;                                reason = $&quot;{target.Role}方向错误，误伤 {furthestPerson.Role}&quot;;&#xD;&#xA;                            else&#xD;&#xA;                                reason = $&quot;{target.Role}方向错误、{furthestPerson.Role}站位错误&quot;;&#xD;&#xA;                        }&#xD;&#xA;                        error = $&quot;【{ability}】》 {targetCount} 人&quot;;&#xD;&#xA;                        error += $&quot;\n点名 {target.TempDesc}&quot;;&#xD;&#xA;                        error += targetCount &gt;= 4&#xD;&#xA;                            ? $&quot;\n　》 {string.Join(&quot;　&quot;, others.Select(p =&gt; p.Role))}&quot;&#xD;&#xA;                            : $&quot;\n　》 {string.Join(&quot;\n　》 &quot;, others.Select(p =&gt; p.TempDesc))}&quot;;&#xD;&#xA;                        error += $&quot;\n参考原因：\n　　 {reason}&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                case AbilityEnum.暗炎喷发:&#xD;&#xA;                    {&#xD;&#xA;                        var wrongTargets = Stack4;&#xD;&#xA;                        if (targetCount == 1) return;&#xD;&#xA;&#xD;&#xA;                        targets.ForEach(p =&gt; p.UpdatePos());&#xD;&#xA;                        string reason;&#xD;&#xA;                        if (wrongTargets.Contains(target.HexID)) // 第一目标没有点名&#xD;&#xA;                            reason = &quot;乱点名&quot;;&#xD;&#xA;                        else if (target.TempR &lt; 8) // 点名者太近&#xD;&#xA;                            reason = target.TempR &gt; 6 ? $&quot;{target.Role} 记录分散位置过近&quot; : $&quot;{target.Role} 未出人群记录分散&quot;;&#xD;&#xA;                        else&#xD;&#xA;                        {&#xD;&#xA;                            var furthestPerson = others.OrderByDescending(p =&gt; p.TempR).FirstOrDefault();&#xD;&#xA;                            if (Abs(target.TempRelθ) &lt; PI / 10) // 点名者站位没错&#xD;&#xA;                                reason = furthestPerson.TempR &gt; 8 ? $&quot;{furthestPerson.Role}方向错误&quot; : furthestPerson.TempR &gt; 3 ? $&quot;{furthestPerson.Role}未贴近中心&quot; : &quot;情况复杂，无法判断&quot;;&#xD;&#xA;                            else if (furthestPerson.TempR &gt; 8)&#xD;&#xA;                                reason = $&quot;{target.Role}方向错误，误伤 {furthestPerson.Role}&quot;;&#xD;&#xA;                            else&#xD;&#xA;                                reason = $&quot;{target.Role}方向错误、{furthestPerson.Role}站位错误&quot;;&#xD;&#xA;                        }&#xD;&#xA;                        error = $&quot;【{ability}】》 {targetCount} 人&quot;;&#xD;&#xA;                        error += $&quot;\n点名 {target.TempDesc}&quot;;&#xD;&#xA;                        if (targetCount &gt;= 4)&#xD;&#xA;                            error += $&quot;\n　》 {string.Join(&quot;　&quot;, others.Select(p =&gt; p.Role))}&quot;;&#xD;&#xA;                        else&#xD;&#xA;                            error += $&quot;\n　》 {string.Join(&quot;\n　》 &quot;, others.Select(p =&gt; p.TempDesc))}&quot;;&#xD;&#xA;                        error += $&quot;\n参考原因：\n　　 {reason}&quot;;&#xD;&#xA;                    }&#xD;&#xA;                    break;&#xD;&#xA;                default:&#xD;&#xA;                    throw new Exception(&quot;未处理的技能&quot;);&#xD;&#xA;            }&#xD;&#xA;            RecordError(ability, error);&#xD;&#xA;        }&#xD;&#xA;        catch (Exception e)&#xD;&#xA;        {&#xD;&#xA;            throw new Exception($&quot;处理技能 {ability} #{AbilityCount[ability]} 时错误：\n{string.Join(&quot; | &quot;, args.Select(kv =&gt; kv.Key + &quot; = &quot; + kv.Value))}\n{e}&quot;);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    void ParseReturn(Dictionary&lt;string, string&gt; args)&#xD;&#xA;    {&#xD;&#xA;        Player target = PlayersById[args[&quot;target&quot;]];&#xD;&#xA;        target.UpdatePos();&#xD;&#xA;        string errorType = null;&#xD;&#xA;        if (Stack4.Contains(target.HexID))&#xD;&#xA;        {&#xD;&#xA;            if (target.TempR &gt; 2)&#xD;&#xA;                errorType = &quot;分摊组站位过远&quot;;&#xD;&#xA;            else if (Abs(target.TempRelθ) &gt; PI / 8)&#xD;&#xA;                errorType = &quot;方向错误&quot;;&#xD;&#xA;        }&#xD;&#xA;        else&#xD;&#xA;        {&#xD;&#xA;            if (target.TempR &lt; 8)&#xD;&#xA;                errorType = target.TempR &gt; 6 ? &quot;分散组站位过近&quot; : &quot;分散组没出人群&quot;;&#xD;&#xA;            else if (Abs(target.TempRelθ) &gt; PI / 10)&#xD;&#xA;                errorType = &quot;方向错误&quot;;&#xD;&#xA;        }&#xD;&#xA;        if (errorType != null)&#xD;&#xA;            RecordError(AbilityEnum.记录回返, $&quot;【记录回返】：{errorType}\n　》 {target.TempDesc}&quot;);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    void ParseRotate(Dictionary&lt;string, string&gt; args)&#xD;&#xA;    {&#xD;&#xA;        HourGlass hourglass = HourGlassesById[args[&quot;id&quot;]];&#xD;&#xA;        bool isCW = MathParser.Parse(args[&quot;cw&quot;]) != 0;&#xD;&#xA;        hourglass._is顺 = isCW;&#xD;&#xA;        return;&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    List&lt;string&gt; Errors = new List&lt;string&gt;();&#xD;&#xA;    Dictionary&lt;AbilityEnum, int&gt; ErrorCounts = Enum.GetValues(typeof(AbilityEnum)).Cast&lt;AbilityEnum&gt;().ToDictionary(a =&gt; a, a =&gt; 0);&#xD;&#xA;    void RecordError(AbilityEnum ability, string data)&#xD;&#xA;    {&#xD;&#xA;        ErrorCounts[ability]++;&#xD;&#xA;        Errors.Add(data);&#xD;&#xA;        if (ErrorCounts[ability] &lt;= 3 &amp;&amp; Errors.Count &lt;= 5)&#xD;&#xA;        {&#xD;&#xA;            Command(&quot;/e \n&quot; + data);&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static void Command(string data)&#xD;&#xA;    {&#xD;&#xA;        var chars = data.Select(ch =&gt; SimpToTrad.TryGetValue(ch.ToString(), out var t) ? t : ch.ToString());&#xD;&#xA;        RealPlugin.plug.InvokeNamedCallback(&quot;command&quot;, string.Concat(chars));&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static Dictionary&lt;string, string&gt; SimpToTrad = new Dictionary&lt;string, string&gt;&#xD;&#xA;    {&#xD;&#xA;        {&quot;圣&quot;, &quot;聖&quot;}, {&quot;转&quot;, &quot;轉&quot;}, {&quot;喷&quot;, &quot;噴&quot;}, {&quot;发&quot;, &quot;發&quot;}, {&quot;长&quot;, &quot;長&quot;}, {&quot;标&quot;, &quot;標&quot;},&#xD;&#xA;        {&quot;运&quot;, &quot;運&quot;}, {&quot;队&quot;, &quot;隊&quot;}, {&quot;环&quot;, &quot;環&quot;}, {&quot;过&quot;, &quot;過&quot;}, {&quot;远&quot;, &quot;遠&quot;}, {&quot;摊&quot;, &quot;攤&quot;},&#xD;&#xA;        {&quot;应&quot;, &quot;應&quot;}, {&quot;错&quot;, &quot;錯&quot;}, {&quot;误&quot;, &quot;誤&quot;}, {&quot;贴&quot;, &quot;貼&quot;}, {&quot;复&quot;, &quot;複&quot;}, {&quot;杂&quot;, &quot;雜&quot;},&#xD;&#xA;        {&quot;伤&quot;, &quot;傷&quot;}, {&quot;记&quot;, &quot;記&quot;}, {&quot;录&quot;, &quot;録&quot;}, {&quot;顺&quot;, &quot;順&quot;}, {&quot;调&quot;, &quot;調&quot;}, {&quot;试&quot;, &quot;試&quot;},&#xD;&#xA;        {&quot;黑&quot;, &quot;黒&quot;},&#xD;&#xA;    };&#xD;&#xA;&#xD;&#xA;    static string[] Dir8Desc = new string[] { &quot;上北&quot;, &quot;左上&quot;, &quot;左西&quot;, &quot;左下&quot;, &quot;下南&quot;, &quot;右下&quot;, &quot;右东&quot;, &quot;右上&quot; };&#xD;&#xA;&#xD;&#xA;    class Player&#xD;&#xA;    {&#xD;&#xA;        public string HexID;&#xD;&#xA;        public string Name;&#xD;&#xA;        public string Job;&#xD;&#xA;        public int Dir8;&#xD;&#xA;        public Debuff Debuff;&#xD;&#xA;        public HourGlass HourGlass;&#xD;&#xA;        public RoleEnum Role;&#xD;&#xA;        public Vector2 TempRelPos;&#xD;&#xA;        public double TempR, TempRelθ;&#xD;&#xA;        public string TempDesc;&#xD;&#xA;        public void UpdatePos()&#xD;&#xA;        {&#xD;&#xA;            //ＭＴ（战士）长高Ｔ　@ 6.5 m, 偏 +10°&#xD;&#xA;            TempRelPos = GetCurrentRelPos(HexID);&#xD;&#xA;            var rotatedPolarCoord = new PolarCoord(TempRelPos).RotateTo(Dir8);&#xD;&#xA;            TempR = rotatedPolarCoord.R;&#xD;&#xA;            TempRelθ = rotatedPolarCoord.θ;&#xD;&#xA;            TempDesc = $&quot;{Role}（{Job}）{Desc(Debuff, Role)} {rotatedPolarCoord}&quot;;&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    class HourGlass&#xD;&#xA;    {&#xD;&#xA;        public string HexID;&#xD;&#xA;        public int Dir8;&#xD;&#xA;        public SpeedEnum Speed;&#xD;&#xA;        public Player Player;&#xD;&#xA;        public bool? _is顺;&#xD;&#xA;        public Player BaitPlayer;&#xD;&#xA;        public double BaitDistance;&#xD;&#xA;        public double Baitθ;&#xD;&#xA;        public string BaitDirectionErrorDesc;&#xD;&#xA;        public bool Is顺&#xD;&#xA;        {&#xD;&#xA;            get&#xD;&#xA;            {&#xD;&#xA;                if (_is顺 == null)&#xD;&#xA;                {&#xD;&#xA;                    string err = $&quot;程序错误：沙漏 {HexID} (Dir8 = {Dir8}) 未记录旋转方向。&quot;;&#xD;&#xA;                    if (Debug)&#xD;&#xA;                    {&#xD;&#xA;                        Log(RealPlugin.DebugLevelEnum.Error, $&quot;调试：&quot; + err + &quot;使用默认值（顺时针）。&quot;);&#xD;&#xA;                        _is顺 = true;&#xD;&#xA;                    }&#xD;&#xA;                    else throw new Exception(err);&#xD;&#xA;                }&#xD;&#xA;                return _is顺.Value;&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;        public Vector2 RelPos&#xD;&#xA;        {&#xD;&#xA;            get&#xD;&#xA;            {&#xD;&#xA;                var θ = (Dir8 - 4) * PI / 4;&#xD;&#xA;                return 9.5f * new Vector2((float)Sin(θ), (float)Cos(θ));&#xD;&#xA;            }&#xD;&#xA;        }&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    static Random rnd = new Random();&#xD;&#xA;    static Vector2 GetCurrentRelPos(string hexId)&#xD;&#xA;    {&#xD;&#xA;        var player = GetIdEntity(hexId);&#xD;&#xA;        if (Debug &amp;&amp; player.GetValue(&quot;name&quot;).ToString() == &quot;&quot;)&#xD;&#xA;        {&#xD;&#xA;            var v = new Vector2(rnd.Next(300) / 10.0f - 15, rnd.Next(300) / 10.0f - 15);&#xD;&#xA;            Log(RealPlugin.DebugLevelEnum.Warning, $&quot;调试模式，生成随机坐标：{hexId} @ {v}&quot;);&#xD;&#xA;            return v;&#xD;&#xA;        }&#xD;&#xA;        var x = float.Parse(player.GetValue(&quot;x&quot;).ToString());&#xD;&#xA;        var y = float.Parse(player.GetValue(&quot;y&quot;).ToString());&#xD;&#xA;        return new Vector2(x - 100, y - 100);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    public enum Debuff&#xD;&#xA;    {&#xD;&#xA;        短TH = 0, 冰TH = 1, 中TH = 2, 长高TH = 3, 长低TH = 4,&#xD;&#xA;        短高D = 5, 短低D = 6, 中D = 7, 长D = 8, 冰D = 9,&#xD;&#xA;        短或冰TH, 长或冰D,&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    public static string Desc(Debuff debuff, RoleEnum role)&#xD;&#xA;    {&#xD;&#xA;        var debuffDesc = debuff.ToString().TrimEnd('T', 'H', 'D');&#xD;&#xA;        var roleDesc = new string[] { &quot;Ｔ&quot;, &quot;Ｈ&quot;, &quot;Ｄ&quot;, &quot;Ｄ&quot; }[(int)role / 2];&#xD;&#xA;        return (debuffDesc + roleDesc).PadRight(3, '　');&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;    static Dictionary&lt;Debuff, int&gt; DebuffToRelDir8 = new Dictionary&lt;Debuff, int&gt;&#xD;&#xA;    {&#xD;&#xA;        { Debuff.短TH, 4 }, { Debuff.冰TH, 4 },&#xD;&#xA;        { Debuff.中TH, 2 },&#xD;&#xA;        { Debuff.长高TH, 3 }, { Debuff.长低TH, 5 },&#xD;&#xA;        { Debuff.短高D, 1 }, { Debuff.短低D, 7 },&#xD;&#xA;        { Debuff.中D, 6 },&#xD;&#xA;        { Debuff.长D, 0 }, { Debuff.冰D, 0 },&#xD;&#xA;    };&#xD;&#xA;&#xD;&#xA;    public enum RoleEnum { ＭＴ = 0, ＳＴ = 1, Ｈ１ = 2, Ｈ２ = 3, Ｄ１ = 4, Ｄ２ = 5, Ｄ３ = 6, Ｄ４ = 7 }&#xD;&#xA;&#xD;&#xA;    public enum SpeedEnum { 短, 中, 长 }&#xD;&#xA;    static Dictionary&lt;int, SpeedEnum&gt; RelDir8ToSpeed = new Dictionary&lt;int, SpeedEnum&gt;&#xD;&#xA;    {&#xD;&#xA;        { 0, SpeedEnum.短 }, { 1, SpeedEnum.中 }, { 2, SpeedEnum.长 }, { 3, SpeedEnum.短 },&#xD;&#xA;        { 4, SpeedEnum.中 }, { 5, SpeedEnum.短 }, { 6, SpeedEnum.长 }, { 7, SpeedEnum.中 },&#xD;&#xA;    };&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;public class PolarCoord&#xD;&#xA;{&#xD;&#xA;    public double R;&#xD;&#xA;    public double θ;&#xD;&#xA;    public PolarCoord(double R, double θ)&#xD;&#xA;    {&#xD;&#xA;        this.R = R;&#xD;&#xA;        this.θ = θ;&#xD;&#xA;    }&#xD;&#xA;    public PolarCoord(Vector2 vec)&#xD;&#xA;    {&#xD;&#xA;        R = Sqrt(vec.X * vec.X + vec.Y * vec.Y);&#xD;&#xA;        θ = Atan2(vec.X, vec.Y);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    public PolarCoord RotateTo(int dir8)&#xD;&#xA;    {&#xD;&#xA;        var newθ = θ - dir8 * PI / 4;&#xD;&#xA;        return new PolarCoord(R, newθ);&#xD;&#xA;    }&#xD;&#xA;&#xD;&#xA;    public override string ToString()&#xD;&#xA;    {&#xD;&#xA;        var degree = θ / PI * 180;&#xD;&#xA;        degree = (degree % 360 + 360) % 360;&#xD;&#xA;        if (degree &gt;= 180) degree -= 360;&#xD;&#xA;        return $&quot;距中心 {R:0.0} m, 偏{(degree &gt;= 0 ? &quot;逆&quot; : &quot;顺&quot;)} {Abs(degree):0}°&quot;;&#xD;&#xA;    }&#xD;&#xA;}" ActionType="ExecuteScript" Asynchronous="False" Description="U7a3_一运_Analyzer      P3 一运警察" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ecallback:U7a3_一运_Analyzer}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Init" Enabled="False" ActionType="NamedCallback" />
<Action OrderNumber="4" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Parse&#xD;&#xA;Ability = 9D55&#xD;&#xA;Source = 4000439A&#xD;&#xA;Target = 109012A8&#xD;&#xA;Others = 106D8992,106C2E8F,1078AB54&#xD;&#xA;Count = 4" Enabled="False" ActionType="NamedCallback" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="a935a343-83a5-495d-938f-95689daba040" Name="P2" Enabled="true">
<Folders>
<Folder Id="45b35f52-10bd-4591-9ebe-2e6061472326" Name="A. 钻石星尘" Enabled="true" RawEnvironmentVariables="phase = P2DD">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="1.1 获取初始冰圈 =&gt; 2" Id="16a853ad-fff9-4aaa-94c6-6b89ebc3db80" RegularExpression="^.{15}\S+ 107:4.{7}:9D06:(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="1000">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="U7a2_DD_dir8" VariableExpression="roundvec(${x} - 100, ${y} - 100, 8) % 4" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="U7a2_DD:dir8:${v:U7a2_DD_dir8}:is钢:${v:U7a2_DD_is钢}:id:${l:U7a2_DD_点名id.join(:)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_DD_dir8}${ev:U7a2_DD_is钢}${l:U7a2_DD_点名id.size}" ExpressionTypeL="String" ExpressionR="114" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_DD_dir8}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="1.2 获取钢铁月环 =&gt; 2" Id="171562d8-f32c-4a90-a71b-6f97e7b8f64d" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D0(?&lt;type&gt;[AB]):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a2_DD_is钢" VariableExpression="${type} == A" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="U7a2_DD:dir8:${v:U7a2_DD_dir8}:is钢:${v:U7a2_DD_is钢}:id:${l:U7a2_DD_点名id.join(:)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_DD_dir8}${ev:U7a2_DD_is钢}${l:U7a2_DD_点名id.size}" ExpressionTypeL="String" ExpressionR="114" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="1.3 获取点名 * 4 =&gt; 2" Id="e7611e6a-120f-40d8-bd7e-3b22f752fdbb" RegularExpression="^.{15}\S+ 1B:(?&lt;id&gt;1.{7}):[^:]*:[^:]*:[^:]*:0159">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableName="U7a2_DD_点名id" ListVariableExpression="${id}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="U7a2_DD:dir8:${v:U7a2_DD_dir8}:is钢:${v:U7a2_DD_is钢}:id:${l:U7a2_DD_点名id.join(:)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_DD_dir8}${ev:U7a2_DD_is钢}${l:U7a2_DD_点名id.size}" ExpressionTypeL="String" ExpressionR="114" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 播报" Id="47530b31-11cb-4c6d-9559-0f6216749ec8" RegularExpression="^U7a2_DD:dir8:(?&lt;dir8&gt;[0123]):is钢:(?&lt;is钢&gt;[01]):id:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a2_DD_is点名自己" VariableExpression="${l:U7a2_DD_点名id.contain(${_me.id})}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a2_DD_is自己正点" VariableExpression="(0${dir8} % 2 = 1) = 0${v:U7a2_DD_is点名自己}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="clear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="4" UseTTSTextExpression="钢铁，去${if: ${v:U7a2_DD_is自己正点} ? 正点 : 斜点 }，贴边放点名" UseTTSExclusive="False" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="11" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" UseTTSTextExpression="钢铁，去${if: ${v:U7a2_DD_is自己正点} ? 正点 : 斜点 }，贴近黑线引导扇形" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="10" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;Waymarks: ${if: ${v:U7a2_DD_is自己正点} ? A_D_C_B_ : _1_4_3_2 }&#xD;&#xA;R:  0${v:U7a2_DD_is点名自己} ? 19 : 17.25" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" UseTTSTextExpression="月环，先去脚下${if: ${v:U7a2_DD_is自己正点} ? 正点 : 斜点 }，然后出去放冰花" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="01" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" UseTTSTextExpression="月环，${if: ${v:U7a2_DD_is自己正点} ? 正点 : 斜点 }靠近引导扇形" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="00" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;Waymarks: ${if: 0${v:U7a2_DD_is自己正点} ? A_D_C_B_ : _1_4_3_2 }&#xD;&#xA;R:  0${v:U7a2_DD_is点名自己} ? 2.75 : 1.77" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="10" LogMessageText="cd5:${if: ${v:U7a2_DD_is点名自己} ? 8.0 : 5.6 }" LogProcess="True" ActionType="LogMessage" />
<Action OrderNumber="11" ActionType="Placeholder" ExecutionDelayExpression="5400" Asynchronous="False" />
<Action OrderNumber="12" ActionType="Placeholder" Asynchronous="False" Description="钢铁月环判定" DescriptionOverride="True" />
<Action OrderNumber="13" UseTTSTextExpression="出去放冰花" UseTTSExclusive="False" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="01" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;Waymarks: ${if: ${v:U7a2_DD_is自己正点} ? A_D_C_B_ : _1_4_3_2 }&#xD;&#xA;R:  8" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="01" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="15" UseTTSTextExpression="回场中" UseTTSExclusive="False" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${is钢}${v:U7a2_DD_is点名自己}" ExpressionTypeL="String" ExpressionR="10" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="16" ActionType="Placeholder" ExecutionDelayExpression="2500" Asynchronous="False" />
<Action OrderNumber="17" ActionType="Placeholder" Asynchronous="False" Description="冰花点名判定" DescriptionOverride="True" />
<Action OrderNumber="18" UseTTSTextExpression="击退到${f:pick(${n: ${dir8} + (${v:myIdx_isG1} ? 0 : 4) }): 红色A, 红色壹, 紫色D, 紫色4, 蓝色C, 蓝色3, 黄色B, 黄色贰}点方向" UseTTSExclusive="False" ActionType="UseTTS" />
<Action OrderNumber="19" NamedCallbackName="AdvWm" NamedCallbackParam="clear&#xD;&#xA;---&#xD;&#xA;Action: Circle&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;Waymarks: ${f:pick(0${dir8}): A___C___, _1___3__, __D___B_, ___4___2 }&#xD;&#xA;R:  6&#xD;&#xA;---&#xD;&#xA;Action: Linear&#xD;&#xA;O: 100, 100, 0&#xD;&#xA;θ: dir2rad(0${dir8}, 8) + (${v:myIdx_isG1} ? 0 : π)&#xD;&#xA;Waymarks: ${f:pick(0${dir8}): 1234, ABCD, 1234, ABCD }&#xD;&#xA;Start: 0, -12&#xD;&#xA;End:   0, -18" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 前半" Id="3b9076ad-c269-4a66-8d3c-1101252615a5" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[04:18:58.116] StartsCasting 14:4002C3C9:Usurper of Frost:9CF4:Mirror Image:4002C3C9:Usurper of Frost:2.700:99.99:105.00:0.00:-0.52" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="2000" />
<Action OrderNumber="3" LogMessageText="[04:19:10.930] 263 107:4002C3A2:9D06:88.687:111.301:0.000:-3.142" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[04:19:10.930] 263 107:4002C3A3:9D06:111.301:88.687:0.000:-3.142" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" ActionType="Placeholder" ExecutionDelayExpression="0.27 * 1000" />
<Action OrderNumber="6" LogMessageText="[04:19:11.198] StartsCasting 14:4002C3C8:Oracle's Reflection:9D0A:Axe Kick:4002C3C8:Oracle's Reflection:5.700:99.99:99.99:0.00:0.52" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="7" ActionType="Placeholder" ExecutionDelayExpression="0.18 * 1000" />
<Action OrderNumber="8" LogMessageText="[04:19:11.377] TargetIcon 1B:10860D24:Maple Leaf:0000:0000:0159:10860D24:0000:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="9" LogMessageText="[04:19:11.377] TargetIcon 1B:107A182B:Chickenstew Delicious:0000:0000:0159:107A182B:0000:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="10" LogMessageText="[04:19:11.377] TargetIcon 1B:10844F86:Dyvinell Dark:0000:0000:0159:10844F86:0000:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="11" LogMessageText="[04:19:11.377] TargetIcon 1B:10934AAA:Deep Trouble:0000:0000:0159:10934AAA:0000:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="0. 开始 读条镜像" Id="6f2f81c4-374c-4467-9823-60eee95b2364" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9CF4:">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="准备AoE" ActionType="UseTTS" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="3" VariableOp="UnsetRegexUniversal" VariableName="^U7a2_DD" ActionType="Variable" />
<Action OrderNumber="4" UseTTSTextExpression="钻石星尘" ActionType="UseTTS" ExecutionDelayExpression="5000" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="b3b6310b-9472-43f1-b465-f3f9dd193f00" Name="C. 镜之国" Enabled="true" RawEnvironmentVariables="phase = P2镜子">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 开始" Id="a5683e81-619f-453c-a26a-b7696abb3e7b" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9CF3:">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="镜子" ActionType="UseTTS" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="3" VariableOp="UnsetRegexUniversal" VariableName="^U7a2_镜子" ActionType="Variable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 获取白镜子 （时间轴）" Id="990e136a-9204-4b4b-90d7-d45862076187" RegularExpression="^.{15}\S+ 101:.{8}:00020001:0(?&lt;pos&gt;[1-8])">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="6.1 读条月环 | 11.8 第一轮月环 | 21.8 第二轮月环" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a2_镜子_白dir8" VariableExpression="(9 - 0${pos}) % 8" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="cd5:12.0" LogProcess="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="cd5:22.0" LogProcess="True" ActionType="LogMessage" />
<Action OrderNumber="5" UseTTSTextExpression="去${f:pick(${v:U7a2_镜子_白dir8}): 上北, 左上, 左西, 左下, 下南, 右下, 右东, 右上}白镜子" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isTM}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_白dir8}, 8)&#xD;&#xA;1: 0, -1&#xD;&#xA;2: 0, -4&#xD;&#xA;3: 0, -7&#xD;&#xA;4: 0, -10&#xD;&#xA;---&#xD;&#xA;O: 100, 100 polar 20, dir2rad(${v:U7a2_镜子_白dir8}, 8)&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_白dir8}, 8)&#xD;&#xA;A: polar 2.75, -85°&#xD;&#xA;B: polar 2.75, -45°&#xD;&#xA;C: polar 2.75,  45°&#xD;&#xA;D: polar 2.75,  85°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isTM}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" UseTTSTextExpression="去${f:pick(${v:U7a2_镜子_白dir8}): 下南, 右下, 右东, 右上, 上北, 左上, 左西, 左下}" UseTTSExclusive="False" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isTM}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_白dir8}, 8)&#xD;&#xA;Waymarks: ABCD1234&#xD;&#xA;Start: 0, 0&#xD;&#xA;End: 0, 18.5" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isTM}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" ActionType="Placeholder" ExecutionDelayExpression="11800" Asynchronous="False" />
<Action OrderNumber="10" VariableOp="SetNumeric" VariableName="U7a2_镜子_红dir8" VariableExpression="${l:U7a2_镜子_红dir8[1]} + ((${l:U7a2_镜子_红dir8[2]} - ${l:U7a2_镜子_红dir8[1]}) %% 8 = 2 ? 1 : -1)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="11" UseTTSTextExpression="去红镜子" ActionType="UseTTS" />
<Action OrderNumber="12" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100 polar 20, dir2rad(${v:U7a2_镜子_红dir8} + 1, 8)&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_红dir8} + 1, 8)&#xD;&#xA;1: polar 2.75, -85°&#xD;&#xA;2: polar 2.75, -40°&#xD;&#xA;3: polar 2.75,   5°&#xD;&#xA;4: polar 2.75,  85°&#xD;&#xA;---&#xD;&#xA;O: 100, 100 polar 20, dir2rad(${v:U7a2_镜子_红dir8} - 1, 8)&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_红dir8} - 1, 8)&#xD;&#xA;A: polar 2.75, -85°&#xD;&#xA;B: polar 2.75,  -5°&#xD;&#xA;C: polar 2.75,  40°&#xD;&#xA;D: polar 2.75,  85°" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="13" UseTTSTextExpression="准备分散分摊" ActionType="UseTTS" ExecutionDelayExpression="7000" />
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;Waymarks: A1D4C3B2&#xD;&#xA;R: 6&#xD;&#xA;O: 100, 100" ActionType="NamedCallback" ExecutionDelayExpression="4500" DescBgColor="dff" />
<Action OrderNumber="15" UseTTSTextExpression="八方站位" ActionType="UseTTS" ExecutionDelayExpression="5000" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 记录红镜子 for 1" Id="bf082bfa-0d21-484d-b259-1777243b2b46" RegularExpression="^.{15}\S+ 101:.{8}:02000100:0(?&lt;pos&gt;[1-8])">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableExpressionType="Numeric" ListVariableName="U7a2_镜子_红dir8" ListVariableExpression="(9 - ${pos}) % 8" ActionType="ListVariable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 本体月环" Id="2e5a240f-c8e9-4468-a064-a5a6bfde0cbc" RegularExpression="^.{15}\S+ 107:4.{7}:9D0B:(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;1: fakeclear&#xD;&#xA;2: fakeclear&#xD;&#xA;3: fakeclear&#xD;&#xA;4: fakeclear&#xD;&#xA;---&#xD;&#xA;O: ${x}, ${y}&#xD;&#xA;θ: dir2rad(${v:U7a2_镜子_白dir8}, 8)&#xD;&#xA;A: polar 2.75, -90°&#xD;&#xA;B: polar 2.75, -30°&#xD;&#xA;C: polar 2.75,  30°&#xD;&#xA;D: polar 2.75,  90°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx_isTM}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" UseTTSTextExpression="分散站位" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="红镜子变白（防止特效遮挡）" Id="60f696df-22c3-4cd8-a39d-a3529fb95e22" RegularExpression="^.{15}\S+ 101:.{8}:02000100:(?&lt;pos&gt;0[1-8])">
<Actions>
<Action OrderNumber="1" NamedCallbackName="MapEffect" NamedCallbackParam="00020001:${pos}" ActionType="NamedCallback" ExecutionDelayExpression="13000" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="2165486a-0939-4847-a3b1-8b3314d55cbf" Name="D. 光之暴走" Enabled="true" RawEnvironmentVariables="phase = P2光暴">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="光圈/塔判定" Id="f4d3c946-1175-4286-b320-db38df41678b" RegularExpression="^.{15}\S+ 1[56]:4.{7}:[^:]*:9D1[A5]:[^:]*:(?&lt;tid&gt;1.{7})" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="500">
<Actions>
<Action OrderNumber="1" SystemBeepLengthExpression="200" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${tid}" ExpressionTypeL="String" ExpressionR="${_me.id}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="0. 开始" Id="149b2f05-202b-4849-a6bd-e9311b7ab43a" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D14:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a2_光暴" ActionType="Variable" />
<Action OrderNumber="3" NamedCallbackName="command" NamedCallbackParam="/${if: ${f:contain(ia So):${_me}} ? p : e } &#xD;&#xA;ＭＴ 　0》　　　　&#xD;&#xA;ＳＴ 　0》　1》　2》&#xD;&#xA;Ｈ１ 　1》　2》&#xD;&#xA;Ｈ２ 　0》　1》　2》&#xD;&#xA;Ｄ１ 　0》　1》　2》&#xD;&#xA;Ｄ２ 　0》　1》　2》&#xD;&#xA;Ｄ３ 　2》&#xD;&#xA;Ｄ４ 　0》　1》　　" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="3. 验证顺序 + 计算 =&gt; 4" Id="9974e140-a910-4d08-b180-027739a751c6" RegularExpression="^U7a2_光暴_环">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Description="反正不是决速步，滥用点临时字典 who cares （x" DescriptionOverride="True" />
<Action OrderNumber="2" ActionType="Placeholder" Description="将字典转换为正北顺时针排队的优先级" DescriptionOverride="True" />
<Action OrderNumber="3" DictVariableOp="Merge" DictVariableName="U7a2_光暴_环_pIdx" DictVariableTarget="U7a2_光暴_环_prio" ActionType="DictVariable" />
<Action OrderNumber="4" DictVariableOp="SetAll" DictVariableName="U7a2_光暴_环_prio" DictVariableKey="${?d: 1=1, 2=3, 3=7, 4=5, 5=6, 6=4, 7=8, 8=2 [${_key}]}" DictVariableValue="${?d: 1=1, 2=3, 3=7, 4=5, 5=6, 6=4, 7=8, 8=2 [${_val}]}" ActionType="DictVariable" />
<Action OrderNumber="5" ActionType="Placeholder" Description="从优先级最高的起始" DescriptionOverride="True" />
<Action OrderNumber="6" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio.minkey}" ActionType="ListVariable" />
<Action OrderNumber="7" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ActionType="ListVariable" />
<Action OrderNumber="8" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ActionType="ListVariable" />
<Action OrderNumber="9" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ActionType="ListVariable" />
<Action OrderNumber="10" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ActionType="ListVariable" />
<Action OrderNumber="11" ListVariableOp="Push" ListVariableName="U7a2_光暴_环_prio" ListVariableExpression="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ActionType="ListVariable" />
<Action OrderNumber="12" UseTTSTextExpression="成环错误：首尾不相连" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a2_光暴_环_prio[${l:U7a2_光暴_环_prio[-1]}]}" ExpressionTypeL="String" ExpressionR="${l:U7a2_光暴_环_prio[1]}" ExpressionTypeR="String" ConditionType="StringNotEqualCase" />
</Condition>
</Action>
<Action OrderNumber="13" ActionType="Placeholder" Description="检查是否是顺序的，否则倒转环" DescriptionOverride="True" />
<Action OrderNumber="14" ListVariableOp="Build" ListVariableExpression=":${l:U7a2_光暴_环_prio.join(:, &quot;1,6,5,4,3,2&quot;)}" ListVariableTarget="U7a2_光暴_环_prio" ActionType="ListVariable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="(${l:U7a2_光暴_环_prio[2]} - ${l:U7a2_光暴_环_prio[1]}) %% 8" ExpressionTypeL="Numeric" ExpressionR="3" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="15" ActionType="Placeholder" Description="转换回 partyIndex" DescriptionOverride="True" />
<Action OrderNumber="16" ListVariableOp="Copy" ListVariableName="U7a2_光暴_环_prio" ListVariableTarget="U7a2_光暴_环_pIdx" ActionType="ListVariable" />
<Action OrderNumber="17" ListVariableOp="SetAll" ListVariableName="U7a2_光暴_环_pIdx" ListVariableExpression="${?d: 1=1, 3=2, 7=3, 5=4, 6=5, 4=6, 8=7, 2=8 [${_this}]}" ActionType="ListVariable" />
<Action OrderNumber="18" ListVariableOp="Copy" ListVariableName="U7a2_光暴_环_pIdx" ListVariableTarget="U7a2_光暴_环_role" ActionType="ListVariable" />
<Action OrderNumber="19" ListVariableOp="SetAll" ListVariableName="U7a2_光暴_环_role" ListVariableExpression="${?d: 1=ＭＴ, 2=ＳＴ, 3=Ｈ１, 4=Ｈ２, 5=Ｄ１, 6=Ｄ２, 7=Ｄ３, 8=Ｄ４ [${_this}]}" ActionType="ListVariable" />
<Action OrderNumber="20" ActionType="Placeholder" Description="无点名" DescriptionOverride="True" />
<Action OrderNumber="21" ListVariableOp="Build" ListVariableExpression=",1,2,3,4,5,6,7,8" ListVariableTarget="U7a2_光暴_无_pIdx" ActionType="ListVariable" />
<Action OrderNumber="22" ListVariableOp="Filter" ListVariableExpressionType="Numeric" ListVariableName="U7a2_光暴_无_pIdx" ListVariableExpression="!${l:U7a2_光暴_环_pIdx.contain(${_this})}" ListVariableTarget="U7a2_光暴_无_pIdx" ActionType="ListVariable" />
<Action OrderNumber="23" ActionType="Placeholder" Description="输出" DescriptionOverride="True" />
<Action OrderNumber="24" LogMessageText="U7a2_光暴_输出:${l:U7a2_光暴_环_pIdx.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 获取连线 =&gt; 3" Id="c450194f-588c-4fc5-ab37-5a97809cc84e" RegularExpression="^.{15}\S+ 23:(?&lt;sid&gt;1.{7}):[^:]*:(?&lt;tid&gt;1.{7}):[^:]*:[^:]*:[^:]*:006E">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" DictVariableOp="Set" DictVariableName="U7a2_光暴_环_pIdx" DictVariableKey="${l:party.indexof(${sid})}" DictVariableValue="${l:party.indexof(${tid})}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="U7a2_光暴_环:${d:U7a2_光暴_环_pIdx.joinall}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a2_光暴_环_pIdx.size}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="4.2 有连线" Id="de018418-3a22-421b-ae6e-9ccd9f26fddf" RegularExpression="^U7a2_光暴_输出:(?&lt;index&gt;\d{6})">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a2_光暴_myDir6" VariableExpression="${?d: 1 = 3, 2 = 1, 3 = 5, 4 = 2, 5 = 4, 6 = 0 [${l:U7a2_光暴_环_pIdx.indexof(${v:myIdx})}]}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" UseTTSTextExpression="${f:pick(${v:U7a2_光暴_myDir6}): 上北, 左上, 左下, 下南, 右下, 右上}踩塔" ActionType="UseTTS" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;θ: dir2rad(${v:U7a2_光暴_myDir6}, 6)&#xD;&#xA;O: 100, 100&#xD;&#xA;Start: 0, 0&#xD;&#xA;End: 0, -18.75&#xD;&#xA;Waymarks: 4321DCBA&#xD;&#xA;" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="4" ActionType="Placeholder" ExecutionDelayExpression="10300" />
<Action OrderNumber="5" UseTTSTextExpression="${f:pick(${v:U7a2_光暴_myDir6}): 左西, 左西, 左西, 右东, 右东, 右东}集合" ActionType="UseTTS" />
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;θ: ${v:U7a2_光暴_myDir6} &gt;= 3 ? π/2 : -π/2&#xD;&#xA;O: 100, 100&#xD;&#xA;Start: 0, 0&#xD;&#xA;End: 0, -18.75&#xD;&#xA;Waymarks: 4321DCBA&#xD;&#xA;" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="U7a2_光暴_环_pIdx" ExpressionTypeL="String" ExpressionR="${v:myIdx}" ExpressionTypeR="String" ConditionType="ListContains" />
</Condition>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="4.1 无连线" Id="b526b818-da7d-4f37-a229-4142c33e83c2" RegularExpression="^U7a2_光暴_输出:(?&lt;index&gt;\d{6})">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="两侧放大圈" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="U7a2_光暴_无_pIdx" ExpressionTypeL="String" ExpressionR="${v:myIdx}" ExpressionTypeR="String" ConditionType="ListContains" />
</Condition>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="4.3 文字播报" Id="999c496e-a294-45f0-bbb8-df1770fad9cb" RegularExpression="^U7a2_光暴_输出:(?&lt;index&gt;\d{6})">
<Actions>
<Action OrderNumber="1" ListVariableOp="SetAll" ListVariableName="U7a2_光暴_点名描述" ListVariableExpression="${?d: 0 = 无, 1 = &quot;&quot;, 2 = &quot;&quot;, 3 = &quot;&quot;, 4 = &quot;&quot;, 5 = &quot;&quot;, 6 = &quot;&quot; [${l:U7a2_光暴_环_pIdx.indexof(${_idx})}]}" ListVariableIndex="8" ActionType="ListVariable" />
<Action OrderNumber="2" NamedCallbackName="command" NamedCallbackParam="/e [Debug] 有問題的話截图&#xD;&#xA;prio: ${l:U7a2_光暴_环_prio.join(&quot;&quot;)}&#xD;&#xA;pIdx: ${l:U7a2_光暴_环_pIdx.join(&quot;&quot;)}&#xD;&#xA;role: ${l:U7a2_光暴_环_role.join(&quot;&quot;)}" ActionType="NamedCallback" DescBgColor="fdd" />
<Action OrderNumber="3" NamedCallbackName="command" NamedCallbackParam="/e &#xD;&#xA;ＭＴ 》 ${l:U7a2_光暴_点名描述[1]}  ｜ 　　　  　${l:U7a2_光暴_环_role[6]}&#xD;&#xA;ＳＴ 》 ${l:U7a2_光暴_点名描述[2]}  ｜ 　　　　　&#xD;&#xA;Ｈ１ 》 ${l:U7a2_光暴_点名描述[3]}  ｜ ${l:U7a2_光暴_环_role[2]} 　  　　　 ${l:U7a2_光暴_环_role[3]}&#xD;&#xA;Ｈ２ 》 ${l:U7a2_光暴_点名描述[4]}  ｜ &#xD;&#xA;Ｄ１ 》 ${l:U7a2_光暴_点名描述[5]}  ｜ &#xD;&#xA;Ｄ２ 》 ${l:U7a2_光暴_点名描述[6]}  ｜ ${l:U7a2_光暴_环_role[4]} 　　  　　 ${l:U7a2_光暴_环_role[5]}&#xD;&#xA;Ｄ３ 》 ${l:U7a2_光暴_点名描述[7]}  ｜ 　　　　　&#xD;&#xA;Ｄ４ 》 ${l:U7a2_光暴_点名描述[8]}  ｜ 　　　  　${l:U7a2_光暴_环_role[1]}" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="false" Sequential="True" Name="4.4 小队标点（想开自己开）" Id="cc980391-7b7f-4f1e-befc-1a00fd634715" RegularExpression="^U7a2_光暴_输出:(?&lt;index&gt;\d{6})">
<Actions>
<Action OrderNumber="1" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[1]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack1&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="2" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[2]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack2&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="3" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[3]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack3&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="4" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[4]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack4&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="5" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[5]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack5&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="6" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${l:party[${l:U7a2_光暴_环_pIdx[6]}]},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack6&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: false &#xD;&#xA;}" ActionType="NamedCallback" />
<Action OrderNumber="7" ActionType="Placeholder" ExecutionDelayExpression="10000" />
<Action OrderNumber="8" NamedCallbackName="command" NamedCallbackParam="/mk attack1 &lt;attack1&gt;" ActionType="NamedCallback" />
<Action OrderNumber="9" NamedCallbackName="command" NamedCallbackParam="/mk attack2 &lt;attack2&gt;" ActionType="NamedCallback" />
<Action OrderNumber="10" NamedCallbackName="command" NamedCallbackParam="/mk attack3 &lt;attack3&gt;" ActionType="NamedCallback" />
<Action OrderNumber="11" NamedCallbackName="command" NamedCallbackParam="/mk attack4 &lt;attack4&gt;" ActionType="NamedCallback" />
<Action OrderNumber="12" NamedCallbackName="command" NamedCallbackParam="/mk attack5 &lt;attack5&gt;" ActionType="NamedCallback" />
<Action OrderNumber="13" NamedCallbackName="command" NamedCallbackParam="/mk attack6 &lt;attack6&gt;" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="5. 光球 + 后续" Id="5efb2838-f6ff-4282-be91-a39913f6bb44" RegularExpression="^.{15}\S+ 107:4.{7}:9D1B:(?&lt;x&gt;(99|100)[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="5000">
<Actions>
<Action OrderNumber="1" LogMessageText="cd4:4.7" LogProcess="True" ActionType="LogMessage" Asynchronous="False" />
<Action OrderNumber="2" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100&#xD;&#xA;Start: 0, 0&#xD;&#xA;End: (${_me.x} &gt; 100 ? 18.45 : -18.45), (${y} &gt; 100 ? 3.34 : -3.34)&#xD;&#xA;Waymarks: 4321DCBA&#xD;&#xA;" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100&#xD;&#xA;Start: 0, 0&#xD;&#xA;End: (${_me.x} &gt; 100 ? 18.45 : -18.45), (${y} &gt; 100 ? 3.34 : -3.34)&#xD;&#xA;Waymarks: 4321DCBA&#xD;&#xA;" ActionType="NamedCallback" ExecutionDelayExpression="2000" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="4" UseTTSTextExpression="别动" ActionType="UseTTS" ExecutionDelayExpression="700" Asynchronous="False" />
<Action OrderNumber="5" ActionType="Placeholder" ExecutionDelayExpression="2000" Asynchronous="False" />
<Action OrderNumber="6" VariableOp="SetNumeric" VariableName="tmp_is低层数" VariableExpression="${d:U7a2_光暴_初始光[${_me.id}]} + ${l:U7a2_光暴_环_pIdx.contain(${v:myIdx})} &lt;= 1" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="7" UseTTSTextExpression="穿，${if: ${v:tmp_is低层数} ? 回场中踩塔 : 塔外八方站位 }" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="8" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;Waymarks: A1D4C3B2&#xD;&#xA;R: ${v:tmp_is低层数} ? 4 : 8&#xD;&#xA;O: 100, 100" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="9" VariableName="tmp_is低层数" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;Waymarks: A1D4C3B2&#xD;&#xA;R: 8&#xD;&#xA;O: 100, 100" ActionType="NamedCallback" ExecutionDelayExpression="6900" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="11" UseTTSTextExpression="八方分散" ActionType="UseTTS" ExecutionDelayExpression="4000" Asynchronous="False" />
<Action OrderNumber="12" UseTTSTextExpression="AoE，靠近场中" ActionType="UseTTS" ExecutionDelayExpression="18000" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 过量光层数 for 5" Id="0063cce1-4a94-4175-a9c3-d403f5517dd2" RegularExpression="^.{15}\S+ 1A:8D1:[^:]*:[^:]*:.{8}:[^:]*:(?&lt;tid&gt;.{8}):[^:]*:(?&lt;stack&gt;[^:]+):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" DictVariableOp="Set" DictVariableValueType="Numeric" DictVariableName="U7a2_光暴_初始光" DictVariableKey="${tid}" DictVariableValue="${stack}" ActionType="DictVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a2_光暴_初始光.sum}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="NumericLess" />
</Condition>
</Action>
<Action OrderNumber="3" DictVariableOp="Set" DictVariableValueType="Numeric" DictVariableName="U7a2_光暴_当前光" DictVariableKey="${tid}" DictVariableValue="${stack}" ActionType="DictVariable" Asynchronous="False" />
</Actions>
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
</Triggers>
</Folder>
<Folder Id="7a735ca1-d942-4d7d-952c-cda7015f96b1" Name="E. 光暗水晶" Enabled="true" RawEnvironmentVariables="phase = P2水晶">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="我帮小吉修 bug （消除冰地板以免看不到引导扇形）" Id="75bb71ec-8c15-4279-88ee-e61054498d37" RegularExpression="^.{15}\S+ 101:.{8}:00020001:18">
<Actions>
<Action OrderNumber="1" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="2" NamedCallbackName="MapEffect" NamedCallbackParam="00080004:18" ActionType="NamedCallback" ExecutionDelayExpression="3000" DescTextColor="26f" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="光圈判定" Id="11bcce7e-d5a8-4144-b4ea-0653de8af7ea" RegularExpression="^.{15}\S+ 1[56]:4.{7}:[^:]*:9D41:[^:]*:(?&lt;tid&gt;1.{7})" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="500">
<Actions>
<Action OrderNumber="1" SystemBeepLengthExpression="200" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${tid}" ExpressionTypeL="String" ExpressionR="${_me.id}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="1. 标记光之水晶" Id="f0239002-612d-4814-bb97-c2f120ef7f66" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}17827:([^:]*:){6}(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${id},&#xD;&#xA;    &quot;MarkType&quot;: &quot;attack${n: (4 - roundvec(${x} - 100, ${y} - 100, 4)) % 4 + 1}&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: true &#xD;&#xA;}" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dfd" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 标记大水晶" Id="5095491e-8f05-4cb6-bf80-f49b1f894af7" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}17829:">
<Actions>
<Action OrderNumber="1" NamedCallbackName="mark" NamedCallbackParam="{&#xD;&#xA;    &quot;ActorID&quot;: 0x${id},&#xD;&#xA;    &quot;MarkType&quot;: &quot;triangle&quot;,&#xD;&#xA;    &quot;LocalOnly&quot;: true &#xD;&#xA;}" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dfd" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 暗之水晶不可选中" Id="8ff41e55-e662-4a8c-9aa1-9f9f56630a3d" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}17828:([^:]*:){6}(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ExecScriptExpression="using static Triggernometry.Utilities.Memory;&#xD;&#xA;&#xD;&#xA;IntPtr entity = (IntPtr)0x${_entity[10957356].hexaddress};&#xD;&#xA;IntPtr renderFlags = entity + 0x118;&#xD;&#xA;Write&lt;int&gt;(XivProcHandle, renderFlags, 2048);" Enabled="False" ActionType="ExecuteScript" />
<Action OrderNumber="2" ExecScriptExpression="using static Triggernometry.Utilities.Memory;&#xD;&#xA;&#xD;&#xA;IntPtr entity = (IntPtr)0x${_entity[${id}].hexaddress};&#xD;&#xA;IntPtr renderFlags = entity + 0x118;&#xD;&#xA;Write&lt;int&gt;(XivProcHandle, renderFlags, 16384);" ActionType="ExecuteScript" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="6f4ce1a1-582e-481a-a142-b105d38977b8" Name="B. 滑冰" Enabled="true" RawEnvironmentVariables="phase = P2滑冰">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="1. 获取光 → 冰分身（读条分摊） 时间轴" Id="f2c872af-cadf-4267-8edb-3b4b62fdf8db" RegularExpression="^.{15}\S+ 107:4.{7}:9D10:(?&lt;x&gt;[^:]+):(?&lt;y&gt;[^:]+):(?&lt;z&gt;[^:]+):(?&lt;h&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="3.5 击退结束 | 4.5 冰花判定 | 6.1 冰→光分身出现 | 6.1-7.6-9.1-10.6 四连分摊 | 14.2 背对+冰冻" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a2_滑冰" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="cd4:14.2" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="5" VariableOp="SetNumeric" VariableName="U7a2_滑冰_冰dir8" VariableExpression="roundir(${h} + π, 8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="6" VariableOp="SetNumeric" VariableName="U7a2_滑冰_自身dir8" VariableExpression="${v:U7a2_DD_dir8} + (${v:myIdx_isG1} ? 0 : 4)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="7" VariableOp="SetNumeric" VariableName="U7a2_滑冰_rel冰dir8" VariableExpression="(${v:U7a2_滑冰_冰dir8} - ${v:U7a2_滑冰_自身dir8}) %% 8" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="8" UseTTSTextExpression="准备分摊，${?d: &#xD;&#xA;  0 = 内圈快跑,&#xD;&#xA;  1 = 稍微快跑,&#xD;&#xA;  2 = 正常前进,&#xD;&#xA;  3 = 贴边最慢速度走,&#xD;&#xA;  4 = 内圈快跑,&#xD;&#xA;  5 = 稍微快跑,&#xD;&#xA;  6 = 贴边慢走,&#xD;&#xA;  7 = 逆时针反向，贴边慢走&#xD;&#xA;  [${v:U7a2_滑冰_rel冰dir8}]&#xD;&#xA;}" UseTTSExclusive="False" ActionType="UseTTS" ExecutionDelayExpression="2000" />
<Action OrderNumber="9" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;1: 0, -10, 4&#xD;&#xA;2: 0, -10, 6&#xD;&#xA;3: 0, -10, 8&#xD;&#xA;4: 0, -10, 10" ActionType="NamedCallback" Description="标点：希瓦头顶 1234" DescBgColor="dff" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 16, 160°&#xD;&#xA;B: polar 16, 128°&#xD;&#xA;C: polar 16, 96°&#xD;&#xA;D: polar 16, 64°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="11" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18, 135°&#xD;&#xA;B: polar 18, 110°&#xD;&#xA;C: polar 18, 85°&#xD;&#xA;D: polar 18, 60°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="12" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18, 90°&#xD;&#xA;B: polar 18, 70°&#xD;&#xA;C: polar 18, 50°&#xD;&#xA;D: polar 18, 30°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="2" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="13" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18.75, 56°&#xD;&#xA;B: polar 18.75, 39°&#xD;&#xA;C: polar 18.75, 22°&#xD;&#xA;D: polar 18.75, 5°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 16, -20°&#xD;&#xA;B: polar 16, -52°&#xD;&#xA;C: polar 16, -84°&#xD;&#xA;D: polar 16, -116°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="15" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18, -45°&#xD;&#xA;B: polar 18, -70°&#xD;&#xA;C: polar 18, -95°&#xD;&#xA;D: polar 18, -120°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="5" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="16" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18.75, -90°&#xD;&#xA;B: polar 18.75, -110°&#xD;&#xA;C: polar 18.75, -130°&#xD;&#xA;D: polar 18.75, -150°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="17" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: polar 18.75, -135°&#xD;&#xA;B: polar 18.75, -115°&#xD;&#xA;C: polar 18.75, -95°&#xD;&#xA;D: polar 18.75, -75°" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="7" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="18" UseTTSTextExpression="${?d: &#xD;&#xA;  0 = 快跑,&#xD;&#xA;  1 = &quot;&quot;,&#xD;&#xA;  2 = &quot;&quot;,&#xD;&#xA;  3 = &quot;&quot;,&#xD;&#xA;  4 = 快跑,&#xD;&#xA;  5 = &quot;&quot;,&#xD;&#xA;  6 = &quot;&quot;,&#xD;&#xA;  7 = &quot;&quot;&#xD;&#xA;  [${v:U7a2_滑冰_rel冰dir8}]&#xD;&#xA;}" ActionType="UseTTS" ExecutionDelayExpression="2500" />
<Action OrderNumber="19" UseTTSTextExpression="${?d: &#xD;&#xA;  0 = 去标点范围外,&#xD;&#xA;  1 = 去标点范围外,&#xD;&#xA;  2 = 标点范围外,&#xD;&#xA;  3 = 站在原地,&#xD;&#xA;  4 = 尽量去 Boss 身后,&#xD;&#xA;  5 = 尽量去 Boss 身后,&#xD;&#xA;  6 = 去 Boss 身后,&#xD;&#xA;  7 = 站在原地&#xD;&#xA;  [0${v:U7a2_滑冰_rel冰dir8}]&#xD;&#xA;}" ActionType="UseTTS" ExecutionDelayExpression="5000" />
<Action OrderNumber="20" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Arc&#xD;&#xA;O: 100, 100, -1&#xD;&#xA;R: 18&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;dθ: 34.94°&#xD;&#xA;Waymarks: A132B&#xD;&#xA;---&#xD;&#xA;Action: Arc&#xD;&#xA;O: 100, 100, -1.5&#xD;&#xA;R: 14&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;dθ: 17.06°&#xD;&#xA;Waymarks: C4D" ActionType="NamedCallback" Description="标点：身后范围" DescBgColor="dff" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="[456]" ExpressionTypeR="String" ConditionType="RegexMatch" />
</Condition>
</Action>
<Action OrderNumber="21" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, -1&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: -18.33, 3.87&#xD;&#xA;B: -13.85, 7.93&#xD;&#xA;1: -8.75, 11.22&#xD;&#xA;2: -3.00, 13.09&#xD;&#xA;3:  3.00, 13.09&#xD;&#xA;4:  8.75, 11.22&#xD;&#xA;C:  13.85, 7.93&#xD;&#xA;D:  18.33, 3.87" ActionType="NamedCallback" Description="标点：对侧范围" DescBgColor="dff" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_rel冰dir8}" ExpressionTypeL="String" ExpressionR="[01237]" ExpressionTypeR="String" ConditionType="RegexMatch" />
</Condition>
</Action>
<Action OrderNumber="22" UseTTSTextExpression="${if: abs(relθ( θ(100, 100, ${_me.xy}), dir2rad(${v:U7a2_滑冰_光dir8} + (${v:U7a2_滑冰_rel冰dir8} = 7 ? -1 : 1), 8) )) &lt; π/4 ? 看向场中 : 看向场外 }" ActionType="UseTTS" ExecutionDelayExpression="2000" />
<Action OrderNumber="23" UseTTSTextExpression="停止移动" ActionType="UseTTS" ExecutionDelayExpression="2000" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="分摊判定" Id="8e5c700a-5308-468c-88c1-651b8a1c8077" RegularExpression="^.{15}\S+ 16:4.{7}:[^:]*:9D11:[^:]*:(?&lt;tid&gt;1.{7})" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="500">
<Actions>
<Action OrderNumber="1" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${tid}" ExpressionTypeL="String" ExpressionR="${_me.id}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="3. 滑冰循环计算" Id="80156dbc-8854-4756-949c-9a54f3822146" RegularExpression="^.{15}\S+ 108:4.{7}:9CF9:|^U7a2_滑冰_Solve">
<Actions>
<Action OrderNumber="1" NamedCallbackName="U7a2_IceSkatingSolver" NamedCallbackParam="Init" ActionType="NamedCallback" Description="标点：希瓦头顶 1234">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:startwith(U7a):${_event}}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="2" VariableOp="SetString" VariableName="U7a2_滑冰_loop" VariableExpression="1" ActionType="Variable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:startwith(U7a):${_event}}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" NamedCallbackName="U7a2_IceSkatingSolver" NamedCallbackParam="Solve" ActionType="NamedCallback" Description="标点：希瓦头顶 1234" />
<Action OrderNumber="4" TextAuraEffect="Bold" TextAuraFontSize="39.75" TextAuraForeground="${?d: &#xD;&#xA;  Center = e44, &#xD;&#xA;  Back = 4ea,&#xD;&#xA;  Front = 4e9,&#xD;&#xA;  Side = fc3&#xD;&#xA;  [${v:U7a2_滑冰_PositionState}]&#xD;&#xA;}" TextAuraOutline="000" TextAuraName="U7a2_滑冰_State" TextAuraExpression="${?d: &#xD;&#xA;  Center = &quot;当前位于场中⏎无法滑冰&quot;, &#xD;&#xA;  Back = 当前位于 Boss 背后,&#xD;&#xA;  Front = 当前位于 Boss 对面,&#xD;&#xA;  Side = &quot;当前位于 Boss 侧面⏎需先滑到对侧&quot;&#xD;&#xA;  [${v:U7a2_滑冰_PositionState}]&#xD;&#xA;}" TextAuraXIniExpression="${_screenwidth} / 3" TextAuraYIniExpression="${_screenheight} / 2" TextAuraWIniExpression="${_screenwidth} / 3" TextAuraHIniExpression="${_screenheight} / 4" TextAuraOIniExpression="100" TextAuraFontName="微软雅黑" ActionType="TextAura" />
<Action OrderNumber="5" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: ${_me.xy}, 0&#xD;&#xA;θ: ${v:U7a2_滑冰_Safestθ}&#xD;&#xA;Start: 0, -2, -2&#xD;&#xA;End: 0, -32&#xD;&#xA;Waymarks: AB1234CD" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Front" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, -1&#xD;&#xA;θ: dir2rad(0${v:U7a2_滑冰_冰dir8}, 8)&#xD;&#xA;A: -18.33, 3.87&#xD;&#xA;B: -13.85, 7.93&#xD;&#xA;1: -8.75, 11.22&#xD;&#xA;2: -3.00, 13.09&#xD;&#xA;3:  3.00, 13.09&#xD;&#xA;4:  8.75, 11.22&#xD;&#xA;C:  13.85, 7.93&#xD;&#xA;D:  18.33, 3.87" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Side" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Center" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Back" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="7" LogMessageText="U7a2_滑冰_Solve" LogProcess="True" ActionType="LogMessage" ExecutionDelayExpression="100">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_滑冰_loop}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" TextAuraOp="DeactivateAura" TextAuraEffect="Bold" TextAuraFontSize="39.75" TextAuraName="U7a2_滑冰_State" TextAuraFontName="微软雅黑" ActionType="TextAura">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a2_滑冰_loop}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="4. 双剑技" Id="e57794a6-845e-446e-ac02-27d8df7a3c23" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D0(?&lt;type&gt;[12]):">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="${if: ${type} == 1 ? 留在后面 : 滑到前面 }" ActionType="UseTTS" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Back" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="2" UseTTSTextExpression="${if: ${type} == 1 ? 滑到后面 : 留在前面 }" ActionType="UseTTS" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Front" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="3" UseTTSTextExpression="${if: ${type} == 1 ? 先去后面 : 先去前面 }" ActionType="UseTTS" Asynchronous="False">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Back" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
<ConditionSingle Enabled="true" ExpressionL="${v:U7a2_滑冰_PositionState}" ExpressionTypeL="String" ExpressionR="Front" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="4" UseTTSTextExpression="穿" ActionType="UseTTS" ExecutionDelayExpression="${type} == 1 ? 3000 : 2500" />
<Action OrderNumber="5" VariableOp="SetString" VariableName="U7a2_滑冰_loop" VariableExpression="1" ActionType="Variable" ExecutionDelayExpression="${type} == 1 ? 2500 : 3000" />
<Action OrderNumber="6" VariableName="U7a2_滑冰_loop" ActionType="Variable" />
<Action OrderNumber="7" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="500" DescBgColor="dff" />
<Action OrderNumber="8" VariableName="U7a2_滑冰_loop" ActionType="Variable" />
<Action OrderNumber="9" TextAuraOp="DeactivateAura" TextAuraEffect="Bold" TextAuraFontSize="39.75" TextAuraName="U7a2_滑冰_State" TextAuraFontName="微软雅黑" ActionType="TextAura" />
<Action OrderNumber="10" UseTTSTextExpression="分摊激光" ActionType="UseTTS" ExecutionDelayExpression="1000" />
<Action OrderNumber="11" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 获取冰 → 光分身 for 1" Id="a18e3d88-2c7a-4551-8868-55912f1e7032" RegularExpression="^.{15}\S+ AAA:10F:(?&lt;id&gt;.{8}):[^:]*:12809:17823:(?!100[^:]*:100)(?&lt;x&gt;[^:]*):(?&lt;y&gt;[^:]*):(?&lt;z&gt;[^:]*):(?&lt;h&gt;[^:]*)">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="U7a2_滑冰_光dir8" VariableExpression="roundir(${h} + π, 8)" ActionType="Variable" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 2024-12-01 22:46" Id="20b18f91-b5a1-4a06-8255-e3c39e0d3a8e" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[22:22:42.806] 263 107:40008F11:9D10:92.929:92.929:0.031:0.785" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="5.87 * 1000" />
<Action OrderNumber="3" LogMessageText="[22:22:48.677] AOEActionEffect 16:40008E72:Usurper of Frost:9D11:Sinbound Holy:${_me.id}:${_me}:EC750605:0:B80E:B7D0000:1B:9D118000:0:0:0:0:0:0:0:0:0:0:225932:225932:10000:10000:::81.52:99.59:0.00:-3.12:44:44:0:10000:::116.00:100.00:0.00:-1.57:00005A5A:1:4:00::01:9D11:9D11:1.600:3FFF" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" ActionType="Placeholder" ExecutionDelayExpression="1.11 * 1000" />
<Action OrderNumber="5" LogMessageText="[22:22:49.791] _ActorSetPos AAA:10F:40008F12:Usurper of Frost:12809:17823:114.1421:114.1421:0.0000:-2.3563" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="6" ActionType="Placeholder" ExecutionDelayExpression="0.45 * 1000" />
<Action OrderNumber="7" LogMessageText="[22:22:50.237] AOEActionEffect 16:40008E72:Oracle's Reflection:9D11:Sinbound Holy:${_me.id}:${_me}:EC750605:0:B80E:B7D0000:1B:9D118000:0:0:0:0:0:0:0:0:0:0:225932:225932:10000:10000:::83.11:106.57:0.00:0.28:44:44:0:10000:::116.00:100.00:0.00:-1.57:00005A5E:2:4:00::01:9D11:9D11:1.600:3FFF" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="8" ActionType="Placeholder" ExecutionDelayExpression="1.56 * 1000" />
<Action OrderNumber="9" LogMessageText="[22:22:51.797] AOEActionEffect 16:40008E72:Oracle's Reflection:9D11:Sinbound Holy:${_me.id}:${_me}:EC750605:0:B80E:B7D0000:1B:9D118000:0:0:0:0:0:0:0:0:0:0:225932:225932:10000:10000:::85.24:110.39:0.00:0.58:44:44:0:10000:::116.00:100.00:0.00:-1.57:00005A61:2:4:00::01:9D11:9D11:1.600:3FFF" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="10" ActionType="Placeholder" ExecutionDelayExpression="1.56 * 1000" />
<Action OrderNumber="11" LogMessageText="[22:22:53.353] AOEActionEffect 16:40008E72:Oracle's Reflection:9D11:Sinbound Holy:${_me.id}:${_me}:EC750605:51050000:B80E:B7D0000:1B:9D118000:0:0:0:0:0:0:0:0:0:0:225932:225932:10000:10000:::89.96:115.17:0.00:0.95:44:44:0:10000:::116.00:100.00:0.00:-1.57:00005A67:1:4:00::01:9D11:9D11:1.600:3FFF" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="12" ActionType="Placeholder" ExecutionDelayExpression="3.69 * 1000" />
<Action OrderNumber="13" LogMessageText="[22:22:57.045] 264 108:40008E71:9CF9:00005A6A:1:0.000:0.000:0.000:-2.356" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="14" ActionType="Placeholder" ExecutionDelayExpression="3.02 * 1000" />
<Action OrderNumber="15" LogMessageText="[22:23:00.070] StartsCasting 14:40008F11:Oracle's Reflection:9D01:Twin Stillness:40008F11:Oracle's Reflection:3.200:92.91:92.91:0.00:0.79" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="2707029d-6dd8-46e8-979d-046facd47dca" Name="杂项" Enabled="true">
<Folders />
<Triggers>
<Trigger Enabled="true" Sequential="True" Name="分散分摊" Id="73d4ad92-9491-4191-8193-639152158b65" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D1(?&lt;type&gt;C|D):">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="_tmp_is低层数" VariableExpression="${v:U7a_phase} == P2光暴 &amp;&amp; 0${d:U7a2_光暴_初始光[${_me.id}]} + 0${l:U7a2_光暴_环_pIdx.contain(${v:myIdx})} &lt;= 1" ActionType="Variable" />
<Action OrderNumber="2" UseTTSTextExpression="${if: ${type} == C ? 两人分摊 : 全体分散 }" ActionType="UseTTS" ExecutionDelayExpression="${v:_tmp_is低层数} ? 1900 : 0" />
<Action OrderNumber="3" VariableName="_tmp_is低层数" ActionType="Variable" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="0e4e5344-72a2-4282-a2e5-edba7d6a4ced" Name="P3" Enabled="true">
<Folders>
<Folder Id="c9993d65-2883-4bb0-9a0b-f503f2a48cd7" Name="B. 二运" Enabled="true" RawEnvironmentVariables="phase = P3二运">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 初始化 深渊狂水" Id="6bd7e448-e5c6-4101-854b-f646da78979f" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D4E:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a3_二运" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" DictVariableOp="Build" DictVariableTarget="U7a3_二运_水" DictVariableValue="=,${l:party.join(&quot;=0,&quot;)}=0" ActionType="DictVariable" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 地火获取 * 2 =&gt; 4" Id="6a9150d3-ca2d-4b92-bf90-463b0fc3cba2" RegularExpression="^.{15}\S+ 105:Add:(?&lt;id&gt;4.{7}):.*BNpcID:1EB0FF:.*Heading:(?&lt;h&gt;[^:]*):.*PosX:(?&lt;x&gt;(99|100)[^:]+):PosY:(?&lt;y&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="只获取指向 dir8 = 0 1 2 3 的中心实体（判断起始方向），或正南的实体（判断顺逆）" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="U7a3_二运_is顺" VariableExpression="cos(${h}) * (${x} - 100) &gt; sin(${h}) * (${y} - 100)" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="round(${y}) &gt; 100" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" VariableOp="SetNumeric" VariableName="U7a3_二运_dir8" VariableExpression="roundir(${h}, 8) % 4" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="round(${y}) = 100" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="4" LogMessageText="_U7a3_二运_地火" LogProcess="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${ev:U7a3_二运_dir8}${ev:U7a3_二运_is顺}" ExpressionTypeL="String" ExpressionR="11" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="round(${y}) = 100 &amp;&amp; roundir(${h}, 8) &lt; 4" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="round(${y}) &gt; 100" ExpressionTypeL="Numeric" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="输出2.1 时间轴" Id="33acd693-17d1-4fee-aaa1-a90123cd012d" RegularExpression="^U7a3_二运_地火:is顺:(?&lt;is顺&gt;[01]):dir8:(?&lt;dir8&gt;.):safeDir8:(?&lt;safeDir8&gt;.):safeDir8':(?&lt;safeDir8ST&gt;.)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Description="3 地火日志 | 10 分摊 | 13 跳 | 23 分散 | 29 分摊 | 32 跳 | 34 击退" DescriptionOverride="True" />
<Action OrderNumber="2" UseTTSTextExpression="分散站位" ActionType="UseTTS" ExecutionDelayExpression="6800" />
<Action OrderNumber="3" SystemBeepLengthExpression="200" ExecutionDelayExpression="200" />
<Action OrderNumber="4" ActionType="Placeholder" ExecutionDelayExpression="2000" />
<Action OrderNumber="5" UseTTSTextExpression="${f:pick(${n: (${safeDir8} + (${v:myIdx_isTH} ? 0 : 4)) % 8}): 上北, 左上, 左西, 左下, 下南, 右下, 右东, 右上}分散站位，去 ${?l: 红色A点, 紫色D点, 红色壹点, 紫色四点, 黄色B点, 蓝色C点, 黄色贰点, 蓝色三点 [${v:myIdx}]}" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx} % 4" ExpressionTypeL="Numeric" ExpressionR="2" ExpressionTypeR="String" ConditionType="StringNotEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" UseTTSTextExpression="${f:pick(${n: (${safeDir8ST} + (${v:myIdx_isTH} ? 0 : 4)) % 8}): 上北, 左上, 左西, 左下, 下南, 右下, 右东, 右上}分散站位，去 ${?l: 红色A点, 紫色D点, 红色壹点, 紫色四点, 黄色B点, 蓝色C点, 黄色贰点, 蓝色三点 [${v:myIdx}]}" ActionType="UseTTS">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:myIdx} % 4" ExpressionTypeL="Numeric" ExpressionR="2" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" NamedCallbackName="command" NamedCallbackParam="/${if: ${f:contain(ia So):${_me}} ? p : e } &#xD;&#xA;人群：${f:pick(${safeDir8}): AC, 13, BD, 24}&#xD;&#xA;ST：${f:pick(${safeDir8ST}): A, 1, D, 4, C, 3, B, 2}&#xD;&#xA;D2：${f:pick(${safeDir8ST}): C, 3, B, 2, A, 1, D, 4}" ActionType="NamedCallback" />
<Action OrderNumber="8" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(0${safeDir8}, 8)&#xD;&#xA;scaleX: 0${is顺} ? 1 : -1&#xD;&#xA;A:     0, -10.25&#xD;&#xA;D: -7.25,  -7.25&#xD;&#xA;B:     0,  10.25&#xD;&#xA;C:  7.25,   7.25&#xD;&#xA;---&#xD;&#xA;O: 100, 100&#xD;&#xA;θ: dir2rad(0${safeDir8}, 8)&#xD;&#xA;1:  3.5, -17.5&#xD;&#xA;4: -3.5, -17.5&#xD;&#xA;2: -3.5,  17.5&#xD;&#xA;3:  3.5,  17.5" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="9" ActionType="Placeholder" ExecutionDelayExpression="17000" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 水分摊点名 =&gt; 2" Id="500e30ec-d685-401e-8730-b05281ddd793" RegularExpression="^.{15}\S+ 1A:99D:(?:[^:]|: )*:(?&lt;t&gt;(10|29|38)[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" DictVariableOp="Set" DictVariableValueType="Numeric" DictVariableName="U7a3_二运_水" DictVariableKey="${tid}" DictVariableValue="round(${t} / 13)" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="_U7a3_二运_水" LogProcess="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a3_二运_水.sum}" ExpressionTypeL="String" ExpressionR="12" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 处理" Id="f7bff5cb-686e-4e69-83fb-856aab77fdb8" RegularExpression="^_U7a3_二运_水">
<Actions>
<Action OrderNumber="1" ListVariableOp="Build" ListVariableExpression=",${l:party.join(&quot;,&quot;, &quot;3,4,1,2,5,6,7,8&quot;)}" ListVariableTarget="U7a3_二运_水" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" ActionType="Placeholder" Asynchronous="False" Description="l:U7a3_二运_水：八人 id    无高 无低 短高 短低 中高 中低 长高 长低" DescriptionOverride="True" />
<Action OrderNumber="3" ListVariableOp="SortByKeys" ListVariableName="U7a3_二运_水" ListVariableExpression="n+: ${d:U7a3_二运_水[${_this}]}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="4" UseTTSTextExpression="${if: ${l:U7a3_二运_水.indexof(${_me.id})} % 2 = 1 ? 一组左侧分摊 : 二组右侧分摊 }" ActionType="UseTTS" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="4. 处理地火" Id="1dda04a4-c6aa-4e35-ad9e-357a7e11303f" RegularExpression="^_U7a3_二运_地火">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="tmp_safeDir8" VariableExpression="(${v:U7a3_二运_dir8} + (${v:U7a3_二运_is顺} ? 1 : -1)) %% 4" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="tmp_safeDir8'" VariableExpression="(${v:tmp_safeDir8} + (${v:U7a3_二运_is顺} ? 1 : -1)) %% 8" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="U7a3_二运_地火:is顺:${v:U7a3_二运_is顺}:dir8:${v:U7a3_二运_dir8}:safeDir8:${v:tmp_safeDir8}:safeDir8':${v:tmp_safeDir8'}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False" />
<Action OrderNumber="4" VariableName="tmp_safeDir8" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="5" VariableName="tmp_safeDir8'" ActionType="Variable" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="输出2.2 时间轴（地火回中）" Id="ed20c112-8dcd-4807-bbb2-9bf74ee7c10b" RegularExpression="^U7a3_二运_地火:is顺:(?&lt;is顺&gt;[01]):dir8:(?&lt;dir8&gt;.):safeDir8:(?&lt;safeDir8&gt;.):safeDir8':(?&lt;safeDir8ST&gt;.)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" ExecutionDelayExpression="${v:myIdx} % 4 = 2 ? 19500 : 20000" />
<Action OrderNumber="2" UseTTSTextExpression="场中分摊" ActionType="UseTTS" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Circle&#xD;&#xA;O: 100, 100&#xD;&#xA;R: 3.75&#xD;&#xA;Waymarks: A1D4C3B2" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="b1a0658c-d119-4cfc-89ef-b4fb4c1d2686" Name="A. 一运" Enabled="true" RawEnvironmentVariables="phase = P3一运">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 初始化 时间压缩" Id="183f49c3-1fe0-4281-809a-759599a9d537" RegularExpression="^.{15}\S+ 14:(?&lt;id&gt;4.{7}):[^:]+:9D4A:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a3_一运" ActionType="Variable" />
<Action OrderNumber="3" UseTTSTextExpression="AoE，时间压缩" ActionType="UseTTS" />
<Action OrderNumber="4" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, 0.6" ActionType="NamedCallback" DescTextColor="26f" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 获取冰火 * 8 =&gt; 输出1" Id="368db7b8-81b7-4c29-bfbc-fd71c6a5b32a" RegularExpression="^.{15}\S+ 1A:99(?&lt;type&gt;7|E):([^:]|: )+:(?&lt;t&gt;[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" ActionType="Placeholder" Asynchronous="False" Description="TH   0 短　   1 冰　   2 中　   3 长高   4 长低" DescriptionOverride="True" />
<Action OrderNumber="3" ActionType="Placeholder" Asynchronous="False" Description="D    5 短低   6 短高   7 中　   8 长　   9 冰　" DescriptionOverride="True" />
<Action OrderNumber="4" ListVariableOp="Set" ListVariableName="U7a3_一运_全队点名" ListVariableExpression="${?d:&#xD;&#xA;  11 7 0 = 0,&#xD;&#xA;  21 E 0 = 1,&#xD;&#xA;  21 7 0 = 2,&#xD;&#xA;  31 7 0 = 3,&#xD;&#xA;  11 7 1 = 5,&#xD;&#xA;  21 7 1 = 7,&#xD;&#xA;  31 7 1 = 8,&#xD;&#xA;  21 E 1 = 9&#xD;&#xA;  [${n:round(${t})} ${type} ${n: ${l:party.indexof(${tid})} &gt; 4}]&#xD;&#xA;}" ListVariableIndex="${l:party.indexof(${tid})}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="5" VariableOp="SetNumeric" VariableName="U7a3_一运_冰isD" VariableExpression="${l:party.indexof(${tid})} &gt; 4" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${type}" ExpressionTypeL="String" ExpressionR="E" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="6" ActionType="Placeholder" Asynchronous="False" Description="赋予优先级并输出" DescriptionOverride="True" />
<Action OrderNumber="7" ListVariableOp="SetAll" ListVariableExpressionType="Numeric" ListVariableName="U7a3_一运_全队点名" ListVariableExpression="(${_this} = 3 || ${_this} = 5) &#xD;&#xA;&amp;&amp; ${_idx} != ${l:U7a3_一运_全队点名.indexof(${_this})} &#xD;&#xA;? (${_this} + 1) &#xD;&#xA;: ${_this}" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.size}" ExpressionTypeL="String" ExpressionR="8" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.indexof(&quot;&quot;)}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" ListVariableOp="Build" ListVariableExpression=",${f:pick(${l:U7a3_一运_全队点名[${v:myIdx}]}): &#xD;&#xA;  &quot;散,记录外,摊,引导,摊,对侧&quot;,&#xD;&#xA;  &quot;摊,记录外,摊,引导,摊,对侧&quot;,&#xD;&#xA;  &quot;摊,记录外,散,挂机,摊,引导&quot;,&#xD;&#xA;  &quot;摊,引导,摊,记录内,散,对侧&quot;,&#xD;&#xA;  &quot;摊,引导,摊,记录内,散,对侧&quot;,&#xD;&#xA;  &#xD;&#xA;  &quot;散,记录外,摊,引导,摊,对侧&quot;,&#xD;&#xA;  &quot;散,记录外,摊,引导,摊,对侧&quot;,&#xD;&#xA;  &quot;摊,记录内,散,挂机,摊,引导&quot;,&#xD;&#xA;  &quot;摊,引导,摊,记录内,散,对侧&quot;,&#xD;&#xA;  &quot;摊,引导,摊,记录内,摊,对侧&quot;,&#xD;&#xA;}" ListVariableTarget="U7a3_一运_自身路线" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.size}" ExpressionTypeL="String" ExpressionR="8" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.indexof(&quot;&quot;)}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" LogMessageText="U7a3_一运:my点名:${l:U7a3_一运_全队点名[${v:myIdx}]}:点名:${l:U7a3_一运_全队点名.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.size}" ExpressionTypeL="String" ExpressionR="8" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_全队点名.indexof(&quot;&quot;)}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="2. 获取沙漏 for 3" Id="6e2a0da7-7ab8-43b0-8c5a-391c4444d89f" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}17832:([^:]*:){9}(?&lt;h&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" DictVariableOp="Set" DictVariableValueType="Numeric" DictVariableName="U7a3_一运_沙漏dir8" DictVariableKey="${id}" DictVariableValue="roundir(${h} + π, 8)" ActionType="DictVariable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="输出1. 初始播报" Id="fc4cd11b-4252-4888-bd18-e56194a19a6f" RegularExpression="^U7a3_一运:my点名:(?&lt;my点名&gt;[0-9])">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="0 = 对侧挂机 1 = 正中心 2 = 中心偏外 3 = 沙漏下 4 = 沙漏引导 5 = 场外" DescriptionOverride="True" />
<Action OrderNumber="2" ListVariableExpressionType="Numeric" NamedCallbackName="hint" NamedCallbackParam="42&#xD;&#xA;${f:pick(0${my点名}): &#xD;&#xA;  &quot;【正下】　场外 》 灯下 》 场中 》 灯外 》 场中 》 对侧⏎　　　　　分散 　 记录 　 分摊 　 引导 　 分摊 　 挂机&quot;,&#xD;&#xA;  &quot;【正下】　场中 》 灯下 》 场中 》 灯外 》 场中 》 对侧⏎　　　　　分摊 　 记录 　 分摊 　 引导 　 分摊 　 挂机&quot;,&#xD;&#xA;  &quot;【正左】　场中 》 灯下 》 场外 》 场中 》 场中 》 灯外⏎　　　　　分摊 　 记录 　 分散 　 挂机 　 分摊 　 引导&quot;,&#xD;&#xA;  &quot;【左下】　场中 》 灯外 》 场中 》 场中 》 场外 》 对侧⏎　　　　　分摊 　 引导 　 分摊 　 记录 　 分散 　 挂机&quot;,&#xD;&#xA;  &quot;【右下】　场中 》 灯外 》 场中 》 场中 》 场外 》 对侧⏎　　　　　分摊 　 引导 　 分摊 　 记录 　 分散 　 挂机&quot;,&#xD;&#xA;  &#xD;&#xA;  &quot;【左上】　场外 》 灯下 》 场中 》 灯外 》 场中 》 对侧⏎　　　　　分散 　 记录 　 分摊 　 引导 　 分摊 　 挂机&quot;,&#xD;&#xA;  &quot;【右上】　场外 》 灯下 》 场中 》 灯外 》 场中 》 对侧⏎　　　　　分散 　 记录 　 分摊 　 引导 　 分摊 　 挂机&quot;,&#xD;&#xA;  &quot;【正右】　场中 》 场中 》 场外 》 场中 》 场中 》 灯外⏎　　　　　分摊 　 记录 　 分散 　 挂机 　 分摊 　 引导&quot;,&#xD;&#xA;  &quot;【正上】　场中 》 灯外 》 场中 》 场中 》 场外 》 对侧⏎　　　　　分摊 　 引导 　 分摊 　 记录 　 分散 　 挂机&quot;,&#xD;&#xA;  &quot;【正上】　场中 》 灯外 》 场中 》 场中 》 场中 》 对侧⏎　　　　　分摊 　 引导 　 分摊 　 记录 　 分摊 　 挂机&quot;,&#xD;&#xA;}" ActionType="NamedCallback">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:contain(&quot; &quot;):${_me}}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" ListVariableExpressionType="Numeric" NamedCallbackName="hint" NamedCallbackParam="42&#xD;&#xA;${f:pick(0${my点名}): &#xD;&#xA;  &quot;【正下】　場外 》 灯下 》 場中 》 灯外 》 場中 》 對面⏎　　　　　分散 　 記録 　 集合 　 引導 　 集合 　 挂机&quot;,&#xD;&#xA;  &quot;【正下】　場中 》 灯下 》 場中 》 灯外 》 場中 》 對面⏎　　　　　集合 　 記録 　 集合 　 引導 　 集合 　 挂机&quot;,&#xD;&#xA;  &quot;【正左】　場中 》 灯下 》 場外 》 場中 》 場中 》 灯外⏎　　　　　集合 　 記録 　 分散 　 挂机 　 集合 　 引導&quot;,&#xD;&#xA;  &quot;【左下】　場中 》 灯外 》 場中 》 場中 》 場外 》 對面⏎　　　　　集合 　 引導 　 集合 　 記録 　 分散 　 挂机&quot;,&#xD;&#xA;  &quot;【右下】　場中 》 灯外 》 場中 》 場中 》 場外 》 對面⏎　　　　　集合 　 引導 　 集合 　 記録 　 分散 　 挂机&quot;,&#xD;&#xA;  &#xD;&#xA;  &quot;【左上】　場外 》 灯下 》 場中 》 灯外 》 場中 》 對面⏎　　　　　分散 　 記録 　 集合 　 引導 　 集合 　 挂机&quot;,&#xD;&#xA;  &quot;【右上】　場外 》 灯下 》 場中 》 灯外 》 場中 》 對面⏎　　　　　分散 　 記録 　 集合 　 引導 　 集合 　 挂机&quot;,&#xD;&#xA;  &quot;【正右】　場中 》 場中 》 場外 》 場中 》 場中 》 灯外⏎　　　　　集合 　 記録 　 分散 　 挂机 　 集合 　 引導&quot;,&#xD;&#xA;  &quot;【正上】　場中 》 灯外 》 場中 》 場中 》 場外 》 對面⏎　　　　　集合 　 引導 　 集合 　 記録 　 分散 　 挂机&quot;,&#xD;&#xA;  &quot;【正上】　場中 》 灯外 》 場中 》 場中 》 場中 》 對面⏎　　　　　集合 　 引導 　 集合 　 記録 　 集合 　 挂机&quot;,&#xD;&#xA;}" ActionType="NamedCallback">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:contain(&quot; &quot;):${_me}}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="4" UseTTSTextExpression="准备去${f:pick(0${my点名}): &#xD;&#xA;  &quot;正下，场外分散&quot;,&#xD;&#xA;  &quot;正下，场中分摊&quot;,&#xD;&#xA;  &quot;正左，场中分摊&quot;,&#xD;&#xA;  &quot;左下，场中分摊&quot;,&#xD;&#xA;  &quot;右下，场中分摊&quot;,&#xD;&#xA;  &#xD;&#xA;  &quot;左上，场外分散&quot;,&#xD;&#xA;  &quot;右上，场外分散&quot;,&#xD;&#xA;  &quot;正右，场中分摊&quot;,&#xD;&#xA;  &quot;正上，场中分摊&quot;,&#xD;&#xA;  &quot;正上，场中分摊&quot;,&#xD;&#xA;}" ActionType="UseTTS" />
<Action OrderNumber="5" UseTTSTextExpression="${f:pick(0${my点名}): &#xD;&#xA;  &quot;场外分散&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &#xD;&#xA;  &quot;场外分散&quot;,&#xD;&#xA;  &quot;场外分散&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;  &quot;场中分摊&quot;,&#xD;&#xA;}" ActionType="UseTTS" ExecutionDelayExpression="6000" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="输出2.1 时间轴" Id="2f6c6299-a9e6-4122-8ec5-6a8c49d3d2f5" RegularExpression="^U7a3_一运:dir8:(?&lt;dir8&gt;[0-7]):myDir8:(?&lt;myDir8&gt;[0-7]):my点名:(?&lt;my点名&gt;[0-9]):">
<Actions>
<Action OrderNumber="1" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;1: 0, -4.0, -1&#xD;&#xA;2: 0, -6.0, -1&#xD;&#xA;3: fakeclear&#xD;&#xA;4: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="2" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, -${?d: 散 = 13, 摊 = 1 [${l:U7a3_一运_自身路线[1]}]}&#xD;&#xA;B: fakeclear&#xD;&#xA;C: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="3" UseTTSTextExpression="${?d: 记录外 = 沙漏下方记录, 记录内 = 中心偏外记录, 引导 = 引导激光 [${l:U7a3_一运_自身路线[2]}]}" ActionType="UseTTS" ExecutionDelayExpression="7500" Asynchronous="False" />
<Action OrderNumber="4" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, -${?d: 记录外 = 8.5, 记录内 = 1 [${l:U7a3_一运_自身路线[2]}]}&#xD;&#xA;B: fakeclear&#xD;&#xA;C: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_自身路线[2]}" ExpressionTypeL="String" ExpressionR="引导" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="5" UseTTSTextExpression="${?d: 散 = 场外分散, 摊 = 中心分摊 [${l:U7a3_一运_自身路线[3]}]}" ActionType="UseTTS" ExecutionDelayExpression="5000" Asynchronous="False" />
<Action OrderNumber="6" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, -${?d: 散 = 13, 摊 = 1 [${l:U7a3_一运_自身路线[3]}]}&#xD;&#xA;B: fakeclear&#xD;&#xA;C: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="7" UseTTSTextExpression="${?d: 挂机 = 中心挂机, 记录内 = 中心偏外记录, 引导 = 引导激光 [${l:U7a3_一运_自身路线[4]}]}" ActionType="UseTTS" ExecutionDelayExpression="5000" Asynchronous="False" />
<Action OrderNumber="8" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, -${?d: 挂机 = 1, 记录内 = 1 [${l:U7a3_一运_自身路线[4]}]}&#xD;&#xA;B: fakeclear&#xD;&#xA;C: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_自身路线[4]}" ExpressionTypeL="String" ExpressionR="引导" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="9" UseTTSTextExpression="${?d: 散 = 场外分散, 摊 = 中心分摊 [${l:U7a3_一运_自身路线[5]}]}" ActionType="UseTTS" ExecutionDelayExpression="5000" Asynchronous="False" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, -${?d: 散 = 13, 摊 = 1 [${l:U7a3_一运_自身路线[5]}]}&#xD;&#xA;B: fakeclear&#xD;&#xA;C: fakeclear&#xD;&#xA;D: fakeclear" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="11" UseTTSTextExpression="${?d: 对侧 = 去对侧输出, 引导 = 引导激光 [${l:U7a3_一运_自身路线[6]}]}" ActionType="UseTTS" ExecutionDelayExpression="5000" Asynchronous="False" />
<Action OrderNumber="12" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;A: 0, 1&#xD;&#xA;B: 0, 3&#xD;&#xA;C: 0, 5&#xD;&#xA;D: 0, 7" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a3_一运_自身路线[6]}" ExpressionTypeL="String" ExpressionR="引导" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="13" UseTTSTextExpression="${?d: 对侧 = 注意面向, 引导 = 原地背对 [${l:U7a3_一运_自身路线[6]}]}" ActionType="UseTTS" ExecutionDelayExpression="5000" Asynchronous="False" />
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="4000" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="15" UseTTSTextExpression="中心分摊" ActionType="UseTTS" ExecutionDelayExpression="3000" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="4. 沙漏旋转 =&gt; 输出3" Id="9c25c4ad-38da-46fd-b09c-7c13c6f52911" RegularExpression="^.{15}\S+ 1A:B9A:[^:]*:[^:]*:.{8}:[^:]*:(?&lt;id&gt;4.{7}):[^:]*:(?&lt;type&gt;15C|10D)(:|$)">
<Actions>
<Action OrderNumber="1" LogMessageText="U7a3_一运_沙漏:${id}:is顺:${n: ${type} == 15C}:dir8:${d:U7a3_一运_沙漏dir8[${id}]}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="输出2.2 文字播报" Id="d3c1590d-6721-4a0e-a7b5-6045c0b211e4" RegularExpression="^U7a3_一运:dir8:(?&lt;dir8&gt;[0-7]):myDir8:(?&lt;myDir8&gt;[0-7]):my点名:(?&lt;my点名&gt;[0-9]):冰isD:(?&lt;冰isD&gt;[01]):点名:(?&lt;p1&gt;\d)(?&lt;p2&gt;\d)(?&lt;p3&gt;\d)(?&lt;p4&gt;\d)(?&lt;p5&gt;\d)(?&lt;p6&gt;\d)(?&lt;p7&gt;\d)(?&lt;p8&gt;\d)">
<Actions>
<Action OrderNumber="1" ListVariableOp="SetAll" ListVariableName="tmp_正北逆标点" ListVariableExpression="${f:slice(${n: (${_idx} - 1 + ${dir8}) % 8 }):${f:toxivchar:A1D4C3B2}}" ListVariableIndex="8" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" ListVariableOp="SetAll" ListVariableName="tmp_各人的方向" ListVariableExpression="${?d: 0 = 4, 1 = 4, 2 = 2, 3 = 3, 4 = 5, 5 = 1, 6 = 7, 7 = 6, 8 = 0, 9 = 0 [${p${_idx}}]}" ListVariableIndex="8" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="3" DictVariableOp="SetAll" DictVariableKeyType="Numeric" DictVariableName="tmp_各方向的人" DictVariableLength="8" DictVariableKey="${l:tmp_各人的方向[${_idx}]}" DictVariableValue="${?l: ＭＴ,ＳＴ,Ｈ１,Ｈ２,Ｄ１,Ｄ２,Ｄ３,Ｄ４ [${_idx}]}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="4" ListVariableOp="SetAll" ListVariableName="tmp_每人点名描述" ListVariableExpression="${?d: &#xD;&#xA;  0 = 短火 正下, &#xD;&#xA;  1 = 冰　 正下, &#xD;&#xA;  2 = 中火 正左, &#xD;&#xA;  3 = 长高 左下,&#xD;&#xA;  4 = 长低 右下, &#xD;&#xA;  5 = 短高 左上,&#xD;&#xA;  6 = 短低 右上,&#xD;&#xA;  7 = 中火 正右,&#xD;&#xA;  8 = 长火 正上,&#xD;&#xA;  9 = 冰　 正上&#xD;&#xA;[${p${_idx}}]} ${l:tmp_正北逆标点[${n: ${l:tmp_各人的方向[${_idx}]} + 1}]}" ListVariableIndex="8" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:contain(&quot; &quot;):${_me}}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" ListVariableOp="SetAll" ListVariableName="tmp_每人点名描述" ListVariableExpression="${?d: &#xD;&#xA;  0 = 短火 正下, &#xD;&#xA;  1 = 冰　 正下, &#xD;&#xA;  2 = 中火 正左, &#xD;&#xA;  3 = 長高 左下,&#xD;&#xA;  4 = 長低 右下, &#xD;&#xA;  5 = 短高 左上,&#xD;&#xA;  6 = 短低 右上,&#xD;&#xA;  7 = 中火 正右,&#xD;&#xA;  8 = 長火 正上,&#xD;&#xA;  9 = 冰　 正上&#xD;&#xA;[${p${_idx}}]} ${l:tmp_正北逆标点[${n: ${l:tmp_各人的方向[${_idx}]} + 1}]}" ListVariableIndex="8" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${f:contain(&quot; &quot;):${_me}}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" NamedCallbackName="command" NamedCallbackParam="/${if: ${f:contain(ia So):${_me}} ? p : e } &#xD;&#xA;　　　 　　 　　 　 ｜　　　  　  ${d:tmp_各方向的人[0]}&#xD;&#xA;ＭＴ 》 ${l:tmp_每人点名描述[1]} ｜　　　　　  ${l:tmp_正北逆标点[1]}&#xD;&#xA;ＳＴ 》 ${l:tmp_每人点名描述[2]} ｜　 ${d:tmp_各方向的人[1]} ${l:tmp_正北逆标点[2]}　 ┃ 　${l:tmp_正北逆标点[8]} ${d:tmp_各方向的人[7]}&#xD;&#xA;Ｈ１ 》 ${l:tmp_每人点名描述[3]} ｜　　　　　  ┃&#xD;&#xA;Ｈ２ 》 ${l:tmp_每人点名描述[4]} ｜${d:tmp_各方向的人[2]} ${l:tmp_正北逆标点[3]} ━━ ○ ━━ ${l:tmp_正北逆标点[7]} ${d:tmp_各方向的人[6]}&#xD;&#xA;Ｄ１ 》 ${l:tmp_每人点名描述[5]} ｜　　　　 ／　  ＼&#xD;&#xA;Ｄ２ 》 ${l:tmp_每人点名描述[6]} ｜　 ${d:tmp_各方向的人[3]} ${l:tmp_正北逆标点[4]}　 　 　${l:tmp_正北逆标点[6]} ${d:tmp_各方向的人[5]}&#xD;&#xA;Ｄ３ 》 ${l:tmp_每人点名描述[7]} ｜　　　　　  ${l:tmp_正北逆标点[5]}&#xD;&#xA;Ｄ４ 》 ${l:tmp_每人点名描述[8]} ｜　　　  　  ${d:tmp_各方向的人[4]}" ActionType="NamedCallback" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 获取加速连线 * 3 =&gt; 输出2" Id="6a8756cc-a0ef-4665-b004-e035851d2e39" RegularExpression="^.{15}\S+ 23:(?&lt;sid&gt;4.{7}):[^:]*:4.{7}:[^:]*:[^:]*:[^:]*:0086:">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" VariableOp="Increment" VariableName="U7a3_一运_短沙漏_Σx" VariableExpression="sin(dir2rad(${d:U7a3_一运_沙漏dir8[${sid}]}, 8))" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" VariableOp="Increment" VariableName="U7a3_一运_短沙漏_Σy" VariableExpression="cos(dir2rad(${d:U7a3_一运_沙漏dir8[${sid}]}, 8))" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="4" VariableOp="Increment" VariableName="U7a3_一运_短沙漏_n" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="5" VariableOp="SetNumeric" VariableName="U7a3_一运_dir8" VariableExpression="roundvec(-${v:U7a3_一运_短沙漏_Σx}, -${v:U7a3_一运_短沙漏_Σy}, 8)" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a3_一运_短沙漏_n}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="6" VariableOp="SetNumeric" VariableName="U7a3_一运_myDir8" VariableExpression="(${v:U7a3_一运_dir8} + ${?l: 4,4,2,3,5, 1,7,6,0,0 [${n: ${l:U7a3_一运_全队点名[${v:myIdx}]} + 1}]}) % 8" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a3_一运_短沙漏_n}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" LogMessageText="U7a3_一运:dir8:${v:U7a3_一运_dir8}:myDir8:${v:U7a3_一运_myDir8}:my点名:${l:U7a3_一运_全队点名[${v:myIdx}]}:冰isD:${v:U7a3_一运_冰isD}:点名:${l:U7a3_一运_全队点名.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a3_一运_短沙漏_n}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="输出3 沙漏方向标记" Id="6412c88f-a5d6-4c42-b278-f79f87ae293d" RegularExpression="^U7a3_一运_沙漏:(?&lt;id&gt;.{8}):is顺:(?&lt;is顺&gt;[01]):dir8:(?&lt;dir8&gt;[0-7])">
<Actions>
<Action OrderNumber="1" NamedCallbackName="AdvWm" NamedCallbackParam="Action: Linear&#xD;&#xA;O: 100, 100 polar 9.5, dir2rad(${v:U7a3_一运_myDir8}, 8)&#xD;&#xA;θ: dir2rad(${v:U7a3_一运_myDir8}, 8) + (0${is顺} ? 80° : -80°)&#xD;&#xA;Waymarks: ABCD&#xD;&#xA;Start: 0,  0&#xD;&#xA;End:   0, -6" ActionType="NamedCallback" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${dir8}" ExpressionTypeL="String" ExpressionR="${v:U7a3_一运_myDir8}" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="取消延迟咏唱特效 （没用?" Id="b1bd4972-010d-43d8-8de9-02c24bc1c751" RegularExpression="^.{15}\S+ 1A:(?&lt;statusId&gt;99B):[^:]*:[^:]*:.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" NamedCallbackName="RemoveStatus" NamedCallbackParam="${_entity[${tid}].address}, 0x${statusId}" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="2" NamedCallbackName="Redraw" NamedCallbackParam="${_entity[${tid}].address}" ActionType="NamedCallback" ExecutionDelayExpression="1000" DescTextColor="26f" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="初始激光判定" Id="286c6c27-6344-4feb-9e56-2845d9fe31db" RegularExpression="^.{15}\S+ 1[56]:4.{7}:[^:]*:9D2B:[^:]*:(?&lt;tid&gt;1.{7})" PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="500">
<Actions>
<Action OrderNumber="1" SystemBeepLengthExpression="200" />
<Action OrderNumber="2" UseTTSTextExpression="躲开" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${tid}" ExpressionTypeL="String" ExpressionR="${_me.id}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="42da1799-241b-4497-b90a-32cbc7fbdbaa" Name="P4" Enabled="true">
<Folders>
<Folder Id="39bfb57c-2148-4e19-aa91-ed5ae251dad7" Name="A. 开场" Enabled="true" RawEnvironmentVariables="phase = P4开场">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 初始化 生成琳" Id="8146e4ad-f9c6-442f-90ee-bca1ac4fda30" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}17833:([^:]*:){7}(?&lt;y&gt;[^:]+):">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" UseTTSTextExpression="去${if: ${y} &gt; 100 ? C : A }点方向" ActionType="UseTTS" />
<Action OrderNumber="3" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, 2" ActionType="NamedCallback" DescTextColor="26f" />
<Action OrderNumber="4" LogMessageText="cd5:5" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 天光轮回" Id="7deff327-5d30-46eb-a266-e6db9e121b98" RegularExpression="^.{15}\S+ 1A:8E1:[^:]+:[^:]+:.{8}:[^:]*:(?&lt;tid&gt;4.{7}):[^:]*:223:">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="集合站位，天光轮回" ActionType="UseTTS" />
<Action OrderNumber="2" LogMessageText="cd5:5" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="3" UseTTSTextExpression="躲开" ActionType="UseTTS" ExecutionDelayExpression="4900" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="缩小实体" Id="3a378de7-9731-490e-a4e3-abf1e146efa9" RegularExpression="^.{15}\S+ 03:(?&lt;id&gt;4.{7}):([^:]*:){7}1783[35]:">
<Actions>
<Action OrderNumber="1" NamedCallbackName="ObjectScaling" NamedCallbackParam="${_entity[${id}].address}, 2" ActionType="NamedCallback" DescTextColor="26f" />
</Actions>
</Trigger>
</Triggers>
</Folder>
<Folder Id="6de63f6a-0f66-45dc-9ef3-2e0bac0655c7" Name="C. 二运" Enabled="true" RawEnvironmentVariables="phase = P4二运">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 初始化 时间结晶" Id="6016914a-c36f-429b-a4ee-ff71c53527e1" RegularExpression="^.{15}\S+ 14:(?&lt;id&gt;4.{7}):[^:]+:9D30:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a4_二运" ActionType="Variable" />
<Action OrderNumber="3" UseTTSTextExpression="AoE，二运" ActionType="UseTTS" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1.1 获取红debuff * 4 =&gt; 2 / 3.1" Id="bed5ecdb-eee9-4356-b2d0-22109d00b3f2" RegularExpression="^.{15}\S+ 1A:CBF:[^:]+:(?&lt;t&gt;[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableName="U7a4_二运_红_idx" ListVariableExpression="${n: ${t}&gt;20}${l:party.indexof(${tid})}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" ListVariableOp="SortAlphaAsc" ListVariableName="U7a4_二运_红_idx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.size}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" ListVariableOp="SetAll" ListVariableName="U7a4_二运_红_idx" ListVariableExpression="${f:substring(1):${_this}}" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.size}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="4" LogMessageText="U7a4_二运_红:${l:U7a4_二运_红_idx.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.size}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1.2 获取杂项debuff" Id="ac038770-9f66-47cb-83c8-275ac234f8e5" RegularExpression="^.{15}\S+ 1A:99(?&lt;type&gt;[6CDE]):(?:[^:]|: )*:(?&lt;t&gt;[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" DictVariableOp="Set" DictVariableName="U7a4_二运_idx2Debuff" DictVariableKey="${l:party.indexof(${tid})}" DictVariableValue="${?d: 6 = 摊, C = 散, D = 水, E = 冰 [${type}]}" ActionType="DictVariable" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="2. 处理 =&gt; 3.2" Id="cbe5a980-4f45-48a7-8a96-a49835aa2774" RegularExpression="^U7a4_二运_红:">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" ExecutionDelayExpression="500" Asynchronous="False" />
<Action OrderNumber="2" Asynchronous="False" />
<Action OrderNumber="3" DictVariableOp="Remove" DictVariableName="U7a4_二运_idx2Debuff" DictVariableKey="${l:U7a4_二运_红_idx[1]}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="4" DictVariableOp="Remove" DictVariableName="U7a4_二运_idx2Debuff" DictVariableKey="${l:U7a4_二运_红_idx[2]}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="5" DictVariableOp="Remove" DictVariableName="U7a4_二运_idx2Debuff" DictVariableKey="${l:U7a4_二运_红_idx[3]}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="6" DictVariableOp="Remove" DictVariableName="U7a4_二运_idx2Debuff" DictVariableKey="${l:U7a4_二运_红_idx[4]}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="7" DictVariableOp="Merge" DictVariableName="U7a4_二运_idx2Debuff" DictVariableTarget="U7a4_二运_debuff2Idx" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="8" DictVariableOp="SetAll" DictVariableName="U7a4_二运_debuff2Idx" DictVariableKey="${_val}" DictVariableValue="${_key}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="9" ActionType="Placeholder" Asynchronous="False" Description="如果字典仅剩 3 个 debuff：填补没有 debuff 的人" DescriptionOverride="True" />
<Action OrderNumber="10" ListVariableOp="Build" ListVariableExpression=",水,冰,摊,散" ListVariableTarget="tmp_all" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_二运_debuff2Idx.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="11" ListVariableOp="Filter" ListVariableExpressionType="Numeric" ListVariableName="tmp_all" ListVariableExpression="!${d:U7a4_二运_id2Debuff.evalue(${_this})}" ListVariableTarget="tmp_缺buff" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_二运_debuff2Idx.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="12" ListVariableOp="Build" ListVariableExpression=",1,2,3,4,5,6,7,8" ListVariableTarget="tmp_all" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_二运_debuff2Idx.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="13" ListVariableOp="Filter" ListVariableExpressionType="Numeric" ListVariableName="tmp_all" ListVariableExpression="!${l:U7a4_二运_红_idx.contain(${_this})} &amp;&amp; !${d:U7a4_二运_debuff2Idx.evalue(${_this})}" ListVariableTarget="tmp_缺人" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_二运_debuff2Idx.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="14" DictVariableOp="Set" DictVariableName="U7a4_二运_debuff2Idx" DictVariableKey="${l:tmp_缺buff[1]}" DictVariableValue="${l:tmp_缺人[1]}" ActionType="DictVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_二运_debuff2Idx.size}" ExpressionTypeL="String" ExpressionR="3" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="15" ListVariableExpressionType="Numeric" ListVariableName="tmp_all" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="16" ListVariableName="tmp_缺buff" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="17" ListVariableName="tmp_缺人" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="18" LogMessageText="U7a4_二运_蓝:${d:U7a4_二运_debuff2Idx.joinall(&quot;&quot;, &quot;:&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 2025-01-07 13:04" Id="d2c7edb8-5bfc-4eae-970e-a6d2c8d4c5e0" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[21:25:28.097] StartsCasting 14:40002420:Usurper of Frost:9D30:Crystallize Time:40002420:Usurper of Frost:9.700:99.99:105.00:0.00:0.62" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="2.81 * 1000" />
<Action OrderNumber="3" LogMessageText="[21:25:30.904] StatusAdd 1A:CBF:Wyrmclaw:17.00:E0000000::${l:party[5]}:NAME:00:157227:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[21:25:30.904] StatusAdd 1A:CBF:Wyrmclaw:17.00:E0000000::${l:party[4]}:NAME:00:156627:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" LogMessageText="[21:25:30.904] StatusAdd 1A:CBF:Wyrmclaw:40.00:E0000000::${l:party[7]}:NAME:00:156987:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="6" LogMessageText="[21:25:30.904] StatusAdd 1A:CBF:Wyrmclaw:40.00:E0000000::${l:party[8]}:NAME:00:142328:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="7" LogMessageText="[21:25:30.904] StatusAdd 1A:99E:Spell-in-Waiting: Dark Blizzard III:14.00:E0000000::${l:party[4]}:NAME:00:156627:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="8" LogMessageText="[21:25:30.904] StatusAdd 1A:99E:Spell-in-Waiting: Dark Blizzard III:14.00:E0000000::${l:party[5]}:NAME:00:157227:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="9" LogMessageText="[21:25:30.904] StatusAdd 1A:99E:Spell-in-Waiting: Dark Blizzard III:14.00:E0000000::${l:party[6]}:NAME:00:157247:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="10" LogMessageText="[21:25:30.904] StatusAdd 1A:99D:Spell-in-Waiting: Dark Water III:12.00:E0000000::${l:party[1]}:NAME:00:225932:" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="11" LogMessageText="[21:25:30.904] StatusAdd 1A:996:Spell-in-Waiting: Unholy Darkness:17.00:E0000000::${l:party[3]}:NAME:00:142359:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="12" LogMessageText="[21:25:30.904] StatusAdd 1A:99C:Spell-in-Waiting: Dark Eruption:14.00:E0000000::${l:party[2]}:NAME:00:226089:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3.1a 红冰" Id="f4e9d6c1-bb52-42f7-a7bb-7be56e6fb71c" RegularExpression="^U7a4_二运_红">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="红冰" ActionType="UseTTS" Asynchronous="False" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.indexof(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="[12]" ExpressionTypeR="String" ConditionType="RegexMatch" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3.1b 红风" Id="611709ba-d170-4145-bb00-5f55abf73c05" RegularExpression="^U7a4_二运_红">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="红风" ActionType="UseTTS" Asynchronous="False" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.indexof(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="[34]" ExpressionTypeR="String" ConditionType="RegexMatch" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3.1c 蓝（初始）" Id="61026a80-15f0-43d6-bae1-155780f750ce" RegularExpression="^U7a4_二运_红">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="蓝" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.indexof(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3.2 蓝" Id="1038ecd6-7a31-4f78-a222-918f730843e4" RegularExpression="^U7a4_二运_蓝">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="${d:U7a4_二运_idx2Debuff[${v:myIdx}]}" Enabled="False" ActionType="UseTTS" />
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_二运_红_idx.indexof(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Trigger>
</Triggers>
</Folder>
<Folder Id="d1fc06f2-e808-4f52-bc6c-7382c5fecef6" Name="B. 一运" Enabled="true" RawEnvironmentVariables="phase = P4一运">
<Folders>
<Folder Id="9a056353-a835-4998-8d19-32e3eefded2e" Name="翻绳法" Enabled="false">
<Folders />
<Triggers />
</Folder>
<Folder Id="34ba73f3-6a0c-4618-a002-c3fd0a3b017c" Name="分摊基准" Enabled="false">
<Folders />
<Triggers />
</Folder>
</Folders>
<Triggers>
<Trigger Enabled="true" Name="0. 初始化 光暗龙诗" Id="e781394e-477a-43dc-a9dc-abecb5465b99" RegularExpression="^.{15}\S+ 14:(?&lt;id&gt;4.{7}):[^:]+:9D2F:">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a4_一运" ActionType="Variable" />
<Action OrderNumber="3" UseTTSTextExpression="AoE，壹运" ActionType="UseTTS" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 水分摊点名" Id="884e48f3-55c8-4e1c-889f-dc3ffa638567" RegularExpression="^.{15}\S+ 1A:99D:(?:[^:]|: )*:(?&lt;t&gt;19[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" ListVariableOp="Push" ListVariableName="U7a4_一运_摊_pIdx" ListVariableExpression="${l:party.indexof(${tid})}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" ListVariableOp="SortNumericAsc" ListVariableName="U7a4_一运_摊_pIdx" ActionType="ListVariable" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 获取连线 =&gt; 3" Id="85b3c34a-f5be-44ad-b643-2078899a7ccb" RegularExpression="^.{15}\S+ 23:(?&lt;sid&gt;1.{7}):[^:]*:(?&lt;tid&gt;1.{7}):[^:]*:[^:]*:[^:]*:006E">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="phase" DescriptionOverride="True">
<Condition Enabled="true" Grouping="Or" />
</Action>
<Action OrderNumber="2" DictVariableOp="Set" DictVariableName="U7a4_一运_环_pIdx" DictVariableKey="${l:party.indexof(${sid})}" DictVariableValue="${l:party.indexof(${tid})}" ActionType="DictVariable" Asynchronous="False" />
<Action OrderNumber="3" LogMessageText="_U7a4_一运_环:${d:U7a4_一运_环_pIdx.joinall}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${d:U7a4_一运_环_pIdx.size}" ExpressionTypeL="String" ExpressionR="4" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3. 处理数据 =&gt; 4" Id="9913d9c5-a47d-4330-ba78-eaef7d400b53" RegularExpression="^_U7a4_一运_环">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="环/无线：指初始站位    蝴蝶/光波：指换位后站位" DescriptionOverride="True" />
<Action OrderNumber="2" ActionType="Placeholder" Asynchronous="False" Description="【处理连线】" DescBgColor="90a0a8" DescriptionOverride="True" />
<Action OrderNumber="3" ActionType="Placeholder" Asynchronous="False" Description="从优先级最高的起始" DescriptionOverride="True" />
<Action OrderNumber="4" ListVariableOp="Push" ListVariableName="U7a4_一运_环_pIdx" ListVariableExpression="${d:U7a4_一运_环_pIdx.minkey}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="5" ListVariableOp="Push" ListVariableName="U7a4_一运_环_pIdx" ListVariableExpression="${d:U7a4_一运_环_pIdx[${l:U7a4_一运_环_pIdx[-1]}]}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="6" ListVariableOp="Push" ListVariableName="U7a4_一运_环_pIdx" ListVariableExpression="${d:U7a4_一运_环_pIdx[${l:U7a4_一运_环_pIdx[-1]}]}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="7" ListVariableOp="Push" ListVariableName="U7a4_一运_环_pIdx" ListVariableExpression="${d:U7a4_一运_环_pIdx[${l:U7a4_一运_环_pIdx[-1]}]}" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="8" ActionType="Placeholder" Asynchronous="False" Description="将环调整至 2 号 &lt; 4 号" DescriptionOverride="True" />
<Action OrderNumber="9" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_环_pIdx.join(:, &quot;1,4,3,2&quot;)}" ListVariableTarget="U7a4_一运_环_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_环_pIdx[2]}" ExpressionTypeL="Numeric" ExpressionR="${l:U7a4_一运_环_pIdx[4]}" ExpressionTypeR="String" ConditionType="NumericGreater" />
</Condition>
</Action>
<Action OrderNumber="10" ActionType="Placeholder" Asynchronous="False" Description="根据 2 3 4 位的 pIdx，判断环的类型：蝴蝶（1&lt;3&lt;2&lt;4）  方形（1&lt;2&lt;4&lt;3）  沙漏（1&lt;2&lt;3&lt;4）" DescriptionOverride="True" />
<Action OrderNumber="11" VariableOp="SetString" VariableName="U7a4_一运_环_type" VariableExpression="${if: ${l:U7a4_一运_环_pIdx[2]} &gt; ${l:U7a4_一运_环_pIdx[3]} &#xD;&#xA;  ? 蝴蝶&#xD;&#xA;  : ${if: ${l:U7a4_一运_环_pIdx[3]} &gt; ${l:U7a4_一运_环_pIdx[4]} ? 方形 : 沙漏 }&#xD;&#xA;}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="12" ActionType="Placeholder" Asynchronous="False" Description="换成沙漏后 左上 右上 左下 右下 四人 pIdx" DescriptionOverride="True" />
<Action OrderNumber="13" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_环_pIdx.join(:, &quot;1,3,2,4&quot;)}" ListVariableTarget="U7a4_一运_蝴蝶_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="蝴蝶" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="14" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_环_pIdx.join(:, &quot;4,2,1,3&quot;)}" ListVariableTarget="U7a4_一运_蝴蝶_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="方形" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="15" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_环_pIdx.join(:, &quot;1,3,2,4&quot;)}" ListVariableTarget="U7a4_一运_蝴蝶_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="沙漏" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="16" ActionType="Placeholder" Asynchronous="False" Description="连线需要换位的两人的 pIdx" DescriptionOverride="True" />
<Action OrderNumber="17" ListVariableOp="Build" ListVariableExpression=":0:0" ListVariableTarget="U7a4_一运_连线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="蝴蝶" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="18" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_蝴蝶_pIdx[3]}:${l:U7a4_一运_蝴蝶_pIdx[1]}" ListVariableTarget="U7a4_一运_连线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="方形" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="19" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_蝴蝶_pIdx[3]}:${l:U7a4_一运_蝴蝶_pIdx[2]}" ListVariableTarget="U7a4_一运_连线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="沙漏" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="20" ActionType="Placeholder" Asynchronous="False" Description="连线组的分摊是否在北：" DescriptionOverride="True" />
<Action OrderNumber="21" VariableOp="SetNumeric" VariableName="tmp_is连线分摊北" VariableExpression="${l:U7a4_一运_摊_pIdx.contain(${l:U7a4_一运_蝴蝶_pIdx[1]})} || ${l:U7a4_一运_摊_pIdx.contain(${l:U7a4_一运_蝴蝶_pIdx[2]})} " ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="22" ActionType="Placeholder" Asynchronous="False" Description="【处理分散】（无连线）" DescBgColor="90a0a8" DescriptionOverride="True" />
<Action OrderNumber="23" ActionType="Placeholder" Asynchronous="False" Description="无点名 左上 右上 左下 右下 四人 pIdx" DescriptionOverride="True" />
<Action OrderNumber="24" ListVariableOp="Build" ListVariableExpression=",1,2,3,4,5,6,7,8" ListVariableTarget="U7a4_一运_无线_pIdx" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="25" ListVariableOp="Filter" ListVariableExpressionType="Numeric" ListVariableName="U7a4_一运_无线_pIdx" ListVariableExpression="!${l:U7a4_一运_环_pIdx.contain(${_this})}" ListVariableTarget="U7a4_一运_无线_pIdx" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="26" ActionType="Placeholder" Asynchronous="False" Description="无点名组分摊者是四人中的第几个" DescriptionOverride="True" />
<Action OrderNumber="27" VariableOp="SetNumeric" VariableName="tmp_无线分摊idx" VariableExpression="${l:U7a4_一运_无线_pIdx.indexof(${l:U7a4_一运_摊_pIdx[1]})} + ${l:U7a4_一运_无线_pIdx.indexof(${l:U7a4_一运_摊_pIdx[2]})}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="28" ActionType="Placeholder" Asynchronous="False" Description="无点名组是否换位、是左侧或右侧换位" DescriptionOverride="True" />
<Action OrderNumber="29" VariableOp="SetString" VariableName="U7a4_一运_无线换位侧" VariableExpression="${if: ${v:tmp_无线分摊idx} % 2 = 1 ? 左 : 右 }" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_is连线分摊北}" ExpressionTypeL="String" ExpressionR="${v:tmp_无线分摊idx} &lt;= 2" ExpressionTypeR="Numeric" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="30" VariableName="tmp_is连线分摊北" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="31" ActionType="Placeholder" Asynchronous="False" Description="换位后引导光波 左上 右上 左下 右下 四人 pIdx" DescriptionOverride="True" />
<Action OrderNumber="32" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_无线_pIdx.join(:, &quot;1,2,3,4&quot;)}" ListVariableTarget="U7a4_一运_光波_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="33" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_无线_pIdx.join(:, &quot;3,2,1,4&quot;)}" ListVariableTarget="U7a4_一运_光波_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="左" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="34" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_无线_pIdx.join(:, &quot;1,4,3,2&quot;)}" ListVariableTarget="U7a4_一运_光波_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="右" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="35" ActionType="Placeholder" Asynchronous="False" Description="无连线需要换位的两人的 pIdx" DescriptionOverride="True" />
<Action OrderNumber="36" ListVariableOp="Build" ListVariableExpression=":0:0" ListVariableTarget="U7a4_一运_无线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="37" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_光波_pIdx[3]}:${l:U7a4_一运_光波_pIdx[1]}" ListVariableTarget="U7a4_一运_无线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="左" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="38" ListVariableOp="Build" ListVariableExpression=":${l:U7a4_一运_光波_pIdx[4]}:${l:U7a4_一运_光波_pIdx[2]}" ListVariableTarget="U7a4_一运_无线换位_pIdx" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_无线换位侧}" ExpressionTypeL="String" ExpressionR="右" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="39" ActionType="Placeholder" Asynchronous="False" Description="输出" DescriptionOverride="True" />
<Action OrderNumber="40" LogMessageText="U7a4_一运:蝴蝶:${l:U7a4_一运_蝴蝶_pIdx.join(&quot;&quot;)}:光波:${l:U7a4_一运_光波_pIdx.join(&quot;&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 2025-01-07 01:51" Id="edf7f0a6-cc80-4112-8b97-7f2acca0b0d7" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[22:17:30.887] StartsCasting 14:400028B3:Usurper of Frost:9D2F:Darklit Dragonsong:400028B3:Usurper of Frost:4.700:99.99:99.99:0.00:-3.13" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" ActionType="Placeholder" ExecutionDelayExpression="2.96 * 1000" />
<Action OrderNumber="3" LogMessageText="[22:17:33.848] StatusAdd 1A:99D:Spell-in-Waiting: Dark Water III:19.00:E0000000::${l:party[7]}:D3:00:156987:" LogProcess="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[22:17:33.848] StatusAdd 1A:99D:Spell-in-Waiting: Dark Water III:19.00:E0000000::${l:party[8]}:D4:00:142328:" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" LogMessageText="[22:17:33.848] StatusAdd 1A:99D:Spell-in-Waiting: Dark Water III:19.00:E0000000::${l:party[1]}:MT:00:142328:" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="6" ActionType="Placeholder" ExecutionDelayExpression="0.85 * 1000" />
<Action OrderNumber="7" LogMessageText="[22:17:34.695] Tether 23:${l:party[6]}:D2:${l:party[3]}:H1:0000:0000:006E:1090041B:000F:0000" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="8" LogMessageText="[22:17:34.695] Tether 23:${l:party[3]}:H1:${l:party[7]}:D3:0000:0000:006E:106913BC:000F:0000" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="9" LogMessageText="[22:17:34.695] Tether 23:${l:party[7]}:D3:${l:party[2]}:ST:0000:0000:006E:10740C2E:000F:0000" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="10" LogMessageText="[22:17:34.695] Tether 23:${l:party[2]}:ST:${l:party[6]}:D2:0000:0000:006E:1095CA1B:000F:0000" LogProcess="True" LogProcessACT="True" Enabled="False" ActionType="LogMessage" />
<Action OrderNumber="11" LogMessageText="[22:17:34.695] Tether 23:${l:party[1]}:D2:${l:party[3]}:H1:0000:0000:006E:1090041B:000F:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="12" LogMessageText="[22:17:34.695] Tether 23:${l:party[3]}:H1:${l:party[7]}:D3:0000:0000:006E:106913BC:000F:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="13" LogMessageText="[22:17:34.695] Tether 23:${l:party[7]}:D3:${l:party[6]}:ST:0000:0000:006E:10740C2E:000F:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="14" LogMessageText="[22:17:34.695] Tether 23:${l:party[6]}:ST:${l:party[1]}:D2:0000:0000:006E:1095CA1B:000F:0000" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="4.1 时间轴" Id="647bd538-df88-445d-a24b-4cd1158a3ecb" RegularExpression="^U7a4_一运">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="U7a4_一运_my位置" VariableExpression="${l:U7a4_一运_蝴蝶_pIdx.indexof(${v:myIdx})} + ${l:U7a4_一运_光波_pIdx.indexof(${v:myIdx})}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="tmp_换" VariableExpression="(${v:U7a4_一运_my位置} &lt;= 2) != (${v:myIdx} &lt;= 4)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" ActionType="Placeholder" Description="连线组" DescriptionOverride="True" />
<Action OrderNumber="4" UseTTSTextExpression="${v:U7a4_一运_环_type}，${if: ${v:tmp_换} ? &quot;换到&quot; : &quot;&quot; }${if: ${v:U7a4_一运_my位置} &lt;= 2 ? 上北 : 下南 }踩塔，&#xD;&#xA;偏${if: ${v:U7a4_一运_my位置} % 2 = 1 ? 左侧 : 右侧 }" ActionType="UseTTS" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_蝴蝶_pIdx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" ActionType="Placeholder" Asynchronous="False" Description="无连线组" DescriptionOverride="True" />
<Action OrderNumber="6" UseTTSTextExpression="${if: ${v:tmp_换} ? &quot;换到&quot; : &quot;去&quot; }${?l: 左上, 右上, 左下, 右下 [${v:U7a4_一运_my位置}]}，引导光波" ActionType="UseTTS" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_光波_pIdx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;1: polar 5, -115°&#xD;&#xA;4: polar 5,  -65°&#xD;&#xA;3: polar 5,   65°&#xD;&#xA;2: polar 5,  115°" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_光波_pIdx.contain(${v:myIdx})}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" VariableName="tmp_换" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="9" ActionType="Placeholder" Description="光波判定" DescriptionOverride="True" />
<Action OrderNumber="10" ActionType="Placeholder" ExecutionDelayExpression="10000" />
<Action OrderNumber="11" UseTTSTextExpression="${if: ${l:U7a4_一运_蝴蝶_pIdx[1]} = ${v:myIdx} || ${l:U7a4_一运_蝴蝶_pIdx[2]} = ${v:myIdx} ? &quot;分散，注意水晶&quot; : &quot;后退分散&quot; }" ActionType="UseTTS" />
<Action OrderNumber="12" NamedCallbackName="AdvWm" NamedCallbackParam="O: 100, 100, 0&#xD;&#xA;A: -3.4, -7.1&#xD;&#xA;B:  3.4, -7.1&#xD;&#xA;C:  3.4,  8.2&#xD;&#xA;D: -3.4,  8.2&#xD;&#xA;1: -8.2, -3.4&#xD;&#xA;2:  8.2, -3.4&#xD;&#xA;3:  8.2,  3.4&#xD;&#xA;4: -8.2,  3.4" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="13" SystemBeepLengthExpression="200" />
<Action OrderNumber="14" ActionType="Placeholder" Description="跳跃判定" DescriptionOverride="True" />
<Action OrderNumber="15" ActionType="Placeholder" ExecutionDelayExpression="3800" />
<Action OrderNumber="16" SystemBeepLengthExpression="200" />
<Action OrderNumber="17" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" DescBgColor="dff" />
<Action OrderNumber="18" ActionType="Placeholder" Description="分摊判定" DescriptionOverride="True" />
<Action OrderNumber="19" ActionType="Placeholder" ExecutionDelayExpression="4400" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="4.2 文本播报" Id="b393db2d-4481-42ba-a81d-8b022d3dec44" RegularExpression="^U7a4_一运">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="tmp_连线desc" VariableExpression="連線：不換位" ActionType="Variable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="蝴蝶" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="2" VariableOp="SetString" VariableName="tmp_连线desc" VariableExpression="連線：${v:U7a4_一运_环_type}換位（${?l:ＭＴ,ＳＴ,Ｈ１,Ｈ２,Ｄ１,Ｄ２,Ｄ３,Ｄ４[${l:U7a4_一运_连线换位_pIdx[1]}]} / ${?l:ＭＴ,ＳＴ,Ｈ１,Ｈ２,Ｄ１,Ｄ２,Ｄ３,Ｄ４[${l:U7a4_一运_连线换位_pIdx[2]}]}）" ActionType="Variable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a4_一运_环_type}" ExpressionTypeL="String" ExpressionR="蝴蝶" ExpressionTypeR="String" ConditionType="StringNotEqualNocase" />
</Condition>
</Action>
<Action OrderNumber="3" VariableOp="SetString" VariableName="tmp_光波desc" VariableExpression="光波：不換位" ActionType="Variable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_无线换位_pIdx[1]}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="4" VariableOp="SetString" VariableName="tmp_光波desc" VariableExpression="光波：${v:U7a4_一运_无线换位侧}側換位（${?l:ＭＴ,ＳＴ,Ｈ１,Ｈ２,Ｄ１,Ｄ２,Ｄ３,Ｄ４[${l:U7a4_一运_无线换位_pIdx[1]}]} / ${?l:ＭＴ,ＳＴ,Ｈ１,Ｈ２,Ｄ１,Ｄ２,Ｄ３,Ｄ４[${l:U7a4_一运_无线换位_pIdx[2]}]}）" ActionType="Variable">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${l:U7a4_一运_无线换位_pIdx[1]}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringNotEqualCase" />
</Condition>
</Action>
<Action OrderNumber="5" NamedCallbackName="command" NamedCallbackParam="/e &#xD;&#xA;　${v:tmp_连线desc}&#xD;&#xA;　${v:tmp_光波desc}" ActionType="NamedCallback" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="true" Sequential="True" Name="5. 神圣之翼" Id="7ec7a460-4ad7-44f4-b149-147bd3156ffa" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D2(?&lt;type&gt;3|4):">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="U7a4_一运_isRSafe" VariableExpression="${type} = 3" ActionType="Variable" />
<Action OrderNumber="2" UseTTSTextExpression="${if: (${_me.x} &gt; 100) = ${v:U7a4_一运_isRSafe} ? 同侧分摊 : 穿到${if: ${v:U7a4_一运_isRSafe} ? 右 : 左 }侧分摊 }" ActionType="UseTTS" />
</Actions>
</Trigger>
<Trigger Enabled="false" Name="分摊标记" Id="ea295bb3-8ef7-41ef-9bf6-2dc86ae22804" RegularExpression="^.{15}\S+ 1B:(?&lt;id&gt;1.{7}):[^:]*:[^:]*:[^:]*:003E">
<Actions />
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="326064c9-740d-4644-bdab-bc668abd45b0" Name="P5" Enabled="true">
<Folders>
<Folder Id="d5b1a768-a99d-43a5-9166-f74719dab882" Name="A. 地火" Enabled="true" RawEnvironmentVariables="phase = P5地火">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="1. 获取直线实体 * 6 =&gt; 2" Id="1c00af99-b9f9-48a3-a886-1769ed755881" RegularExpression="^.{15}\S+ 105:Add:(?&lt;id&gt;4.{7}):.*BNpcID:1EBBF7:.*Heading:(?&lt;h&gt;[^:]*):.*PosX:(?&lt;x&gt;[^:]+):PosY:(?&lt;y&gt;[^:]+)">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="地板线条实体用于播放特效动画，实体位于弦中点，面向垂直于弦。" DescriptionOverride="True" />
<Action OrderNumber="2" ActionType="Placeholder" Asynchronous="False" Description="实体所在线条的方程可写为：(x - x1) s1 + (y - y1) c1 = 0, 其中 s1 c1 为 heading 的 sin 和 cos。" DescriptionOverride="True" />
<Action OrderNumber="3" ActionType="Placeholder" Asynchronous="False" Description="两条直线相交的交点坐标为：" DescriptionOverride="True" />
<Action OrderNumber="4" ActionType="Placeholder" Asynchronous="False" Description="x = (x1 s1 c2 - x2 s2 c1 - (y2-y1) c1 c2) / (s1 c2 - s2 c1)" DescriptionOverride="True" />
<Action OrderNumber="5" ActionType="Placeholder" Asynchronous="False" Description="y = (y2 c2 s1 - y1 c1 s2 + (x2-x1) s1 s2) / (s1 c2 - s2 c1)" DescriptionOverride="True" />
<Action OrderNumber="6" ActionType="Placeholder" Asynchronous="False" Description="需要分别记录六个实体的 id、x、y、h，id 从大到小为判定顺序（读条开始时即可预判）。" DescriptionOverride="True" />
<Action OrderNumber="7" ActionType="Placeholder" Asynchronous="False" Description="依次计算 1、2；3、4；5、6 的三个交点 O1 O2 O3，O1O3 中点即为处理机制的中心点。" DescriptionOverride="True" />
<Action OrderNumber="8" ActionType="Placeholder" Asynchronous="False" Description="计算出 O1 O2 O3 相对于中心点 O 的 dir-8（相邻两个点相差 ±2），1 2 之间即为第一次穿到的位置，2 3 间第二次，1 3 间起始/终止。" DescriptionOverride="True" />
<Action OrderNumber="9" ActionType="Placeholder" Asynchronous="False" Description="实体生成后 EObjAnimation 019D:1:2:0:0 为显示，019D:20:10:0:0 为发光。" DescriptionOverride="True" />
<Action OrderNumber="10" ActionType="Placeholder" Asynchronous="False" Description="————————————————————————" DescriptionOverride="True" />
<Action OrderNumber="11" ActionType="Placeholder" ExecutionDelayExpression="1000" Asynchronous="False" />
<Action OrderNumber="12" ActionType="Placeholder" Asynchronous="False" Description="延迟一秒以便用读条初始化" DescriptionOverride="True" />
<Action OrderNumber="13" ActionType="Placeholder" Asynchronous="False" Description="表格：id, x, y, h" DescriptionOverride="True" />
<Action OrderNumber="14" TableVariableOp="SetLine" TableVariableName="U7a5_地火_直线实体" TableVariableExpression=",${id},${x},${y},${h}" TableVariableY="${t:U7a5_地火_直线实体.height} + 1" ActionType="TableVariable" Asynchronous="False" />
<Action OrderNumber="15" ActionType="Placeholder" Asynchronous="False" Description="满 6 个：排序，计算 sin、cos" DescriptionOverride="True" />
<Action OrderNumber="16" TableVariableOp="SortLine" TableVariableName="U7a5_地火_直线实体" TableVariableY="s-: ${_row[1]}" ActionType="TableVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${t:U7a5_地火_直线实体.height}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="17" TableVariableOp="SlicesSetAll" TableVariableName="U7a5_地火_直线实体" TableVariableExpression="${n: sin(${_this})}:${n: cos(${_this})}" TableVariableX="4" ActionType="TableVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${t:U7a5_地火_直线实体.height}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="18" LogMessageText="U7a5_地火_直线实体:${t:U7a5_地火_直线实体.hjoin(&quot;:&quot;, &quot;:&quot;, &quot;2,3,4&quot;)}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${t:U7a5_地火_直线实体.height}" ExpressionTypeL="String" ExpressionR="6" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 计算 =&gt; 3" Id="3c973869-3bba-4c6e-b476-4e07528d3384" RegularExpression="^U7a5_地火_直线实体:(?&lt;x1&gt;[^:]*):(?&lt;y1&gt;[^:]*):(?&lt;s1&gt;[^:]*):(?&lt;c1&gt;[^:]*):(?&lt;x2&gt;[^:]*):(?&lt;y2&gt;[^:]*):(?&lt;s2&gt;[^:]*):(?&lt;c2&gt;[^:]*):(?&lt;x3&gt;[^:]*):(?&lt;y3&gt;[^:]*):(?&lt;s3&gt;[^:]*):(?&lt;c3&gt;[^:]*):(?&lt;x4&gt;[^:]*):(?&lt;y4&gt;[^:]*):(?&lt;s4&gt;[^:]*):(?&lt;c4&gt;[^:]*):(?&lt;x5&gt;[^:]*):(?&lt;y5&gt;[^:]*):(?&lt;s5&gt;[^:]*):(?&lt;c5&gt;[^:]*):(?&lt;x6&gt;[^:]*):(?&lt;y6&gt;[^:]*):(?&lt;s6&gt;[^:]*):(?&lt;c6&gt;[^:]*)">
<Actions>
<Action OrderNumber="1" VariableOp="SetNumeric" VariableName="tmp_x交点1" VariableExpression="(${x1} * ${s1} * ${c2} - ${x2} * ${s2} * ${c1} - (${y2} - ${y1}) * ${c1} * ${c2}) / (${s1} * ${c2} - ${s2} * ${c1})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetNumeric" VariableName="tmp_x交点2" VariableExpression="(${x3} * ${s3} * ${c4} - ${x4} * ${s4} * ${c3} - (${y4} - ${y3}) * ${c3} * ${c4}) / (${s3} * ${c4} - ${s4} * ${c3})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="3" VariableOp="SetNumeric" VariableName="tmp_x交点3" VariableExpression="(${x5} * ${s5} * ${c6} - ${x6} * ${s6} * ${c5} - (${y6} - ${y5}) * ${c5} * ${c6}) / (${s5} * ${c6} - ${s6} * ${c5})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="4" VariableOp="SetNumeric" VariableName="tmp_y交点1" VariableExpression="(${y1} * ${c1} * ${s2} - ${y2} * ${c2} * ${s1} - (${x2} - ${x1}) * ${s1} * ${s2}) / (${c1} * ${s2} - ${c2} * ${s1})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="5" VariableOp="SetNumeric" VariableName="tmp_y交点2" VariableExpression="(${y3} * ${c3} * ${s4} - ${y4} * ${c4} * ${s3} - (${x4} - ${x3}) * ${s3} * ${s4}) / (${c3} * ${s4} - ${c4} * ${s3})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="6" VariableOp="SetNumeric" VariableName="tmp_y交点3" VariableExpression="(${y5} * ${c5} * ${s6} - ${y6} * ${c6} * ${s5} - (${x6} - ${x5}) * ${s5} * ${s6}) / (${c5} * ${s6} - ${c6} * ${s5})" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="7" VariableOp="SetNumeric" VariableName="U7a5_地火_x0" VariableExpression="(${v:tmp_x交点1} + ${v:tmp_x交点3}) / 2" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="8" VariableOp="SetNumeric" VariableName="U7a5_地火_y0" VariableExpression="(${v:tmp_y交点1} + ${v:tmp_y交点3}) / 2" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="9" VariableOp="SetNumeric" VariableName="tmp_dir-8交点1" VariableExpression="roundvec(${v:tmp_x交点1} - ${v:U7a5_地火_x0}, ${v:tmp_y交点1} - ${v:U7a5_地火_y0}, -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="10" VariableOp="SetNumeric" VariableName="tmp_dir-8交点2" VariableExpression="roundvec(${v:tmp_x交点2} - ${v:U7a5_地火_x0}, ${v:tmp_y交点2} - ${v:U7a5_地火_y0}, -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="11" VariableOp="SetNumeric" VariableName="tmp_dir-8交点3" VariableExpression="roundvec(${v:tmp_x交点3} - ${v:U7a5_地火_x0}, ${v:tmp_y交点3} - ${v:U7a5_地火_y0}, -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="12" VariableOp="SetNumeric" VariableName="U7a5_地火_is逆" VariableExpression="(${v:tmp_dir-8交点2} - ${v:tmp_dir-8交点1}) %% 8 = 2" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="13" VariableOp="SetNumeric" VariableName="U7a5_地火_θ1" VariableExpression="dir2rad(${v:tmp_dir-8交点1} + (${v:U7a5_地火_is逆} ? 1 : -1), -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="14" VariableOp="SetNumeric" VariableName="U7a5_地火_θ2" VariableExpression="dir2rad(${v:tmp_dir-8交点1} + (${v:U7a5_地火_is逆} ? 3 : -3), -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="15" VariableOp="SetNumeric" VariableName="U7a5_地火_θ0" VariableExpression="dir2rad(${v:tmp_dir-8交点1} + (${v:U7a5_地火_is逆} ? 6 : -6), -8)" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="16" LogMessageText="U7a5_地火:is逆:${v:U7a5_地火_is逆}:x:${v:U7a5_地火_x0}:y:${v:U7a5_地火_y0}:θ:${v:U7a5_地火_θ0}:${v:U7a5_地火_θ1}:${v:U7a5_地火_θ2}" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" Asynchronous="False" />
<Action OrderNumber="17" VariableOp="UnsetRegex" VariableName="^tmp_(x|y|dir-8)交点" Enabled="False" ActionType="Variable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="0. 初始化" Id="fbea6603-aca1-4b51-a881-4afceb62d7a3" RegularExpression="^.{15}\S+ 14:4.{7}:[^:]+:9D72:">
<Actions>
<Action OrderNumber="1" UseTTSTextExpression="AoE，地火" ActionType="UseTTS" />
<Action OrderNumber="1" VariableOp="SetString" VariableName="U7a_phase" VariableExpression="${env:phase}" ActionType="Variable" />
<Action OrderNumber="2" VariableOp="UnsetRegexUniversal" VariableName="^U7a5_地火" ActionType="Variable" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="3. 播报" Id="0386f886-205c-4102-9679-c74eea00dc15" RegularExpression="^U7a5_地火:is逆:(?&lt;is逆&gt;[01]):x:(?&lt;x&gt;[^:]*):y:(?&lt;y&gt;[^:]*):θ:(?&lt;θ0&gt;[^:]*):(?&lt;θ1&gt;[^:]*):(?&lt;θ2&gt;[^:]*)">
<Actions>
<Action OrderNumber="1" VariableOp="SetString" VariableName="_tmp_O" VariableExpression="${x}, ${y}" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="_tmp_O" VariableExpression="${x} - 100, ${y} - 175, 75&#xD;&#xA;// E12s 场地测试" Enabled="False" ActionType="Variable" Asynchronous="False" DescBgColor="fdd" />
<Action OrderNumber="3" NamedCallbackName="AdvWm" NamedCallbackParam="O: ${v:_tmp_O}&#xD;&#xA;A: polar 1.25 / sin(67.5°), ${θ0}&#xD;&#xA;B: polar 1.25 / sin(22.5°), ${θ1}&#xD;&#xA;C: polar 1.25 / sin(22.5°), ${θ2}&#xD;&#xA;D: fakeclear&#xD;&#xA;---&#xD;&#xA;O: ${v:_tmp_O} &#xD;&#xA;θ: θ(100, 100, ${x}, ${y})&#xD;&#xA;1: 0, -6&#xD;&#xA;2: 0, -8.5&#xD;&#xA;3: 0, -11&#xD;&#xA;4: 0, -13.5" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="4" UseTTSTextExpression="去A点，准备${if: ${is逆} ? 逆时针 : 顺时针 }移动" ActionType="UseTTS" ExecutionDelayExpression="9000" Asynchronous="False" />
<Action OrderNumber="5" LogProcess="True" LogProcessACT="True" NamedCallbackName="LockOn" NamedCallbackParam="${_me.address}, ${if: ${is逆} ? d1004turning_left_c0p : d1004turning_right_c0p }" ActionType="NamedCallback" ExecutionDelayExpression="3000" DescTextColor="26f" />
<Action OrderNumber="6" ActionType="Placeholder" ExecutionDelayExpression="7300" Asynchronous="False" />
<Action OrderNumber="7" ActionType="Placeholder" Asynchronous="False" Description="第一组第二次判定" DescriptionOverride="True" />
<Action OrderNumber="8" UseTTSTextExpression="去B点" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="9" />
<Action OrderNumber="10" NamedCallbackName="AdvWm" NamedCallbackParam="O: ${v:_tmp_O}&#xD;&#xA;B: polar 1.25 / sin(67.5°), ${θ1} + (${is逆} ? -π/4 : π/4)&#xD;&#xA;" ActionType="NamedCallback" ExecutionDelayExpression="2000" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="11" ActionType="Placeholder" ExecutionDelayExpression="2000" Asynchronous="False" />
<Action OrderNumber="12" ActionType="Placeholder" Asynchronous="False" Description="第二组第二次判定" DescriptionOverride="True" />
<Action OrderNumber="13" UseTTSTextExpression="去C点" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="14" NamedCallbackName="AdvWm" NamedCallbackParam="O: ${v:_tmp_O}&#xD;&#xA;B: fakeclear&#xD;&#xA;" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="15" />
<Action OrderNumber="16" NamedCallbackName="AdvWm" NamedCallbackParam="O: ${v:_tmp_O}&#xD;&#xA;C: polar 1.25 / sin(67.5°), ${θ2} + (${is逆} ? -π/4 : π/4)&#xD;&#xA;" ActionType="NamedCallback" ExecutionDelayExpression="2000" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="17" ActionType="Placeholder" ExecutionDelayExpression="2000" Asynchronous="False" />
<Action OrderNumber="18" ActionType="Placeholder" Asynchronous="False" Description="第三组第二次判定" DescriptionOverride="True" />
<Action OrderNumber="19" NamedCallbackName="AdvWm" NamedCallbackParam="O: ${v:_tmp_O}&#xD;&#xA;C: fakeclear&#xD;&#xA;" ActionType="NamedCallback" Asynchronous="False" DescBgColor="dff" />
<Action OrderNumber="20" UseTTSTextExpression="回A点，准备分摊" ActionType="UseTTS" Asynchronous="False" />
<Action OrderNumber="21" />
<Action OrderNumber="22" NamedCallbackName="AdvWm" NamedCallbackParam="load" ActionType="NamedCallback" ExecutionDelayExpression="2000" Asynchronous="False" DescBgColor="dff" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 正右 顺时针" Id="81506994-026e-44e3-a2f0-01521cb160c8" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[09:06:09.050] StartsCasting 14:4001A7B0:Pandora:9D72:unknown_9d72:4001A7B0:Pandora:5.700:99.99:99.99:0.00:-0.40" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" LogMessageText="[09:06:08.744] 261 105:Add:4001A815:BNpcID:1EBBF7:BNpcNameID:3001C03:CastDurationCurrent:2.2500:CastGroundTargetZ:4.5000:CurrentMP:4325379:Heading:-1.5709:Job:53:Level:11:PosX:97.0000:PosY:100.0000:Radius:0.5000:TransformationId:633:Type:7:WorldID:1536" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="3" LogMessageText="[09:06:08.744] 261 105:Add:4001A816:BNpcID:1EBBF7:BNpcNameID:700180D:CastDurationCurrent:2.7500:CastDurationMax:1.5000:CastGroundTargetX:1.9000:CastGroundTargetY:1.5000:CastGroundTargetZ:2.7500:CurrentMP:4259843:Heading:-0.7855:Level:139:PosX:96.4142:PosY:103.5858:Radius:0.5000:Type:7:WorldID:1536" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[09:06:08.744] 261 105:Add:4001A814:BNpcID:1EBBF7:BNpcNameID:100180D:CastGroundTargetZ:0.4191:CurrentMP:4390915:Heading:0.7854:Job:2:Level:89:PosX:96.4142:PosY:96.4142:Radius:0.5000:Type:7:WorldID:1536" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" LogMessageText="[09:06:08.744] 261 105:Add:4001A817:BNpcID:1EBBF7:BNpcNameID:1C03:CastDurationCurrent:0.3000:CastGroundTargetZ:0.5000:CurrentMP:4194307:CurrentWorldID:2816:Heading:-3.1416:Job:53:Level:11:PosX:100.0000:PosY:110.0000:Radius:0.5000:TransformationId:633:Type:7:WorldID:25347" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="6" LogMessageText="[09:06:08.744] 261 105:Add:4001A813:BNpcID:1EBBF7:BNpcNameID:1800:CastDurationCurrent:0.2000:CastGroundTargetZ:0.5000:CurrentMP:4456451:Heading:3.1416:Job:1:Level:147:PosX:100.0000:PosY:90.0000:Radius:0.5000:Type:7:WorldID:1536" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="7" LogMessageText="[09:06:08.744] 261 105:Add:4001A812:BNpcID:1EBBF7:BNpcNameID:7001C03:CurrentMP:4521987:Heading:-0.7855:Level:73:PosX:110.6569:PosY:89.3432:Radius:0.5000:Type:7:WorldID:1536" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
<Trigger Enabled="false" Source="None" Name="Debug Log 正左 逆时针" Id="2e07b195-f273-4a51-85b8-d1e72db252b4" RegularExpression="">
<Actions>
<Action OrderNumber="1" LogMessageText="[00:14:54.308] StartsCasting 14:4000939F:Pandora:9D72:Fulgent Blade:4000939F:Pandora:5.700:100.00:100.00:0.00:0.00" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="2" LogMessageText="[00:14:54.103] 261 105:Add:400093D2:BNpcID:1EBBF7:BNpcNameID:AD11:CastBuffID:43537:CastGroundTargetX:0.0000:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4456451:CurrentWorldID:256:Heading:3.1416:IsCasting1:17:Job:8:Level:9:NPCTargetID:A611:PCTargetID:2080204:PosX:100.0000:PosY:90.0000:Radius:0.5000:Type:7:WeaponId:3" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="3" LogMessageText="[00:14:54.103] 261 105:Add:400093D1:BNpcID:1EBBF7:CastBuffID:46609:CastGroundTargetX:0.0000:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4521987:CurrentWorldID:256:Heading:0.7854:IsCasting1:17:Job:8:Level:9:PosX:89.3934:PosY:89.3934:Radius:0.5000:Type:7" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="4" LogMessageText="[00:14:54.103] 261 105:Add:400093D3:BNpcID:1EBBF7:BNpcNameID:AF11:CastBuffID:42769:CastGroundTargetX:0.0000:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4390915:CurrentWorldID:256:Heading:1.5708:IsCasting1:17:Job:8:Level:9:NPCTargetID:AC11:PosX:103.0000:PosY:100.0000:Radius:0.5000:Type:7" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="5" LogMessageText="[00:14:54.103] 261 105:Add:400093D4:BNpcID:1EBBF7:BNpcNameID:AC11:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4325379:CurrentWorldID:256:Heading:-0.7855:NPCTargetID:A711:PCTargetID:2080304:PosX:103.5858:PosY:96.4142:Radius:0.5000:Type:7:WeaponId:3" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="6" LogMessageText="[00:14:54.103] 261 105:Add:400093D6:BNpcID:1EBBF7:CastBuffID:44305:CastGroundTargetX:0.0000:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4194307:CurrentWorldID:256:Heading:0.7854:IsCasting1:17:Job:175:Level:63:PosX:103.5858:PosY:103.5858:Radius:0.5000:TransformationId:32759:Type:7" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
<Action OrderNumber="7" LogMessageText="[00:14:54.103] 261 105:Add:400093D5:BNpcID:1EBBF7:CastBuffID:46097:CastGroundTargetX:0.0000:CastGroundTargetY:0.0000:CastGroundTargetZ:0.0000:CurrentMP:4259843:CurrentWorldID:256:Heading:-3.1416:IsCasting1:17:PCTargetID:2080303:PosX:100.0000:PosY:110.0000:Radius:0.5000:Type:7:WeaponId:3" LogProcess="True" LogProcessACT="True" ActionType="LogMessage" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="b1b0cb48-1351-4486-9462-d4201d906ae7" Name=".总体控制" Enabled="true">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="调试自用" Id="c58814ea-9c40-4093-ab44-58abb4896699" RegularExpression="">
<Actions>
<Action OrderNumber="1" ListVariableOp="Build" ListVariableExpression=",109012A8,106D8992,1067FB1D,1092AD86,106C2E8F,108AB8C3,108447D6,1078AB54" ListVariableTarget="party" ActionType="ListVariable" Asynchronous="False" />
<Action OrderNumber="2" LogMessageText="PartyList:MyIdx8:${l:party.indexof(${_me.id})}" LogProcess="True" ActionType="LogMessage" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="导入提示" Id="2e710666-3fd0-4a92-bbc6-2e3dae91cbef" RegularExpression="^." PrevActionsRefire="Deny" PeriodRefire="Deny" RefirePeriodExpression="30000">
<Actions>
<Action OrderNumber="1" MessageBoxIconType="Information" MessageBoxText="已更新绝伊甸测试版 v0.4a &#xA;&#xD;&#xA;更新后请看说明&#xD;&#xA;不保证播报正确，欢迎试用&#xD;&#xA;&#xD;&#xA;v0.3b → 0.4a：&#xD;&#xA;· 增加 P4 一运&#xD;&#xA;· P2 白镜子判定后使两个红镜子变白（取消光污染）&#xD;&#xA;· P3 一运在地板上持续标记自己的方向&#xD;&#xA;· 增加部分机制文本提示（当前仅默语）&#xD;&#xA;· 其他细节" ActionType="MessageBox" />
<Action OrderNumber="2" TriggerOp="DisableTrigger" TriggerId="2e710666-3fd0-4a92-bbc6-2e3dae91cbef" ActionType="Trigger" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
<Folder Id="8af2c7c9-1fd5-4fff-9ac6-7a680fd5b898" Name="警察 (没写完" Enabled="false">
<Folders>
<Folder Id="8e9de267-a847-4e3d-8a65-ecf5fe973204" Name="P3 一运" Enabled="true" RawEnvironmentVariables="phase = P3一运">
<Folders />
<Triggers>
<Trigger Enabled="true" Name="0. 初始化" Id="667da7ae-510b-45d3-abf2-f2e0fd2cbebe" RegularExpression="^U7a3_一运:dir8">
<Actions>
<Action OrderNumber="1" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Init" ActionType="NamedCallback" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="1. 收集技能数据（通用）" Id="b22ee124-bef1-479e-b0c1-f22a9b12a15c" RegularExpression="^.{15}\S+ 1[56]:(?&lt;sid&gt;4.{7}):[^:]*:(?&lt;aid&gt;9D5[2457]|9D2B|9D64|9D4F):[^:]*:(?&lt;tid&gt;[1E].{7}):([^:]*:){37}(?&lt;aoeid&gt;.{8}):(?&lt;idx&gt;[^:]*):(?&lt;count&gt;[^:]*):">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Asynchronous="False" Description="9D2B 初始激光 | 9D64 旋转激光 | 9D5[2457] 暗炎/火/神圣/冰 | 9D4F 水" DescriptionOverride="True" />
<Action OrderNumber="2" VariableOp="SetString" VariableName="tmp_AoE_${aoeid}_0" VariableExpression="${tid}" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${idx}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="3" ListVariableOp="Push" ListVariableName="tmp_AoE_${aoeid}_others" ListVariableExpression="${tid}" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${idx}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringNotEqualCase" />
</Condition>
</Action>
<Action OrderNumber="4" VariableOp="SetNumeric" VariableName="tmp_AoE_${aoeid}_complete" VariableExpression="(${ev:tmp_AoE_${aoeid}_0} + ${l:tmp_AoE_${aoeid}_others.size} = ${count}) || ${count} = 0" ActionType="Variable" Asynchronous="False" />
<Action OrderNumber="5" ActionType="Placeholder" Asynchronous="False" />
<Action OrderNumber="6" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Ability&#xD;&#xA;Ability = ${aid}&#xD;&#xA;Source = ${sid}&#xD;&#xA;Target = ${v:tmp_AoE_${aoeid}_0}&#xD;&#xA;Others = ${l:tmp_AoE_${aoeid}_others.join(&quot;,&quot;)}&#xD;&#xA;Count = ${count}" ActionType="NamedCallback" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="7" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Parse&#xD;&#xA;Ability = ${aid}&#xD;&#xA;Source = ${sid}&#xD;&#xA;Target = ${v:tmp_AoE_${aoeid}_0}&#xD;&#xA;Others = ${l:tmp_AoE_${aoeid}_others.join(&quot;,&quot;)}&#xD;&#xA;Count = ${count}" VariableOp="Clipboard" VariableExpression="Command = Parse&#xD;&#xA;Ability = ${aid}&#xD;&#xA;Source = ${sid}&#xD;&#xA;Target = ${v:tmp_AoE_${aoeid}_0}&#xD;&#xA;Others = ${l:tmp_AoE_${aoeid}_others.join(&quot;,&quot;)}&#xD;&#xA;Count = ${count}" Enabled="False" ActionType="Variable" Asynchronous="False" DescBgColor="fdd">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="8" NamedCallbackName="command" NamedCallbackParam="/e &#xD;&#xA;Command = Parse&#xD;&#xA;Ability = ${aid}&#xD;&#xA;Source = ${sid}&#xD;&#xA;Target = ${v:tmp_AoE_${aoeid}_0}&#xD;&#xA;Others = ${l:tmp_AoE_${aoeid}_others.join(&quot;,&quot;)}&#xD;&#xA;Count = ${count}" Enabled="False" ActionType="NamedCallback" Asynchronous="False" DescBgColor="fdd">
<Condition Enabled="true" Grouping="And">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
<ConditionSingle Enabled="true" ExpressionL="${count}" ExpressionTypeL="String" ExpressionR="0" ExpressionTypeR="String" ConditionType="StringNotEqualCase" />
</Condition>
</Action>
<Action OrderNumber="9" VariableName="tmp_AoE_${aoeid}_0" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="10" ListVariableName="tmp_AoE_${aoeid}_others" ActionType="ListVariable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
<Action OrderNumber="11" VariableName="tmp_AoE_${aoeid}_complete" ActionType="Variable" Asynchronous="False">
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:tmp_AoE_${aoeid}_complete}" ExpressionTypeL="String" ExpressionR="1" ExpressionTypeR="String" ConditionType="StringEqualCase" />
</Condition>
</Action>
</Actions>
<Condition Enabled="true" Grouping="Or">
<ConditionSingle Enabled="true" ExpressionL="${v:U7a_phase}" ExpressionTypeL="String" ExpressionR="${env:phase}" ExpressionTypeR="String" ConditionType="StringEqualNocase" />
</Condition>
</Trigger>
<Trigger Enabled="true" Name="3. 记录返回" Id="9c0ceb53-2a21-4e39-8539-52fb0200fd61" RegularExpression="^.{15}\S+ 1A:994:[^:]+:(?&lt;t&gt;[^:]+):.{8}:[^:]*:(?&lt;tid&gt;1.{7}):">
<Actions>
<Action OrderNumber="1" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Return&#xD;&#xA;Target = ${tid}" ActionType="NamedCallback" Asynchronous="False" />
</Actions>
</Trigger>
<Trigger Enabled="true" Name="2. 沙漏旋转" Id="8ad64c2b-d029-4f97-87a5-e2bf1ae6145b" RegularExpression="^U7a3_一运_沙漏:(?&lt;id&gt;.{8}):is顺:(?&lt;is顺&gt;[01]):dir8:(?&lt;dir8&gt;[0-7])">
<Actions>
<Action OrderNumber="1" NamedCallbackName="U7a3_一运_Analyzer" NamedCallbackParam="Command = Rotate&#xD;&#xA;ID = ${id}&#xD;&#xA;Dir8 = ${dir8}&#xD;&#xA;CW = ${is顺}" ActionType="NamedCallback" Asynchronous="False" />
</Actions>
</Trigger>
</Triggers>
</Folder>
</Folders>
<Triggers />
</Folder>
</Folders>
<Triggers>
<Trigger Enabled="false" Source="None" Name="【使用说明】 点开看" Id="f24190a0-3b61-4f21-8012-2e0c19aed773" RegularExpression="">
<Actions>
<Action OrderNumber="1" ActionType="Placeholder" Description="·前置&#xD;&#xA;" DescBgColor="346" DescTextColor="fff" DescriptionOverride="True" />
<Action OrderNumber="2" ActionType="Placeholder" Description="　触发器 v1.2.0.718+  鲶鱼精邮差  远程触发器中的运行支持库（触发器自带）  不需要cactbotself" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="3" LaunchProcessPathExpression="https://docs.qq.com/doc/DS3duaXlSc1JJcFVB" ActionType="LaunchProcess" Description="　攻略：参考 MMW 攻略文档 （右键 - 测试动作）" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="4" ActionType="Placeholder" Description="·用户配置" DescBgColor="346" DescTextColor="fff" DescriptionOverride="True" />
<Action OrderNumber="5" ActionType="Placeholder" Description="　还没写打法相关的配置，进本自动弹出小队列表界面" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="6" ActionType="Placeholder" Description="　介绍还没写 凑合用" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="7" ActionType="Placeholder" Description="·播报 / 标点说明&#xD;&#xA;" DescBgColor="346" DescTextColor="fff" DescriptionOverride="True" />
<Action OrderNumber="8" ActionType="Placeholder" Description="· P1" DescBgColor="bce" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="9" ActionType="Placeholder" Description="雷火线" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="10" ActionType="Placeholder" Description="　采用全队优先级法，MT - D4" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="11" ActionType="Placeholder" Description="六人塔" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="12" ActionType="Placeholder" Description="　采用 MMW 攻略的：北 [H1] D1; 南 [H2] D2; 中 [D4] D3，括号为固定组，另一人补位" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="13" ActionType="Placeholder" Description="· P2" DescBgColor="bce" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="14" ActionType="Placeholder" Description="滑冰" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="15" ActionType="Placeholder" Description="　滑冰前：如果自己在希瓦半场则标出希瓦背后的区域，否则用弧形标点标出一次可滑到 Boss 身后的范围，最好在结冰前进入二者之一" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="16" ActionType="Placeholder" Description="　冰地板判定后，如果自己：" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="17" ActionType="Placeholder" Description="　位于身后：无提示" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="18" ActionType="Placeholder" Description="　位于侧面（未成功进入上述两区域）：用弧形标点标出一次可滑到 Boss 身后的范围，你需要先滑进这个区域再处理" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="19" ActionType="Placeholder" Description="　位于前方（可一次滑进身后）：用一排标点标出最安全的滑动角度 （标点末端为滑冰终点）" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="20" ActionType="Placeholder" Description="　计算无法考虑有人把光圈塞到 Boss 背后的情况（正常不会出现），如果指路指向了光圈则自己回避一下。" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="21" ActionType="Placeholder" Description="光暴：灰九式" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="22" ActionType="Placeholder" Description="· P3" DescBgColor="bce" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="23" ActionType="Placeholder" Description="一运：灰九式" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="24" ActionType="Placeholder" Description="二运：MMW 双分组（分摊分组优先级 H1 H2 MT ST D1-4，地火分散左 TH 右 DPS）" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="25" ActionType="Placeholder" Description="· P4" DescBgColor="bce" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="26" ActionType="Placeholder" Description="一运：翻花绳" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="27" ActionType="Placeholder" Description="· P5" DescBgColor="bce" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="28" ActionType="Placeholder" Description="地火" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="29" ActionType="Placeholder" Description="　初始去 A，TTS + 身上出现顺逆图标提示" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="30" ActionType="Placeholder" Description="　第一次穿到 B，两秒后 B 微调至一个更近的位置，自行选择是否跟随" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="31" ActionType="Placeholder" Description="　第二次穿到 C，两秒后 C 微调，同上" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="32" ActionType="Placeholder" Description="　第三次回到 A，准备分摊" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="33" ActionType="Placeholder" Description="·已知问题" DescBgColor="346" DescTextColor="fff" DescriptionOverride="True" />
<Action OrderNumber="34" ActionType="Placeholder" Description="·关于" DescBgColor="346" DescTextColor="fff" DescriptionOverride="True" />
<Action OrderNumber="35" ActionType="Placeholder" Description="　　by 阿洛 MnFeN   群号 556836295 / 133514183" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
<Action OrderNumber="36" LaunchProcessPathExpression="https://space.bilibili.com/83429972" ActionType="LaunchProcess" Description="　　你可以关注这个 b 站账号，不定期更新视频介绍（右键这一行 - 测试动作）" DescBgColor="f4faff" DescTextColor="234" DescriptionOverride="True" />
</Actions>
</Trigger>
</Triggers>
</ExportedFolder>
</TriggernometryExport>